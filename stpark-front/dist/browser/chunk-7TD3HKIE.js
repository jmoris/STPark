import{a as l}from"./chunk-VKB6BRO6.js";import{a as i,d as p}from"./chunk-EARUC3FY.js";import{_ as c,c as n,da as u}from"./chunk-MLNNMN4J.js";var b=(()=>{class a{constructor(t){this.http=t,this.baseUrl=`${l.apiUrl}/sessions`}createSession(t){return this.http.post(this.baseUrl,t)}getQuote(t,e){return this.http.post(`${this.baseUrl}/${t}/quote`,e)}checkoutSession(t,e){return this.http.post(`${this.baseUrl}/${t}/checkout`,e)}getSession(t){return this.http.get(`${this.baseUrl}/${t}`)}getSessions(t={}){let e=new i;return t.page!==void 0&&t.page!==null&&(e=e.set("page",t.page.toString())),t.per_page!==void 0&&t.per_page!==null&&(e=e.set("per_page",t.per_page.toString())),t.sort_by!==void 0&&t.sort_by!==null&&t.sort_by!==""&&(e=e.set("sort_by",t.sort_by)),t.sort_order!==void 0&&t.sort_order!==null&&t.sort_order!==""&&(e=e.set("sort_order",t.sort_order)),Object.keys(t).forEach(r=>{if(r==="page"||r==="per_page"||r==="sort_by"||r==="sort_order")return;let s=t[r];s!=null&&s!==""&&(e=e.set(r,s.toString()))}),this.http.get(this.baseUrl,{params:e})}cancelSession(t){return this.http.post(`${this.baseUrl}/${t}/cancel`,{})}getActiveSessionByPlate(t,e){let r=new i().set("plate",t).set("sector_id",e.toString());return this.http.get(`${this.baseUrl}/active-by-plate`,{params:r})}getActiveSessions(t){let e={status:"ACTIVE",operator_id:t};return new n(r=>{this.getSessions(e).subscribe({next:s=>{r.next({success:s.success,data:s.data||[],message:"Sesiones activas obtenidas"}),r.complete()},error:s=>{r.error(s)}})})}getTodaySessions(t){let e=new Date().toISOString().split("T")[0],r={date_from:e,date_to:e,operator_id:t};return new n(s=>{this.getSessions(r).subscribe({next:o=>{s.next({success:o.success,data:o.data||[],message:"Sesiones del d\xEDa obtenidas"}),s.complete()},error:o=>{s.error(o)}})})}hasActiveSession(t,e){return new n(r=>{this.getActiveSessionByPlate(t,e).subscribe({next:s=>{r.next(s.data!==null),r.complete()},error:s=>{r.error(s)}})})}formatDuration(t){let e=Math.floor(t/3600),r=Math.floor(t%3600/60);return e>0?`${e}h ${r}m`:`${r}m`}formatAmount(t){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}validateChileanPlate(t){let e=t.toUpperCase().replace(/\s/g,"");return[/^[A-Z]{2}[0-9]{4}$/,/^[0-9]{4}[A-Z]{2}$/,/^[A-Z]{4}[0-9]{2}$/].some(s=>s.test(e))}getStatusLabel(t){return{CREATED:"Creada",ACTIVE:"Activa",TO_PAY:"Por Pagar",PAID:"Pagada",CLOSED:"Cerrada",CANCELED:"Cancelada",CANCELLED:"Cancelada",COMPLETED:"Completada",FORCED_CHECKOUT:"Checkout Forzado"}[t]||t}getStatusColor(t){return{CREATED:"blue",ACTIVE:"green",TO_PAY:"orange",PAID:"green",CLOSED:"gray",CANCELED:"red",CANCELLED:"red",COMPLETED:"green",FORCED_CHECKOUT:"orange"}[t]||"gray"}static{this.\u0275fac=function(e){return new(e||a)(u(p))}}static{this.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{b as a};
