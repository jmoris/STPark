import{a as l}from"./chunk-VKB6BRO6.js";import{a as i,d as u}from"./chunk-EARUC3FY.js";import{_ as c,c as n,da as o}from"./chunk-MLNNMN4J.js";var h=(()=>{class a{constructor(t){this.http=t,this.baseUrl=`${l.apiUrl}/debts`}createDebt(t){return this.http.post(this.baseUrl,t)}getDebts(t={}){let e=new i;return Object.keys(t).forEach(r=>{let s=t[r];s!=null&&s!==""&&(e=e.set(r,s.toString()))}),this.http.get(this.baseUrl,{params:e})}getDebt(t){return this.http.get(`${this.baseUrl}/${t}`)}getDebtsByPlate(t){let e=new i().set("plate",t);return this.http.get(`${this.baseUrl}/by-plate`,{params:e})}settleDebt(t,e){return this.http.post(`${this.baseUrl}/${t}/settle`,e)}getPendingSummary(){return this.http.get(`${this.baseUrl}/pending-summary`)}getPendingDebts(){let t={status:"PENDING"};return new n(e=>{this.getDebts(t).subscribe({next:r=>{e.next({success:r.success,data:r.data.data||[],message:r.message}),e.complete()},error:r=>{e.error(r)}})})}getSettledDebts(){let t={status:"SETTLED"};return new n(e=>{this.getDebts(t).subscribe({next:r=>{e.next({success:r.success,data:r.data.data||[],message:r.message}),e.complete()},error:r=>{e.error(r)}})})}getDebtsByOrigin(t){let e={origin:t};return new n(r=>{this.getDebts(e).subscribe({next:s=>{r.next({success:s.success,data:s.data.data||[],message:s.message}),r.complete()},error:s=>{r.error(s)}})})}getTodayDebts(){let t=new Date().toISOString().split("T")[0],e={date_from:t,date_to:t};return new n(r=>{this.getDebts(e).subscribe({next:s=>{r.next({success:s.success,data:s.data.data||[],message:s.message}),r.complete()},error:s=>{r.error(s)}})})}formatAmount(t){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}getOriginLabel(t){return{SESSION:"Sesi\xF3n",FINE:"Multa",MANUAL:"Manual"}[t]||t}getOriginColor(t){return{SESSION:"blue",FINE:"red",MANUAL:"orange"}[t]||"gray"}getStatusLabel(t){return{PENDING:"Pendiente",SETTLED:"Liquidada",CANCELLED:"Cancelada"}[t]||t}getStatusColor(t){return{PENDING:"orange",SETTLED:"green",CANCELLED:"red"}[t]||"gray"}isDebtPending(t){return t==="PENDING"}isDebtSettled(t){return t==="SETTLED"}isDebtCancelled(t){return t==="CANCELLED"}getOriginIcon(t){return{SESSION:"truck",FINE:"exclamation-triangle-solid",MANUAL:"pencil"}[t]||"question-mark-circle"}calculateTotal(t){return t.reduce((e,r)=>e+r.principal_amount,0)}calculatePendingTotal(t){return t.filter(e=>e.status==="PENDING").reduce((e,r)=>e+r.principal_amount,0)}calculateSettledTotal(t){return t.filter(e=>e.status==="SETTLED").reduce((e,r)=>e+r.principal_amount,0)}groupDebtsByOrigin(t){return t.reduce((e,r)=>{let s=r.origin;return e[s]||(e[s]=[]),e[s].push(r),e},{})}groupDebtsByStatus(t){return t.reduce((e,r)=>{let s=r.status;return e[s]||(e[s]=[]),e[s].push(r),e},{})}groupDebtsByPlate(t){return t.reduce((e,r)=>{let s=r.plate;return e[s]||(e[s]=[]),e[s].push(r),e},{})}getDaysSinceCreation(t){let e=new Date(t.created_at),s=Math.abs(new Date().getTime()-e.getTime());return Math.ceil(s/(1e3*60*60*24))}getAgeLabel(t){if(t===0)return"Hoy";if(t===1)return"Ayer";if(t<7)return`${t} d\xEDas`;if(t<30){let e=Math.floor(t/7);return`${e} semana${e>1?"s":""}`}else{let e=Math.floor(t/30);return`${e} mes${e>1?"es":""}`}}static{this.\u0275fac=function(e){return new(e||a)(o(u))}}static{this.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{h as a};
