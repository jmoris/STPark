import{a as Xe}from"./chunk-33C47SQJ.js";import{a as Qe}from"./chunk-FTQ2MWXD.js";import{a as J}from"./chunk-ZMZZWBL4.js";import{c as Ue}from"./chunk-FRZBS72K.js";import{a as Pe,b as Ae,c as Ne,d as Re,e as je,f as Be,g as Ve,h as $e,i as ze,j as Le,k as We,l as qe,m as He}from"./chunk-DVKEPSGT.js";import{a as Ge,c as Je,f as Ke}from"./chunk-XQK4L4ZU.js";import{a as H,b as U}from"./chunk-3TK3OLOO.js";import"./chunk-KAI4P3W6.js";import{a as G}from"./chunk-2A6RA7CH.js";import{a as ue,b as fe,c as _e,h as ge}from"./chunk-RRH7I2VE.js";import{c as xe,d as Ce,e as ve,f as be}from"./chunk-BY5IVZ2R.js";import"./chunk-YGRHM56X.js";import{a as he}from"./chunk-VKB6BRO6.js";import{a as De,b as Oe}from"./chunk-OVLCZUMA.js";import{b as R,c as j}from"./chunk-WP7DXJZF.js";import{a as W,b as q}from"./chunk-4LV3ZYQA.js";import{b as w,c as Se,j as D,k as O,o as z,p as L}from"./chunk-4UMW4R4I.js";import{b as B,d as V,f as $,g as Ee,j as Me,k as ye,n as Fe,o as Te,v as Ie,x as ke,y as we}from"./chunk-EGGCURRC.js";import{ea as k,ka as P,ma as A,na as N}from"./chunk-HOABDKFW.js";import"./chunk-CQGOYTFO.js";import{d as pe}from"./chunk-7OGW3PNS.js";import{l as F,m as T,s as I}from"./chunk-TQARHOKX.js";import{$b as _,Eb as d,Ib as x,Pb as n,Qb as i,Rb as h,Sb as C,Tb as v,U as Q,Vb as X,_ as me,bb as l,bc as p,cb as g,da as de,f as se,lc as ce,mc as r,nc as S,oa as b,oc as f,pa as E,pb as y,pc as Y,rc as Z,sc as ee,tc as te,wb as u}from"./chunk-BSJZAB7M.js";import"./chunk-TSRGIXR5.js";var K=(()=>{class t{constructor(e){this.http=e,this.baseUrl=`${he.apiUrl}/streets`}getStreets(e={}){return this.http.get(this.baseUrl,{params:e})}getStreet(e){return this.http.get(`${this.baseUrl}/${e}`)}createStreet(e){return this.http.post(this.baseUrl,e)}updateStreet(e,a){return this.http.put(`${this.baseUrl}/${e}`,a)}deleteStreet(e){return this.http.delete(`${this.baseUrl}/${e}`)}static{this.\u0275fac=function(a){return new(a||t)(de(pe))}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function pt(t,m){if(t&1&&(n(0,"mat-option",26),r(1),n(2,"span",27),r(3),i()()),t&2){let e=m.$implicit,a=p();d("value",e.id),l(),f(" ",e.name," "),l(2),f("(",a.getSectorTypeText(e),")")}}function ut(t,m){if(t&1&&(n(0,"mat-error"),r(1),i()),t&2){let e=p();l(),f(" ",e.getErrorMessage("sector_id")," ")}}function ft(t,m){t&1&&(n(0,"span"),r(1," Los sectores privados manejan direcciones espec\xEDficas (ej: Av. Principal 123) "),i())}function _t(t,m){t&1&&(n(0,"span"),r(1," Los sectores p\xFAblicos manejan calles completas o rangos de cuadras "),i())}function gt(t,m){if(t&1&&(n(0,"div",28)(1,"div",29)(2,"mat-icon"),r(3),i(),n(4,"span",30),r(5),i()(),n(6,"p",31),u(7,ft,2,0,"span",10)(8,_t,2,0,"span",10),i()()),t&2){let e=p();x("bg-"+e.getSectorTypeColor(e.selectedSector)+"-50 border border-"+e.getSectorTypeColor(e.selectedSector)+"-200"),l(2),x("text-"+e.getSectorTypeColor(e.selectedSector)+"-600"),l(),f(" ",e.selectedSector.is_private?"lock":"public"," "),l(),x("text-"+e.getSectorTypeColor(e.selectedSector)+"-800"),l(),f(" Sector ",e.getSectorTypeText(e.selectedSector)," "),l(),x("text-"+e.getSectorTypeColor(e.selectedSector)+"-700"),l(),d("ngIf",e.selectedSector.is_private),l(),d("ngIf",!e.selectedSector.is_private)}}function St(t,m){if(t&1&&(n(0,"mat-error"),r(1),i()),t&2){let e=p();l(),f(" ",e.getErrorMessage("name")," ")}}function ht(t,m){if(t&1&&(n(0,"mat-error"),r(1),i()),t&2){let e=p();l(),f(" ",e.getErrorMessage("name")," ")}}function xt(t,m){t&1&&(n(0,"div",6)(1,"mat-form-field",12)(2,"mat-label"),r(3,"N\xFAmero de Direcci\xF3n"),i(),h(4,"input",32),i()())}function Ct(t,m){t&1&&(n(0,"div",6)(1,"mat-form-field",12)(2,"mat-label"),r(3,"Rango de Cuadras (Opcional)"),i(),h(4,"input",33),i()())}function vt(t,m){if(t&1&&(n(0,"span"),r(1),i()),t&2){let e,a=p(2);l(),Y(" ",(e=a.streetForm.get("name"))==null?null:e.value," ",(e=a.streetForm.get("address_number"))==null?null:e.value," ")}}function bt(t,m){if(t&1&&(n(0,"span"),r(1),i()),t&2){let e,a=p(2);l(),f(" ",(e=a.streetForm.get("name"))==null?null:e.value," [N\xFAmero] ")}}function Et(t,m){if(t&1&&(n(0,"span"),r(1),i()),t&2){let e,a=p(2);l(),Y(" ",(e=a.streetForm.get("name"))==null?null:e.value," (Cuadras ",(e=a.streetForm.get("block_range"))==null?null:e.value,") ")}}function Mt(t,m){if(t&1&&(n(0,"span"),r(1),i()),t&2){let e,a=p(2);l(),f(" ",(e=a.streetForm.get("name"))==null?null:e.value," ")}}function yt(t,m){if(t&1&&(n(0,"div",34)(1,"h4",35),r(2,"Vista Previa:"),i(),n(3,"div",29)(4,"mat-icon",27),r(5,"road"),i(),n(6,"span",36),u(7,vt,2,2,"span",10)(8,bt,2,1,"span",10)(9,Et,2,2,"span",10)(10,Mt,2,1,"span",10),i()()()),t&2){let e,a,o,s,c=p();l(7),d("ngIf",((e=c.streetForm.get("is_specific_address"))==null?null:e.value)&&((e=c.streetForm.get("address_number"))==null?null:e.value)),l(),d("ngIf",((a=c.streetForm.get("is_specific_address"))==null?null:a.value)&&!((a=c.streetForm.get("address_number"))!=null&&a.value)),l(),d("ngIf",!((o=c.streetForm.get("is_specific_address"))!=null&&o.value)&&((o=c.streetForm.get("block_range"))==null?null:o.value)),l(),d("ngIf",!((s=c.streetForm.get("is_specific_address"))!=null&&s.value)&&!((s=c.streetForm.get("block_range"))!=null&&s.value))}}function Ft(t,m){t&1&&h(0,"mat-spinner",37)}function Tt(t,m){if(t&1&&(n(0,"mat-icon"),r(1),i()),t&2){let e=p();l(),S(e.data.isEdit?"save":"add")}}var ie=(()=>{class t{constructor(e,a,o,s,c,M){this.fb=e,this.dialogRef=a,this.data=o,this.streetService=s,this.sectorService=c,this.snackBar=M,this.loading=!1,this.sectors=[],this.selectedSector=null,this.streetForm=this.createForm()}ngOnInit(){this.loadSectors(),this.data.isEdit&&this.data.street&&this.loadStreetData()}createForm(){return this.fb.group({sector_id:["",[V.required]],name:["",[V.required,V.minLength(2)]],address_number:[""],address_type:["STREET"],block_range:[""],is_specific_address:[!1],notes:[""]})}loadSectors(){this.sectorService.getSectors().subscribe({next:e=>{this.sectors=e.data?.data||[]},error:e=>{console.error("Error loading sectors:",e),this.snackBar.open("Error al cargar sectores","Cerrar",{duration:3e3})}})}loadStreetData(){this.data.street&&(this.streetForm.patchValue({sector_id:this.data.street.sector_id,name:this.data.street.name,address_number:this.data.street.address_number||"",address_type:this.data.street.address_type||"STREET",block_range:this.data.street.block_range||"",is_specific_address:this.data.street.is_specific_address||!1,notes:this.data.street.notes||""}),this.onSectorChange(this.data.street.sector_id))}onSectorChange(e){this.selectedSector=this.sectors.find(a=>a.id===e)||null,this.selectedSector?.is_private?this.streetForm.patchValue({is_specific_address:!0,address_type:"ADDRESS"}):this.streetForm.patchValue({is_specific_address:!1,address_type:"STREET"})}onAddressTypeChange(){this.streetForm.get("is_specific_address")?.value?this.streetForm.patchValue({address_type:"ADDRESS",block_range:""}):this.streetForm.patchValue({address_type:"STREET",address_number:""})}onSubmit(){if(this.streetForm.valid){this.loading=!0;let e=this.streetForm.value;this.data.isEdit&&this.data.street?this.streetService.updateStreet(this.data.street.id,e).subscribe({next:a=>{this.loading=!1,this.snackBar.open("Calle actualizada correctamente","Cerrar",{duration:3e3}),this.dialogRef.close(a.data)},error:a=>{this.loading=!1,this.snackBar.open("Error al actualizar calle","Cerrar",{duration:3e3})}}):this.streetService.createStreet(e).subscribe({next:a=>{this.loading=!1,this.snackBar.open("Calle creada correctamente","Cerrar",{duration:3e3}),this.dialogRef.close(a.data)},error:a=>{this.loading=!1,this.snackBar.open("Error al crear calle","Cerrar",{duration:3e3})}})}else this.snackBar.open("Por favor, complete todos los campos requeridos","Cerrar",{duration:3e3})}onCancel(){this.dialogRef.close()}getErrorMessage(e){let a=this.streetForm.get(e);return a?.hasError("required")?"Este campo es requerido":a?.hasError("minlength")?"M\xEDnimo 2 caracteres":""}getSectorTypeText(e){return e.is_private?"Privado":"P\xFAblico"}getSectorTypeColor(e){return e.is_private?"purple":"blue"}static{this.\u0275fac=function(a){return new(a||t)(g(Ie),g(ue),g(fe),g(K),g(J),g(G))}}static{this.\u0275cmp=y({type:t,selectors:[["app-street-form"]],decls:51,vars:17,consts:[[1,"street-form-dialog"],[1,"dialog-header"],[1,"dialog-title"],["mat-icon-button","",1,"close-button",3,"click"],[1,"dialog-content"],[1,"street-form",3,"formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["formControlName","sector_id",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","mb-4 p-3 rounded-lg",3,"class",4,"ngIf"],["appearance","outline",1,"half-width"],["formControlName","address_type",3,"selectionChange"],["value","STREET"],["value","ADDRESS"],[1,"half-width","flex","items-center"],["formControlName","is_specific_address",3,"change"],["matInput","","formControlName","name",3,"placeholder"],["class","form-row",4,"ngIf"],["matInput","","formControlName","notes","rows","3","placeholder","Informaci\xF3n adicional sobre esta calle/direcci\xF3n"],["class","mt-4 p-3 bg-gray-50 rounded-lg",4,"ngIf"],[1,"dialog-actions"],["mat-button","",1,"rounded-sm",3,"click","disabled"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click","disabled"],["diameter","20","class","inline-spinner",4,"ngIf"],[3,"value"],[1,"text-gray-500"],[1,"mb-4","p-3","rounded-lg"],[1,"flex","items-center","gap-2"],[1,"font-medium"],[1,"text-sm","mt-1"],["matInput","","formControlName","address_number","placeholder","Ej: 123"],["matInput","","formControlName","block_range","placeholder","Ej: 100-200"],[1,"mt-4","p-3","bg-gray-50","rounded-lg"],[1,"font-medium","text-gray-700","mb-2"],[1,"font-semibold"],["diameter","20",1,"inline-spinner"]],template:function(a,o){if(a&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),r(3),i(),n(4,"button",3),_("click",function(){return o.onCancel()}),n(5,"mat-icon"),r(6,"close"),i()()(),n(7,"div",4)(8,"form",5)(9,"div",6)(10,"mat-form-field",7)(11,"mat-label"),r(12,"Sector *"),i(),n(13,"mat-select",8),_("selectionChange",function(c){return o.onSectorChange(c.value)}),u(14,pt,4,3,"mat-option",9),i(),u(15,ut,2,1,"mat-error",10),i()(),u(16,gt,9,12,"div",11),n(17,"div",6)(18,"mat-form-field",12)(19,"mat-label"),r(20,"Tipo de Direcci\xF3n"),i(),n(21,"mat-select",13),_("selectionChange",function(){return o.onAddressTypeChange()}),n(22,"mat-option",14),r(23,"Calle Completa"),i(),n(24,"mat-option",15),r(25,"Direcci\xF3n Espec\xEDfica"),i()()(),n(26,"div",16)(27,"mat-checkbox",17),_("change",function(){return o.onAddressTypeChange()}),r(28," Es direcci\xF3n espec\xEDfica "),i()()(),n(29,"div",6)(30,"mat-form-field",7)(31,"mat-label"),r(32),i(),h(33,"input",18),u(34,St,2,1,"mat-error",10)(35,ht,2,1,"mat-error",10),i()(),u(36,xt,5,0,"div",19)(37,Ct,5,0,"div",19),n(38,"div",6)(39,"mat-form-field",7)(40,"mat-label"),r(41,"Notas"),i(),h(42,"textarea",20),i()(),u(43,yt,11,4,"div",21),i()(),n(44,"div",22)(45,"button",23),_("click",function(){return o.onCancel()}),r(46," Cancelar "),i(),n(47,"button",24),_("click",function(){return o.onSubmit()}),u(48,Ft,1,0,"mat-spinner",25)(49,Tt,2,1,"mat-icon",10),r(50),i()()()),a&2){let s,c,M,ne,re,ae,oe,le;l(3),f(" ",o.data.isEdit?"Editar Calle/Direcci\xF3n":"Nueva Calle/Direcci\xF3n"," "),l(5),d("formGroup",o.streetForm),l(6),d("ngForOf",o.sectors),l(),d("ngIf",(s=o.streetForm.get("sector_id"))==null?null:s.hasError("required")),l(),d("ngIf",o.selectedSector),l(16),f("",((c=o.streetForm.get("is_specific_address"))!=null&&c.value,"Nombre de la Calle")," *"),l(),d("placeholder",(M=o.streetForm.get("is_specific_address"))!=null&&M.value?"Ej: Avenida Principal":"Ej: Calle Central"),l(),d("ngIf",(ne=o.streetForm.get("name"))==null?null:ne.hasError("required")),l(),d("ngIf",(re=o.streetForm.get("name"))==null?null:re.hasError("minlength")),l(),d("ngIf",(ae=o.streetForm.get("is_specific_address"))==null?null:ae.value),l(),d("ngIf",!((oe=o.streetForm.get("is_specific_address"))!=null&&oe.value)),l(6),d("ngIf",(le=o.streetForm.get("name"))==null?null:le.value),l(2),d("disabled",o.loading),l(2),d("disabled",o.loading||o.streetForm.invalid),l(),d("ngIf",o.loading),l(),d("ngIf",!o.loading),l(),f(" ",o.data.isEdit?"Actualizar":"Crear"," ")}},dependencies:[I,F,T,we,ye,B,$,Ee,Fe,Te,ge,O,D,w,Se,L,z,N,P,A,j,R,U,H,k,Oe,De,q,W],styles:[".street-form-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:90vh;width:100%}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 1.5rem 0;border-bottom:1px solid #e5e7eb;margin-bottom:1rem}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600;color:#111827}.close-button[_ngcontent-%COMP%]{margin-left:auto}.dialog-content[_ngcontent-%COMP%]{flex:1;padding:0 1.5rem;overflow-y:auto}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding:1rem 1.5rem 1.5rem;border-top:1px solid #e5e7eb;margin-top:1rem}.street-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:flex-start}.full-width[_ngcontent-%COMP%], .half-width[_ngcontent-%COMP%]{flex:1}.inline-spinner[_ngcontent-%COMP%]{margin-right:.5rem}@media (max-width: 768px){.street-form-dialog[_ngcontent-%COMP%]{min-width:auto;width:100%;max-height:95vh}.form-row[_ngcontent-%COMP%]{flex-direction:column}.half-width[_ngcontent-%COMP%]{width:100%}.dialog-header[_ngcontent-%COMP%]{padding:1rem 1rem 0}.dialog-content[_ngcontent-%COMP%]{padding:0 1rem}.dialog-actions[_ngcontent-%COMP%]{padding:1rem}}"]})}}return t})();function It(t,m){if(t&1&&(n(0,"mat-option",47),r(1),i()),t&2){let e=m.$implicit;d("value",e.id),l(),f(" ",e.name," ")}}function kt(t,m){t&1&&(n(0,"th",48),r(1,"Direcci\xF3n"),i())}function wt(t,m){if(t&1&&(n(0,"td",49)(1,"div",50)(2,"mat-icon",51),r(3,"road"),i(),n(4,"span",52),r(5),i()()()),t&2){let e=m.$implicit,a=p();l(5),S(a.getFullAddress(e))}}function Dt(t,m){t&1&&(n(0,"th",48),r(1,"Sector"),i())}function Ot(t,m){if(t&1&&(n(0,"td",49)(1,"div",50)(2,"mat-icon",51),r(3,"location_city"),i(),n(4,"span"),r(5),i()()()),t&2){let e=m.$implicit,a=p();l(5),S(a.getSectorName(e))}}function Pt(t,m){t&1&&(n(0,"th",48),r(1,"Tipo"),i())}function At(t,m){if(t&1&&(n(0,"td",49)(1,"span",53),r(2),i()()),t&2){let e=m.$implicit,a=p();l(),x("bg-"+a.getAddressTypeColor(e)+"-100 text-"+a.getAddressTypeColor(e)+"-800"),l(),f(" ",a.getAddressType(e)," ")}}function Nt(t,m){t&1&&(n(0,"th",48),r(1,"Sesiones"),i())}function Rt(t,m){if(t&1&&(n(0,"td",49)(1,"div",54)(2,"mat-icon",55),r(3,"directions_car"),i(),n(4,"span"),r(5),i()()()),t&2){let e=m.$implicit,a=p();l(5),S(a.getSessionsCount(e))}}function jt(t,m){t&1&&(n(0,"th",48),r(1,"Operadores"),i())}function Bt(t,m){if(t&1&&(n(0,"td",49)(1,"div",54)(2,"mat-icon",55),r(3,"people"),i(),n(4,"span"),r(5),i()()()),t&2){let e=m.$implicit,a=p();l(5),S(a.getOperatorsCount(e))}}function Vt(t,m){t&1&&(n(0,"th",48),r(1,"Acciones"),i())}function $t(t,m){if(t&1){let e=X();n(0,"td",49)(1,"button",56)(2,"mat-icon"),r(3,"more_vert"),i()(),n(4,"mat-menu",null,0)(6,"button",57),_("click",function(){let o=b(e).$implicit,s=p();return E(s.viewStreet(o))}),n(7,"mat-icon"),r(8,"visibility"),i(),r(9," Ver detalles "),i(),n(10,"button",57),_("click",function(){let o=b(e).$implicit,s=p();return E(s.editStreet(o))}),n(11,"mat-icon"),r(12,"edit"),i(),r(13," Editar "),i(),n(14,"button",58),_("click",function(){let o=b(e).$implicit,s=p();return E(s.deleteStreet(o))}),n(15,"mat-icon"),r(16,"delete"),i(),r(17," Eliminar "),i()()()}if(t&2){let e=ce(5);l(),d("matMenuTriggerFor",e)}}function zt(t,m){t&1&&h(0,"tr",59)}function Lt(t,m){t&1&&h(0,"tr",60)}function Wt(t,m){t&1&&(n(0,"div",61),h(1,"mat-spinner",62),i())}function qt(t,m){t&1&&(n(0,"div",63)(1,"mat-icon",64),r(2,"road"),i(),n(3,"h3",65),r(4,"No hay calles registradas"),i(),n(5,"p",51),r(6,"Las calles aparecer\xE1n aqu\xED cuando se registren."),i()())}function Ht(t,m){if(t&1){let e=X();n(0,"mat-paginator",66),_("page",function(o){b(e);let s=p();return E(s.onPageChange(o))}),i()}if(t&2){let e=p();d("length",e.totalItems)("pageSize",e.pageSize)("pageIndex",e.currentPage)("pageSizeOptions",e.pageSizeOptions)("showFirstLastButtons",!0)}}var Ti=(()=>{class t{constructor(e,a,o,s){this.streetService=e,this.sectorService=a,this.dialog=o,this.snackBar=s,this._unsubscribeAll=new se,this.streets=[],this.sectors=[],this.loading=!1,this.displayedColumns=["name","sector","type","sessions_count","operators_count","actions"],this.totalItems=0,this.pageSize=10,this.currentPage=0,this.pageSizeOptions=[5,10,25,50],this.filters={name:"",sector_id:""}}ngOnInit(){this.loadSectors(),this.loadStreets()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadStreets(){this.loading=!0;let e={page:this.currentPage+1,per_page:this.pageSize};this.filters.name&&this.filters.name.trim()!==""&&(e.name=this.filters.name),this.filters.sector_id&&this.filters.sector_id!==""&&(e.sector_id=this.filters.sector_id),this.streetService.getStreets(e).pipe(Q(this._unsubscribeAll)).subscribe({next:a=>{this.streets=a.data?.data||[],this.totalItems=a.data?.total||0,this.loading=!1},error:a=>{console.error("Error loading streets:",a),this.loading=!1}})}loadSectors(){this.sectorService.getSectors().pipe(Q(this._unsubscribeAll)).subscribe({next:e=>{this.sectors=e.data?.data||[]},error:e=>{console.error("Error loading sectors:",e)}})}getSectorName(e){return e.sector?.name||"Sector no encontrado"}getFullAddress(e){return e.is_specific_address&&e.address_number?`${e.name} ${e.address_number}`:e.block_range?`${e.name} (Cuadras ${e.block_range})`:e.name}getAddressType(e){return e.is_specific_address?"Direcci\xF3n Espec\xEDfica":"Calle Completa"}getAddressTypeColor(e){return e.is_specific_address?"purple":"blue"}getSessionsCount(e){return e.parking_sessions?.length||0}getOperatorsCount(e){return e.operator_assignments?.length||0}createStreet(){this.dialog.open(ie,{width:"600px",data:{isEdit:!1}}).afterClosed().subscribe(a=>{a&&this.loadStreets()})}editStreet(e){this.dialog.open(ie,{width:"600px",data:{isEdit:!0,street:e}}).afterClosed().subscribe(o=>{o&&this.loadStreets()})}deleteStreet(e){confirm(`\xBFEst\xE1 seguro de eliminar la calle ${e.name}?`)&&this.streetService.deleteStreet(e.id).subscribe({next:()=>{this.snackBar.open("Calle eliminada correctamente","Cerrar",{duration:3e3}),this.loadStreets()},error:a=>{this.snackBar.open("Error al eliminar calle","Cerrar",{duration:3e3})}})}viewStreet(e){let a=[{label:"Direcci\xF3n Completa",key:"name",icon:"road",type:"text",format:s=>this.getFullAddress(e)},{label:"Sector",key:"sector.name",icon:"location_city",type:"text"},{label:"Tipo de Direcci\xF3n",key:"is_specific_address",icon:"category",type:"badge",format:s=>s?"Direcci\xF3n Espec\xEDfica":"Calle Completa",badgeColor:s=>s?"accent":"primary"},{label:"N\xFAmero de Direcci\xF3n",key:"address_number",icon:"tag",type:"text"},{label:"Rango de Cuadras",key:"block_range",icon:"straighten",type:"text"},{label:"Sesiones de Estacionamiento",key:"parking_sessions",icon:"directions_car",type:"text",format:s=>{let c=s?s.length:0;return`${c} sesi\xF3n${c!==1?"es":""}`}},{label:"Operadores Asignados",key:"operator_assignments",icon:"people",type:"text",format:s=>{let c=s?s.length:0;return`${c} operador${c!==1?"es":""}`}},{label:"Notas",key:"notes",icon:"note",type:"text"},{label:"Fecha de Creaci\xF3n",key:"created_at",icon:"schedule",type:"date"}],o=this.dialog.open(Xe,{width:"600px",data:{title:"Detalles de la Calle/Direcci\xF3n",data:e,fields:a,actions:[{label:"Editar",icon:"edit",color:"primary",action:()=>{o.close(),this.editStreet(e)}}]}})}getTotalStreetsCount(){return this.streets.length}getStreetsWithSessions(){return this.streets.filter(e=>this.getSessionsCount(e)>0).length}getStreetsWithOperators(){return this.streets.filter(e=>this.getOperatorsCount(e)>0).length}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.loadStreets()}applyFilters(){this.currentPage=0,this.loadStreets()}clearFilters(){this.filters={name:"",sector_id:""},this.currentPage=0,this.loadStreets()}static{this.\u0275fac=function(a){return new(a||t)(g(K),g(J),g(_e),g(G))}}static{this.\u0275cmp=y({type:t,selectors:[["app-streets"]],decls:106,vars:13,consts:[["menu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-6"],[1,"p-6"],[1,"flex","items-center"],[1,"p-3","bg-blue-100","rounded-full"],[1,"text-blue-600"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"p-3","bg-green-100","rounded-full"],[1,"text-green-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"p-3","bg-purple-100","rounded-full"],[1,"text-purple-600"],[1,"text-2xl","font-bold","text-purple-600"],[1,"p-3","bg-orange-100","rounded-full"],[1,"text-orange-600"],[1,"text-2xl","font-bold","text-orange-600"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["appearance","outline"],["matInput","","placeholder","Nombre de la calle",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex","justify-end","gap-2","mt-4"],["mat-stroked-button","",1,"rounded-sm",3,"click"],[1,"overflow-x-auto"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sector"],["matColumnDef","type"],["matColumnDef","sessions_count"],["matColumnDef","operators_count"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","flex justify-center items-center py-8",4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","mt-4",3,"length","pageSize","pageIndex","pageSizeOptions","showFirstLastButtons","page",4,"ngIf"],[3,"value"],["mat-header-cell",""],["mat-cell",""],[1,"flex","items-center","gap-2"],[1,"text-gray-500"],[1,"font-semibold"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],[1,"flex","items-center","gap-1"],[1,"text-sm","text-gray-500"],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""],[1,"flex","justify-center","items-center","py-8"],["diameter","40"],[1,"text-center","py-8"],[1,"text-gray-400","text-6xl"],[1,"text-lg","font-medium","text-gray-900","mt-4"],[1,"mt-4",3,"page","length","pageSize","pageIndex","pageSizeOptions","showFirstLastButtons"]],template:function(a,o){a&1&&(n(0,"div",1)(1,"div",2)(2,"div")(3,"h1",3),r(4,"Calles"),i(),n(5,"p",4),r(6,"Gestiona las calles del sistema"),i()(),n(7,"button",5),_("click",function(){return o.createStreet()}),n(8,"mat-icon"),r(9,"add"),i(),r(10," Nueva Calle "),i()(),n(11,"div",6)(12,"mat-card")(13,"mat-card-content",7)(14,"div",8)(15,"div",9)(16,"mat-icon",10),r(17,"road"),i()(),n(18,"div",11)(19,"p",12),r(20,"Total Calles"),i(),n(21,"p",13),r(22),i()()()()(),n(23,"mat-card")(24,"mat-card-content",7)(25,"div",8)(26,"div",14)(27,"mat-icon",15),r(28,"directions_car"),i()(),n(29,"div",11)(30,"p",12),r(31,"Con Sesiones"),i(),n(32,"p",16),r(33),i()()()()(),n(34,"mat-card")(35,"mat-card-content",7)(36,"div",8)(37,"div",17)(38,"mat-icon",18),r(39,"people"),i()(),n(40,"div",11)(41,"p",12),r(42,"Con Operadores"),i(),n(43,"p",19),r(44),i()()()()(),n(45,"mat-card")(46,"mat-card-content",7)(47,"div",8)(48,"div",20)(49,"mat-icon",21),r(50,"location_city"),i()(),n(51,"div",11)(52,"p",12),r(53,"Sectores"),i(),n(54,"p",22),r(55),i()()()()()(),n(56,"mat-card",23)(57,"mat-card-content",7)(58,"div",24)(59,"mat-form-field",25)(60,"mat-label"),r(61,"Buscar calle"),i(),n(62,"input",26),te("ngModelChange",function(c){return ee(o.filters.name,c)||(o.filters.name=c),c}),i()(),n(63,"mat-form-field",25)(64,"mat-label"),r(65,"Sector"),i(),n(66,"mat-select",27),te("ngModelChange",function(c){return ee(o.filters.sector_id,c)||(o.filters.sector_id=c),c}),n(67,"mat-option",28),r(68,"Todos los sectores"),i(),u(69,It,2,2,"mat-option",29),i()()(),n(70,"div",30)(71,"button",31),_("click",function(){return o.clearFilters()}),n(72,"mat-icon"),r(73,"clear"),i(),r(74," Limpiar "),i(),n(75,"button",5),_("click",function(){return o.applyFilters()}),n(76,"mat-icon"),r(77,"search"),i(),r(78," Filtrar "),i()()()(),n(79,"mat-card")(80,"mat-card-content",7)(81,"div",32)(82,"table",33),C(83,34),u(84,kt,2,0,"th",35)(85,wt,6,1,"td",36),v(),C(86,37),u(87,Dt,2,0,"th",35)(88,Ot,6,1,"td",36),v(),C(89,38),u(90,Pt,2,0,"th",35)(91,At,3,3,"td",36),v(),C(92,39),u(93,Nt,2,0,"th",35)(94,Rt,6,1,"td",36),v(),C(95,40),u(96,jt,2,0,"th",35)(97,Bt,6,1,"td",36),v(),C(98,41),u(99,Vt,2,0,"th",35)(100,$t,18,1,"td",36),v(),u(101,zt,1,0,"tr",42)(102,Lt,1,0,"tr",43),i(),u(103,Wt,2,0,"div",44)(104,qt,7,0,"div",45),i(),u(105,Ht,1,5,"mat-paginator",46),i()()()),a&2&&(l(22),S(o.getTotalStreetsCount()),l(11),S(o.getStreetsWithSessions()),l(11),S(o.getStreetsWithOperators()),l(11),S(o.sectors.length),l(7),Z("ngModel",o.filters.name),l(4),Z("ngModel",o.filters.sector_id),l(3),d("ngForOf",o.sectors),l(13),d("dataSource",o.streets),l(19),d("matHeaderRowDef",o.displayedColumns),l(),d("matRowDefColumns",o.displayedColumns),l(),d("ngIf",o.loading),l(),d("ngIf",!o.loading&&o.streets.length===0),l(),d("ngIf",o.totalItems>0))},dependencies:[I,F,T,ke,B,$,Me,We,Pe,Ne,Ve,Re,Ae,$e,je,Be,ze,Le,Ke,Ge,Je,N,P,A,j,R,q,W,Qe,O,D,w,L,z,be,Ce,xe,ve,Ue,U,H,k,He,qe],styles:[".mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.mat-mdc-table[_ngcontent-%COMP%]{background:transparent}.mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151}.mat-mdc-cell[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6}@media (max-width: 768px){.grid-cols-4[_ngcontent-%COMP%]{grid-template-columns:1fr}.mat-mdc-table[_ngcontent-%COMP%]{font-size:.875rem}}"]})}}return t})();export{Ti as StreetsComponent};
