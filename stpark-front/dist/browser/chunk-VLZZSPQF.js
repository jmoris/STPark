import{a as u}from"./chunk-VKB6BRO6.js";import{a as i,d as l}from"./chunk-7OGW3PNS.js";import{_ as c,c as n,da as m}from"./chunk-BSJZAB7M.js";var p=(()=>{class a{constructor(t){this.http=t,this.baseUrl=`${u.apiUrl}/payments`}processPayment(t){return this.http.post(this.baseUrl,t)}createPayment(t){return this.http.post(this.baseUrl,t)}processWebpayWebhook(t){return this.http.post(`${this.baseUrl}/webhook`,t)}getPayments(t={}){let e=new i;return Object.keys(t).forEach(s=>{let r=t[s];r!=null&&r!==""&&(e=e.set(s,r.toString()))}),this.http.get(this.baseUrl,{params:e})}getPayment(t){return this.http.get(`${this.baseUrl}/${t}`)}getOperatorSummary(t,e,s){let r=new i().set("operator_id",t.toString()).set("date_from",e).set("date_to",s);return this.http.get(`${this.baseUrl}/summary-by-operator`,{params:r})}getTodayPayments(t){let e=new Date().toISOString().split("T")[0],s={date_from:e,date_to:e,operator_id:t};return new n(r=>{this.getPayments(s).subscribe({next:o=>{r.next({success:o.success,data:o.data.data||[],message:o.message}),r.complete()},error:o=>{r.error(o)}})})}getPaymentsBySession(t){let e={session_id:t};return new n(s=>{this.getPayments(e).subscribe({next:r=>{s.next({success:r.success,data:r.data.data||[],message:r.message}),s.complete()},error:r=>{s.error(r)}})})}getPaymentsBySale(t){let e={sale_id:t};return new n(s=>{this.getPayments(e).subscribe({next:r=>{s.next({success:r.success,data:r.data.data||[],message:r.message}),s.complete()},error:r=>{s.error(r)}})})}formatAmount(t){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}getPaymentMethodLabel(t){return{CASH:"Efectivo",CARD:"Tarjeta",WEBPAY:"Webpay",TRANSFER:"Transferencia"}[t]||t}getPaymentMethodColor(t){return{CASH:"green",CARD:"blue",WEBPAY:"purple",TRANSFER:"orange"}[t]||"gray"}getPaymentStatusLabel(t){return{PENDING:"Pendiente",COMPLETED:"Completado",FAILED:"Fallido",CANCELLED:"Cancelado"}[t]||t}getPaymentStatusColor(t){return{PENDING:"orange",COMPLETED:"green",FAILED:"red",CANCELLED:"gray"}[t]||"gray"}isPaymentCompleted(t){return t==="COMPLETED"}isPaymentPending(t){return t==="PENDING"}isPaymentFailed(t){return t==="FAILED"}getPaymentMethodIcon(t){return{CASH:"heroicons_solid:currency-dollar",CARD:"heroicons_solid:credit-card",WEBPAY:"heroicons_solid:globe-alt",TRANSFER:"heroicons_solid:arrow-right-left"}[t]||"heroicons_solid:question-mark-circle"}calculateTotal(t){return t.filter(e=>e.status==="COMPLETED").reduce((e,s)=>e+s.amount,0)}groupPaymentsByMethod(t){return t.reduce((e,s)=>{let r=s.method;return e[r]||(e[r]=[]),e[r].push(s),e},{})}groupPaymentsByStatus(t){return t.reduce((e,s)=>{let r=s.status;return e[r]||(e[r]=[]),e[r].push(s),e},{})}static{this.\u0275fac=function(e){return new(e||a)(m(l))}}static{this.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{p as a};
