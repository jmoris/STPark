import{a as m}from"./chunk-CLY5BRNQ.js";import{a as c}from"./chunk-VKB6BRO6.js";import{a as l,d as h}from"./chunk-EARUC3FY.js";import{_ as u,da as o}from"./chunk-MLNNMN4J.js";var U=(()=>{class s{constructor(t,e){this.http=t,this.authService=e,this.baseUrlTenant=`${c.apiUrl}/invoices`,this.baseUrlCentral=`${c.authApiUrl}/api/invoices`}getInvoices(t={}){let e=new l;Object.keys(t).forEach(i=>{let a=t[i];a!=null&&a!==""&&(e=e.set(i,a.toString()))});let n=this.authService.isCentralAdminMode()?this.baseUrlCentral:this.baseUrlTenant;return this.http.get(n,{params:e})}getInvoice(t){let r=this.authService.isCentralAdminMode()?this.baseUrlCentral:this.baseUrlTenant;return this.http.get(`${r}/${t}`)}createInvoice(t){let r=this.authService.isCentralAdminMode()?this.baseUrlCentral:this.baseUrlTenant;return this.http.post(r,t)}updateInvoice(t,e){let n=this.authService.isCentralAdminMode()?this.baseUrlCentral:this.baseUrlTenant;return this.http.put(`${n}/${t}`,e)}deleteInvoice(t){let r=this.authService.isCentralAdminMode()?this.baseUrlCentral:this.baseUrlTenant;return this.http.delete(`${r}/${t}`)}payInvoice(t,e){let r=`${this.baseUrlCentral}/${t}/pay`;return this.http.post(r,e)}initiateWebPayPayment(t){let e=`${this.baseUrlTenant}/${t}/webpay/initiate`;return this.http.post(e,{})}formatAmount(t){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}formatDate(t){if(!t)return"N/A";let e=new Date(t);return isNaN(e.getTime())?"N/A":e.toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"})}getPendingInvoices(t={}){let e=new l;Object.keys(t).forEach(n=>{let i=t[n];i!=null&&i!==""&&(e=e.set(n,i.toString()))});let r=`${this.baseUrlCentral}/pending`;return this.http.get(r,{params:e})}acceptInvoice(t){let e=`${this.baseUrlCentral}/${t}/accept`;return this.http.post(e,{})}rejectInvoice(t,e){let r=`${this.baseUrlCentral}/${t}/reject`;return this.http.post(r,{reason:e})}getStatusLabel(t){return{PENDING_REVIEW:"Pendiente de Revisi\xF3n",UNPAID:"Sin pago registrado",PAID:"Pago registrado",OVERDUE:"Factura vencida",CANCELLED:"Cancelada"}[t]||t}getStatusColor(t){return{PENDING_REVIEW:"orange",UNPAID:"blue",PAID:"green",OVERDUE:"red",CANCELLED:"red"}[t]||"gray"}formatRut(t){if(!t)return"";let e=t.replace(/\./g,"").replace(/-/g,"");if(e.length<2)return t;let r=e.slice(0,-1),n=e.slice(-1).toUpperCase();return`${r.replace(/\B(?=(\d{3})+(?!\d))/g,".")}-${n}`}static{this.\u0275fac=function(e){return new(e||s)(o(h),o(m))}}static{this.\u0275prov=u({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{U as a};
