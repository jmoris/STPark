import{a as et}from"./chunk-N3LDMRIB.js";import{a as Ze}from"./chunk-ZMFSOZJA.js";import{c as qe}from"./chunk-ICPS6N2F.js";import{a as je,b as Re,c as Ye,d as F,e as Qe,f as Ue,g as Xe}from"./chunk-JNOO3R6U.js";import{a as Ie,b as Ve,c as Fe,d as Ae,e as Be,f as Le,g as Ne,h as He,i as ze,j as We,k as $e}from"./chunk-Y6UNS2UZ.js";import{a as Ge,c as Je,f as Ke}from"./chunk-N7KP3IEB.js";import{a as Oe}from"./chunk-7TD3HKIE.js";import{a as we,b as Ee,c as Te,d as De}from"./chunk-5EOBZ7FL.js";import{a as ke,b as Pe}from"./chunk-ASZQIH2H.js";import"./chunk-2LVKS4R7.js";import{a as be,b as ve}from"./chunk-FSRW5HPF.js";import{g as se}from"./chunk-G2G2ZAA3.js";import"./chunk-65NYBKEE.js";import{a as ce,b as de,c as pe,d as _e}from"./chunk-IDWAZBHT.js";import{a as le,b as me}from"./chunk-FSA3IEFI.js";import"./chunk-ECYJLMJT.js";import"./chunk-VKB6BRO6.js";import{b as ye}from"./chunk-NKUSL44D.js";import{b as ae,c as re}from"./chunk-IMRKXFOQ.js";import{d as Se,e as Ce}from"./chunk-TWB6D3BU.js";import{a as xe,b as Me}from"./chunk-CWSZZ2DY.js";import{b as K,e as X,f as Z,j as ee,k as te}from"./chunk-K3BNOLHS.js";import{b as ue,f as fe,j as he,x as ge}from"./chunk-AWW653NS.js";import{W as G,fa as J,la as ie,na as ne,oa as oe,u as U,v as q}from"./chunk-QQQ5XT6I.js";import"./chunk-YXFY4UXK.js";import{d as Q}from"./chunk-FFRRSTTN.js";import"./chunk-EARUC3FY.js";import{l as j,m as R,s as Y}from"./chunk-BAM5RHC5.js";import{$b as g,Eb as d,Fb as y,Gb as O,Ib as N,Pb as n,Qb as i,Rb as w,Sb as C,Tb as x,U as b,Vb as M,bb as s,bc as p,cb as v,f as A,fc as H,gc as z,hc as W,lc as V,mc as a,nc as I,oa as u,oc as S,pa as f,pb as L,rc as E,sc as T,tc as D,uc as $,v as B,wb as h}from"./chunk-MLNNMN4J.js";import{a as k,b as P}from"./chunk-TSRGIXR5.js";function it(t,l){if(t&1&&(n(0,"mat-option",39),a(1),i()),t&2){let e=l.$implicit;d("value",e.id),s(),S(" ",e.name," ")}}function nt(t,l){if(t&1&&(n(0,"mat-option",39),a(1),i()),t&2){let e=l.$implicit;d("value",e.id),s(),S(" ",e.name," ")}}function ot(t,l){if(t&1&&(n(0,"mat-option",39),a(1),i()),t&2){let e=l.$implicit;d("value",e.value),s(),S(" ",e.label," ")}}function at(t,l){t&1&&(n(0,"div",40),w(1,"mat-spinner",41),i())}function rt(t,l){if(t&1&&(n(0,"div",22)(1,"fuse-alert",42),a(2),i()()),t&2){let e=p();s(),d("dismissible",!0),s(),S(" ",e.error," ")}}function st(t,l){if(t&1&&(n(0,"th",70),a(1,"Placa"),i()),t&2){let e=p(2);y("width",e.isMobile?23:12,"%")}}function lt(t,l){if(t&1&&w(0,"div",75),t&2){let e=p().$implicit,r=p(2);y("background-color",r.getStatusCircleColor(e.status)),d("matTooltip",r.getStatusLabel(e.status))}}function mt(t,l){if(t&1&&(n(0,"td",71)(1,"div",72),h(2,lt,1,3,"div",73),n(3,"div",74),a(4),i()()()),t&2){let e=l.$implicit,r=p(2);s(2),d("ngIf",r.isMobile),s(2),I(e.plate)}}function ct(t,l){t&1&&(n(0,"th",76),a(1,"Sector"),i())}function dt(t,l){if(t&1&&(n(0,"td",71)(1,"div",77),a(2),i()()),t&2){let e=l.$implicit;s(2),I((e.sector==null?null:e.sector.name)||"N/A")}}function pt(t,l){t&1&&(n(0,"th",78),a(1,"Calle"),i())}function _t(t,l){if(t&1&&(n(0,"td",71)(1,"div",77),a(2),i()()),t&2){let e=l.$implicit;s(2),I((e.street==null?null:e.street.name)||"N/A")}}function ut(t,l){t&1&&(n(0,"th",79),a(1,"Operador"),i())}function ft(t,l){if(t&1&&(n(0,"td",71)(1,"div",77),a(2),i()()),t&2){let e=l.$implicit;s(2),I((e.operator==null?null:e.operator.name)||"N/A")}}function ht(t,l){if(t&1&&(n(0,"th",80),a(1,"Inicio"),i()),t&2){let e=p(2);y("width",e.isMobile?18:15,"%")}}function gt(t,l){if(t&1&&(n(0,"td",71)(1,"div",77),a(2),i()()),t&2){let e=l.$implicit,r=p(2);s(),O("text-xs",r.isMobile),s(),S(" ",r.isMobile?r.formatDateTimeMobile(e.started_at):r.formatDateTime(e.started_at)," ")}}function St(t,l){if(t&1&&(n(0,"th",81),a(1,"Fin"),i()),t&2){let e=p(2);y("width",e.isMobile?18:15,"%")}}function Ct(t,l){if(t&1&&(n(0,"td",71)(1,"div",77),a(2),i()()),t&2){let e=l.$implicit,r=p(2);s(),O("text-xs",r.isMobile),s(),S(" ",e.ended_at?r.isMobile?r.formatDateTimeMobile(e.ended_at):r.formatDateTime(e.ended_at):"-"," ")}}function xt(t,l){if(t&1&&(n(0,"th",82),a(1,"Duraci\xF3n"),i()),t&2){let e=p(2);y("width",e.isMobile?12:10,"%")}}function Mt(t,l){if(t&1&&(n(0,"td",71)(1,"div",77),a(2),i()()),t&2){let e=l.$implicit,r=p(2);s(),O("text-xs",r.isMobile),s(),S(" ",e.duration_formatted||"-"," ")}}function bt(t,l){t&1&&(n(0,"span"),a(1,"$"),i())}function vt(t,l){t&1&&(n(0,"span"),a(1,"Monto"),i())}function yt(t,l){if(t&1&&(n(0,"th",83),h(1,bt,2,0,"span",36)(2,vt,2,0,"span",36),i()),t&2){let e=p(2);y("width",e.isMobile?12:10,"%"),s(),d("ngIf",e.isMobile),s(),d("ngIf",!e.isMobile)}}function wt(t,l){if(t&1&&(n(0,"td",71)(1,"div",84),a(2),i()()),t&2){let e=l.$implicit,r=p(2);s(),O("text-xs",r.isMobile),s(),S(" ",e.total_paid_formatted||"-"," ")}}function Et(t,l){t&1&&(n(0,"th",85),a(1,"Estado"),i())}function Tt(t,l){if(t&1&&(n(0,"td",71)(1,"span",86),a(2),i()()),t&2){let e=l.$implicit,r=p(2);s(),N("bg-"+r.getStatusColor(e.status)+"-100 text-"+r.getStatusColor(e.status)+"-800"),s(),S(" ",r.getStatusLabel(e.status)," ")}}function Dt(t,l){t&1&&(n(0,"span"),a(1,"Acciones"),i())}function kt(t,l){if(t&1&&(n(0,"th",87),h(1,Dt,2,0,"span",36),i()),t&2){let e=p(2);y("width",(e.isMobile,10),"%"),s(),d("ngIf",!e.isMobile)}}function Pt(t,l){if(t&1){let e=M();n(0,"button",90),g("click",function(){u(e);let o=p().$implicit,m=p(2);return f(m.editSession(o))}),n(1,"mat-icon"),a(2,"edit"),i(),a(3," Editar "),i()}}function Ot(t,l){if(t&1){let e=M();n(0,"button",90),g("click",function(){u(e);let o=p().$implicit,m=p(2);return f(m.checkoutSession(o))}),n(1,"mat-icon"),a(2,"exit_to_app"),i(),a(3," Checkout "),i()}}function It(t,l){if(t&1){let e=M();n(0,"button",90),g("click",function(){u(e);let o=p().$implicit,m=p(2);return f(m.paySession(o))}),n(1,"mat-icon"),a(2,"payment"),i(),a(3," Pagar "),i()}}function Vt(t,l){if(t&1){let e=M();n(0,"button",93),g("click",function(){u(e);let o=p().$implicit,m=p(2);return f(m.cancelSession(o))}),n(1,"mat-icon"),a(2,"cancel"),i(),a(3," Cancelar "),i()}}function Ft(t,l){if(t&1){let e=M();n(0,"td",88)(1,"button",89)(2,"mat-icon"),a(3,"more_vert"),i()(),n(4,"mat-menu",null,2)(6,"button",90),g("click",function(){let o=u(e).$implicit,m=p(2);return f(m.viewSession(o))}),n(7,"mat-icon"),a(8,"visibility"),i(),a(9," Ver Detalles "),i(),h(10,Pt,4,0,"button",91)(11,Ot,4,0,"button",91)(12,It,4,0,"button",91)(13,Vt,4,0,"button",92),i()()}if(t&2){let e=l.$implicit,r=V(5),o=p(2);s(),d("matMenuTriggerFor",r),s(9),d("ngIf",o.canEdit(e)),s(),d("ngIf",o.canCheckout(e)),s(),d("ngIf",o.canPay(e)),s(),d("ngIf",o.canCancel(e))}}function At(t,l){t&1&&w(0,"tr",94)}function Bt(t,l){t&1&&w(0,"tr",95)}function Lt(t,l){if(t&1){let e=M();n(0,"mat-card")(1,"mat-card-content",43)(2,"div",44)(3,"table",45),g("matSortChange",function(o){u(e);let m=p();return f(m.onSortChange(o))}),C(4,46),h(5,st,2,2,"th",47)(6,mt,5,2,"td",48),x(),C(7,49),h(8,ct,2,0,"th",50)(9,dt,3,1,"td",48),x(),C(10,51),h(11,pt,2,0,"th",52)(12,_t,3,1,"td",48),x(),C(13,53),h(14,ut,2,0,"th",54)(15,ft,3,1,"td",48),x(),C(16,55),h(17,ht,2,2,"th",56)(18,gt,3,3,"td",48),x(),C(19,57),h(20,St,2,2,"th",58)(21,Ct,3,3,"td",48),x(),C(22,59),h(23,xt,2,2,"th",60)(24,Mt,3,3,"td",48),x(),C(25,61),h(26,yt,3,4,"th",62)(27,wt,3,3,"td",48),x(),C(28,63),h(29,Et,2,0,"th",64)(30,Tt,3,3,"td",48),x(),C(31,65),h(32,kt,2,3,"th",66)(33,Ft,14,5,"td",67),x(),h(34,At,1,0,"tr",68)(35,Bt,1,0,"tr",69),i()()()()}if(t&2){let e=p();s(3),d("dataSource",e.sessions)("matSortActive",e.sortBy)("matSortDirection",e.sortOrder)("matSortDisableClear",!0),s(31),d("matHeaderRowDef",e.isMobile?e.displayedColumnsMobile:e.displayedColumns),s(),d("matRowDefColumns",e.isMobile?e.displayedColumnsMobile:e.displayedColumns)}}function Nt(t,l){if(t&1){let e=M();n(0,"mat-paginator",96),g("page",function(o){u(e);let m=p();return f(m.onPageChange(o))}),i()}if(t&2){let e=p();d("length",e.totalItems)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("pageIndex",e.currentPage)}}function Ht(t,l){if(t&1){let e=M();n(0,"div",97)(1,"mat-icon",98),a(2,"directions_car"),i(),n(3,"h3",99),a(4,"No hay sesiones"),i(),n(5,"p",100),a(6,"No se encontraron sesiones con los filtros aplicados."),i(),n(7,"button",7),g("click",function(){u(e);let o=p();return f(o.createNewSession())}),n(8,"mat-icon"),a(9,"add"),i(),a(10," Crear Nueva Sesi\xF3n "),i()()}}var Ii=(()=>{class t{constructor(e,r,o,m,_,c,tt){this.sessionService=e,this.sectorService=r,this.operatorService=o,this.router=m,this.snackBar=_,this.confirmationService=c,this.breakpointObserver=tt,this._unsubscribeAll=new A,this.sessions=[],this.loading=!1,this.error=null,this.totalSessions=0,this.activeSessionsCount=0,this.completedSessionsCount=0,this.loadingMetrics=!1,this.totalItems=0,this.pageSize=15,this.currentPage=0,this.pageSizeOptions=[5,10,15,25,50],this.sortBy="started_at",this.sortOrder="desc",this.filters={plate:"",sector_id:void 0,operator_id:void 0,status:"",date_from:"",date_to:""},this.dateFromModel=null,this.dateToModel=null,this.sectors=[],this.operators=[],this.statusOptions=[{value:"",label:"Todos"},{value:"CREATED",label:"Creada"},{value:"ACTIVE",label:"Activa"},{value:"TO_PAY",label:"Por Pagar"},{value:"PAID",label:"Pagada"},{value:"CLOSED",label:"Cerrada"},{value:"CANCELED",label:"Cancelada"}],this.displayedColumns=["plate","sector","street","operator","started_at","ended_at","duration","amount","status","actions"],this.displayedColumnsMobile=["plate","started_at","ended_at","duration","amount","actions"],this.isMobile=!1}ngOnInit(){this.loadSectors(),this.loadOperators(),this.loadSessions(),this.loadMetrics(),this.breakpointObserver.observe([q.Handset]).pipe(b(this._unsubscribeAll)).subscribe(e=>{this.isMobile=e.matches})}ngAfterViewInit(){this.sort&&setTimeout(()=>{this.sort.active=this.sortBy,this.sort.direction=this.sortOrder},0)}onSortChange(e){console.log("Sort change event:",e),e.active===this.sortBy?this.sortOrder==="desc"?this.sortOrder="asc":this.sortOrder="desc":(this.sortBy=e.active,this.sortOrder=e.direction==="asc"?"asc":"desc"),console.log("Updated sortBy:",this.sortBy,"sortOrder:",this.sortOrder),this.currentPage=0,this.loadSessions()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadSessions(){this.loading=!0,this.error=null;let e={page:this.currentPage+1,per_page:this.pageSize,sort_by:this.sortBy,sort_order:this.sortOrder};this.filters.plate&&this.filters.plate.trim()!==""&&(e.plate=this.filters.plate.trim()),this.filters.sector_id!==void 0&&this.filters.sector_id!==null&&(e.sector_id=this.filters.sector_id),this.filters.operator_id!==void 0&&this.filters.operator_id!==null&&(e.operator_id=this.filters.operator_id),this.filters.status&&this.filters.status.trim()!==""&&(e.status=this.filters.status),this.filters.date_from&&this.filters.date_from.trim()!==""&&(e.date_from=this.filters.date_from),this.filters.date_to&&this.filters.date_to.trim()!==""&&(e.date_to=this.filters.date_to),this.sessionService.getSessions(e).pipe(b(this._unsubscribeAll)).subscribe({next:r=>{this.sessions=r.data||[],this.totalItems=r.pagination?.total||0,this.loading=!1},error:r=>{this.error="Error al cargar sesiones",this.loading=!1,console.error("Error loading sessions:",r),this.snackBar.open("Error al cargar sesiones","Cerrar",{duration:3e3})}})}loadMetrics(){this.loadingMetrics=!0;let e={};this.filters.plate&&this.filters.plate.trim()!==""&&(e.plate=this.filters.plate.trim()),this.filters.sector_id!==void 0&&this.filters.sector_id!==null&&(e.sector_id=this.filters.sector_id),this.filters.operator_id!==void 0&&this.filters.operator_id!==null&&(e.operator_id=this.filters.operator_id),this.filters.date_from&&this.filters.date_from.trim()!==""&&(e.date_from=this.filters.date_from),this.filters.date_to&&this.filters.date_to.trim()!==""&&(e.date_to=this.filters.date_to);let r=P(k({},e),{page:1,per_page:1}),o=P(k({},e),{status:"ACTIVE",page:1,per_page:1}),m=P(k({},e),{status:"COMPLETED",page:1,per_page:1});if(this.filters.status&&this.filters.status.trim()!==""){let _=P(k({},e),{status:this.filters.status,page:1,per_page:1});this.sessionService.getSessions(_).pipe(b(this._unsubscribeAll)).subscribe({next:c=>{this.totalSessions=c.pagination?.total||0,this.filters.status==="ACTIVE"?(this.activeSessionsCount=c.pagination?.total||0,this.completedSessionsCount=0):this.filters.status==="COMPLETED"?(this.activeSessionsCount=0,this.completedSessionsCount=c.pagination?.total||0):(this.activeSessionsCount=0,this.completedSessionsCount=0),this.loadingMetrics=!1},error:c=>{console.error("Error loading metrics:",c),this.loadingMetrics=!1}})}else B({total:this.sessionService.getSessions(r),active:this.sessionService.getSessions(o),completed:this.sessionService.getSessions(m)}).pipe(b(this._unsubscribeAll)).subscribe({next:_=>{this.totalSessions=_.total?.pagination?.total||0,this.activeSessionsCount=_.active?.pagination?.total||0,this.completedSessionsCount=_.completed?.pagination?.total||0,this.loadingMetrics=!1},error:_=>{console.error("Error loading metrics:",_),this.loadingMetrics=!1}})}loadSectors(){this.sectorService.getSectors().pipe(b(this._unsubscribeAll)).subscribe({next:e=>{this.sectors=e.data?.data||[]},error:e=>{console.error("Error loading sectors:",e)}})}loadOperators(){this.operatorService.getOperators().pipe(b(this._unsubscribeAll)).subscribe({next:e=>{this.operators=e.data?.data||[]},error:e=>{console.error("Error loading operators:",e)}})}viewSession(e){this.router.navigate(["/parking/sessions",e.id])}editSession(e){e.status==="ACTIVE"?this.router.navigate(["/parking/sessions",e.id,"edit"]):this.snackBar.open("Solo se pueden editar sesiones activas","Cerrar",{duration:3e3})}cancelSession(e){if(e.status!=="ACTIVE"){this.snackBar.open("Solo se pueden cancelar sesiones activas","Cerrar",{duration:3e3});return}this.confirmationService.open({title:"Cancelar Sesi\xF3n",message:`\xBFEst\xE1 seguro de cancelar la sesi\xF3n de la placa ${e.plate}?`,icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Cancelar Sesi\xF3n",color:"warn"},cancel:{show:!0,label:"No"}}}).afterClosed().subscribe(o=>{o==="confirmed"&&this.sessionService.cancelSession(e.id).pipe(b(this._unsubscribeAll)).subscribe({next:m=>{this.snackBar.open("Sesi\xF3n cancelada exitosamente","Cerrar",{duration:3e3}),this.loadSessions()},error:m=>{this.snackBar.open("Error al cancelar sesi\xF3n","Cerrar",{duration:3e3}),console.error("Error canceling session:",m)}})})}checkoutSession(e){if(e.status!=="ACTIVE"){this.snackBar.open("Solo se puede hacer checkout de sesiones activas","Cerrar",{duration:3e3});return}this.router.navigate(["/parking/sessions",e.id,"checkout"])}paySession(e){if(e.status!=="TO_PAY"){this.snackBar.open("Solo se pueden pagar sesiones pendientes de pago","Cerrar",{duration:3e3});return}this.router.navigate(["/parking/sessions",e.id,"payment"])}formatAmount(e){return this.sessionService.formatAmount(e)}formatDate(e){return new Date(e).toLocaleString("es-CL")}formatDateTime(e){if(!e)return"N/A";let r=new Date(e);if(isNaN(r.getTime()))return"N/A";let o=r.toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}),m=r.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${o} ${m}`}formatDateTimeMobile(e){if(!e)return"-";let r=new Date(e);if(isNaN(r.getTime()))return"-";let o=String(r.getDate()).padStart(2,"0"),m=String(r.getMonth()+1).padStart(2,"0"),_=String(r.getHours()).padStart(2,"0"),c=String(r.getMinutes()).padStart(2,"0");return`${o}/${m} ${_}:${c}`}formatDuration(e){return this.sessionService.formatDuration(e)}getStatusLabel(e){return this.sessionService.getStatusLabel(e)}getStatusColor(e){return this.sessionService.getStatusColor(e)}getStatusCircleColor(e){return{CREATED:"#6B7280",ACTIVE:"#3B82F6",TO_PAY:"#F59E0B",PAID:"#10B981",CLOSED:"#10B981",CANCELED:"#EF4444"}[e]||"#6B7280"}getTotalSessionsCount(){return this.loadingMetrics?0:this.totalSessions}getActiveSessionsCount(){return this.loadingMetrics?0:this.activeSessionsCount}getCompletedSessionsCount(){return this.loadingMetrics?0:this.completedSessionsCount}canEdit(e){return e.status==="ACTIVE"}canCancel(e){return e.status==="ACTIVE"}canCheckout(e){return e.status==="ACTIVE"}canPay(e){return e.status==="TO_PAY"}createNewSession(){this.router.navigate(["/parking/sessions/new"])}exportSessions(){this.snackBar.open("Funcionalidad de exportaci\xF3n en desarrollo","Cerrar",{duration:3e3})}refreshSessions(){this.loadSessions(),this.loadMetrics()}onSearchChange(e){this.filters.plate=e||""}onSectorChange(e){e===""||e===null?this.filters.sector_id=void 0:this.filters.sector_id=typeof e=="number"?e:parseInt(e,10),this.applyFilters()}onOperatorChange(e){e===""||e===null?this.filters.operator_id=void 0:this.filters.operator_id=typeof e=="number"?e:parseInt(e,10),this.applyFilters()}onStatusChange(e){this.filters.status=e||"",this.applyFilters()}formatDateLocal(e){let r=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),m=String(e.getDate()).padStart(2,"0");return`${r}-${o}-${m}`}onDateFromChange(e){e?this.filters.date_from=this.formatDateLocal(e):this.filters.date_from="",this.applyFilters()}onDateToChange(e){e?this.filters.date_to=this.formatDateLocal(e):this.filters.date_to="",this.applyFilters()}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.loadSessions()}applyFilters(){this.currentPage=0,this.loadSessions(),this.loadMetrics()}clearFilters(){this.filters={plate:"",sector_id:void 0,operator_id:void 0,status:"",date_from:"",date_to:""},this.dateFromModel=null,this.dateToModel=null,this.currentPage=0,this.loadSessions(),this.loadMetrics()}static{this.\u0275fac=function(r){return new(r||t)(v(Oe),v(Ze),v(et),v(Q),v(be),v(se),v(U))}}static{this.\u0275cmp=L({type:t,selectors:[["app-sessions"]],viewQuery:function(r,o){if(r&1&&H(F,5),r&2){let m;z(m=W())&&(o.sort=m.first)}},features:[$([{provide:je,useValue:Xe()}])],decls:101,vars:21,consts:[["pickerFrom",""],["pickerTo",""],["actionMenu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","mb-6"],[1,"p-6"],[1,"flex","items-center"],[1,"p-3","bg-blue-100","rounded-full"],[1,"text-blue-600"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"p-3","bg-green-100","rounded-full"],[1,"text-green-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"p-3","bg-purple-100","rounded-full"],[1,"text-purple-600"],[1,"text-2xl","font-bold","text-purple-600"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["appearance","outline"],["matInput","","placeholder","ABC123",3,"ngModelChange","ngModel"],["matPrefix",""],[3,"ngModelChange","selectionChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","DD/MM/YYYY",3,"ngModelChange","dateChange","matDatepicker","ngModel"],["matSuffix","",3,"for"],[1,"flex","justify-end","gap-2","mt-4"],["mat-stroked-button","",1,"rounded-sm",3,"click"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","mb-6",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","","class","mt-4",3,"length","pageSize","pageSizeOptions","pageIndex","page",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[3,"value"],[1,"flex","justify-center","items-center","h-64"],["diameter","50"],["type","error",3,"dismissible"],[1,"p-0"],[1,"overflow-x-auto"],["mat-table","","matSort","",1,"w-full","mat-elevation-z2",2,"width","100%","table-layout","fixed",3,"matSortChange","dataSource","matSortActive","matSortDirection","matSortDisableClear"],["matColumnDef","plate"],["mat-header-cell","","mat-sort-header","plate",3,"width",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sector"],["mat-header-cell","","mat-sort-header","sector_id","style","width: 12%;",4,"matHeaderCellDef"],["matColumnDef","street"],["mat-header-cell","","mat-sort-header","street_id","style","width: 12%;",4,"matHeaderCellDef"],["matColumnDef","operator"],["mat-header-cell","","mat-sort-header","operator_in_id","style","width: 15%;",4,"matHeaderCellDef"],["matColumnDef","started_at"],["mat-header-cell","","mat-sort-header","started_at",3,"width",4,"matHeaderCellDef"],["matColumnDef","ended_at"],["mat-header-cell","","mat-sort-header","ended_at",3,"width",4,"matHeaderCellDef"],["matColumnDef","duration"],["mat-header-cell","","mat-sort-header","seconds_total",3,"width",4,"matHeaderCellDef"],["matColumnDef","amount"],["mat-header-cell","","mat-sort-header","net_amount",3,"width",4,"matHeaderCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","status","style","width: 10%;",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","text-right",3,"width",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","plate"],["mat-cell",""],[1,"flex","items-center","gap-2"],["class","status-circle flex-shrink-0",3,"background-color","matTooltip",4,"ngIf"],[1,"font-medium","text-gray-900"],[1,"status-circle","flex-shrink-0",3,"matTooltip"],["mat-header-cell","","mat-sort-header","sector_id",2,"width","12%"],[1,"text-sm","text-gray-600"],["mat-header-cell","","mat-sort-header","street_id",2,"width","12%"],["mat-header-cell","","mat-sort-header","operator_in_id",2,"width","15%"],["mat-header-cell","","mat-sort-header","started_at"],["mat-header-cell","","mat-sort-header","ended_at"],["mat-header-cell","","mat-sort-header","seconds_total"],["mat-header-cell","","mat-sort-header","net_amount"],[1,"text-sm","font-medium","text-gray-900"],["mat-header-cell","","mat-sort-header","status",2,"width","10%"],[1,"px-2","py-1","rounded","text-xs","font-medium"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","","class","text-red-600",3,"click",4,"ngIf"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""],["showFirstLastButtons","",1,"mt-4",3,"page","length","pageSize","pageSizeOptions","pageIndex"],[1,"text-center","py-12"],[1,"text-6xl","text-gray-400","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"]],template:function(r,o){if(r&1){let m=M();n(0,"div",3)(1,"div",4)(2,"div")(3,"h1",5),a(4,"Sesiones"),i(),n(5,"p",6),a(6,"Gestiona las sesiones de estacionamiento del sistema"),i()(),n(7,"button",7),g("click",function(){return u(m),f(o.createNewSession())}),n(8,"mat-icon"),a(9,"add"),i(),a(10," Nueva Sesi\xF3n "),i()(),n(11,"div",8)(12,"mat-card")(13,"mat-card-content",9)(14,"div",10)(15,"div",11)(16,"mat-icon",12),a(17,"directions_car"),i()(),n(18,"div",13)(19,"p",14),a(20,"Total de Sesiones"),i(),n(21,"p",15),a(22),i()()()()(),n(23,"mat-card")(24,"mat-card-content",9)(25,"div",10)(26,"div",16)(27,"mat-icon",17),a(28,"play_circle"),i()(),n(29,"div",13)(30,"p",14),a(31,"Sesiones Activas"),i(),n(32,"p",18),a(33),i()()()()(),n(34,"mat-card")(35,"mat-card-content",9)(36,"div",10)(37,"div",19)(38,"mat-icon",20),a(39,"check_circle"),i()(),n(40,"div",13)(41,"p",14),a(42,"Sesiones Completadas"),i(),n(43,"p",21),a(44),i()()()()()(),n(45,"mat-card",22)(46,"mat-card-content",9)(47,"div",23)(48,"mat-form-field",24)(49,"mat-label"),a(50,"Buscar por Placa"),i(),n(51,"input",25),D("ngModelChange",function(c){return u(m),T(o.filters.plate,c)||(o.filters.plate=c),f(c)}),i(),n(52,"mat-icon",26),a(53,"search"),i()(),n(54,"mat-form-field",24)(55,"mat-label"),a(56,"Sector"),i(),n(57,"mat-select",27),D("ngModelChange",function(c){return u(m),T(o.filters.sector_id,c)||(o.filters.sector_id=c),f(c)}),g("selectionChange",function(c){return u(m),f(o.onSectorChange(c.value))}),n(58,"mat-option",28),a(59,"Todos los sectores"),i(),h(60,it,2,2,"mat-option",29),i()(),n(61,"mat-form-field",24)(62,"mat-label"),a(63,"Operador"),i(),n(64,"mat-select",27),D("ngModelChange",function(c){return u(m),T(o.filters.operator_id,c)||(o.filters.operator_id=c),f(c)}),g("selectionChange",function(c){return u(m),f(o.onOperatorChange(c.value))}),n(65,"mat-option",28),a(66,"Todos los operadores"),i(),h(67,nt,2,2,"mat-option",29),i()(),n(68,"mat-form-field",24)(69,"mat-label"),a(70,"Estado"),i(),n(71,"mat-select",27),D("ngModelChange",function(c){return u(m),T(o.filters.status,c)||(o.filters.status=c),f(c)}),g("selectionChange",function(c){return u(m),f(o.onStatusChange(c.value))}),h(72,ot,2,2,"mat-option",29),i()(),n(73,"mat-form-field",24)(74,"mat-label"),a(75,"Fecha Desde"),i(),n(76,"input",30),D("ngModelChange",function(c){return u(m),T(o.dateFromModel,c)||(o.dateFromModel=c),f(c)}),g("dateChange",function(c){return u(m),f(o.onDateFromChange(c.value))}),i(),w(77,"mat-datepicker-toggle",31)(78,"mat-datepicker",null,0),i(),n(80,"mat-form-field",24)(81,"mat-label"),a(82,"Fecha Hasta"),i(),n(83,"input",30),D("ngModelChange",function(c){return u(m),T(o.dateToModel,c)||(o.dateToModel=c),f(c)}),g("dateChange",function(c){return u(m),f(o.onDateToChange(c.value))}),i(),w(84,"mat-datepicker-toggle",31)(85,"mat-datepicker",null,1),i()(),n(87,"div",32)(88,"button",33),g("click",function(){return u(m),f(o.clearFilters())}),n(89,"mat-icon"),a(90,"clear"),i(),a(91," Limpiar "),i(),n(92,"button",7),g("click",function(){return u(m),f(o.applyFilters())}),n(93,"mat-icon"),a(94,"search"),i(),a(95," Filtrar "),i()()()(),h(96,at,2,0,"div",34)(97,rt,3,2,"div",35)(98,Lt,36,6,"mat-card",36)(99,Nt,1,4,"mat-paginator",37)(100,Ht,11,0,"div",38),i()}if(r&2){let m=V(79),_=V(86);s(22),S(" ",o.loadingMetrics?"...":o.getTotalSessionsCount()," "),s(11),S(" ",o.loadingMetrics?"...":o.getActiveSessionsCount()," "),s(11),S(" ",o.loadingMetrics?"...":o.getCompletedSessionsCount()," "),s(7),E("ngModel",o.filters.plate),s(6),E("ngModel",o.filters.sector_id),s(3),d("ngForOf",o.sectors),s(4),E("ngModel",o.filters.operator_id),s(3),d("ngForOf",o.operators),s(4),E("ngModel",o.filters.status),s(),d("ngForOf",o.statusOptions),s(4),d("matDatepicker",m),E("ngModel",o.dateFromModel),s(),d("for",m),s(6),d("matDatepicker",_),E("ngModel",o.dateToModel),s(),d("for",_),s(12),d("ngIf",o.loading),s(),d("ngIf",o.error),s(),d("ngIf",!o.loading),s(),d("ngIf",!o.loading&&o.sessions.length>0),s(),d("ngIf",!o.loading&&o.sessions.length===0)}},dependencies:[Y,j,R,ge,ue,fe,he,$e,Ie,Fe,Ne,Ae,Ve,He,Be,Le,ze,We,Ye,Re,Ue,F,Qe,oe,ie,ne,re,ae,te,ee,K,X,Z,Ce,Se,Pe,ke,J,De,we,Ee,Te,G,qe,me,le,_e,de,ce,pe,ve,Me,xe,ye,Ke,Ge,Je],styles:[".mat-chip[_ngcontent-%COMP%]{font-size:12px;font-weight:500}.mat-chip.mat-chip-green[_ngcontent-%COMP%]{background-color:#10b981;color:#fff}.mat-chip.mat-chip-blue[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.mat-chip.mat-chip-orange[_ngcontent-%COMP%]{background-color:#f59e0b;color:#fff}.mat-chip.mat-chip-red[_ngcontent-%COMP%]{background-color:#ef4444;color:#fff}.mat-chip.mat-chip-gray[_ngcontent-%COMP%]{background-color:#6b7280;color:#fff}.table-container[_ngcontent-%COMP%]{overflow-x:auto}@media (max-width: 768px){.mat-table[_ngcontent-%COMP%]{font-size:14px}.mat-header-cell[_ngcontent-%COMP%]{font-size:11px!important;font-weight:500}.mat-column-actions[_ngcontent-%COMP%]{width:60px}.mat-column-street[_ngcontent-%COMP%], .mat-column-operator[_ngcontent-%COMP%], .mat-column-sector[_ngcontent-%COMP%]{display:none}.status-circle[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:2px;display:inline-block;cursor:pointer;transition:transform .2s}.status-circle[_ngcontent-%COMP%]:hover{transform:scale(1.2)}}.filters-section[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:1.5rem;margin-bottom:1.5rem}.action-button[_ngcontent-%COMP%]{margin-right:8px}.action-button[_ngcontent-%COMP%]:last-child{margin-right:0}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;height:4rem;width:4rem;color:#9ca3af;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#111827;font-size:1.125rem;font-weight:500;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:16rem}.error-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}"]})}}return t})();export{Ii as SessionsComponent};
