import{a as te}from"./chunk-N3LDMRIB.js";import{a as Zt}from"./chunk-ZMFSOZJA.js";import{c as qt}from"./chunk-ICPS6N2F.js";import{a as jt,b as Rt,c as Yt,d as F,e as Qt,f as Ut,g as Xt}from"./chunk-JNOO3R6U.js";import{a as It,b as Vt,c as Ft,d as At,e as Bt,f as Lt,g as Nt,h as Ht,i as zt,j as Wt,k as $t}from"./chunk-Y6UNS2UZ.js";import{a as Gt,c as Jt,f as Kt}from"./chunk-N7KP3IEB.js";import{a as Ot}from"./chunk-7TD3HKIE.js";import{a as wt,b as Et,c as Tt,d as Dt}from"./chunk-5EOBZ7FL.js";import{a as kt,b as Pt}from"./chunk-ASZQIH2H.js";import"./chunk-2LVKS4R7.js";import{a as bt,b as vt}from"./chunk-FSRW5HPF.js";import{g as st}from"./chunk-G2G2ZAA3.js";import"./chunk-65NYBKEE.js";import{a as ct,b as dt,c as pt,d as _t}from"./chunk-IDWAZBHT.js";import{a as lt,b as mt}from"./chunk-FSA3IEFI.js";import"./chunk-ECYJLMJT.js";import"./chunk-VKB6BRO6.js";import{b as yt}from"./chunk-NKUSL44D.js";import{b as at,c as rt}from"./chunk-IMRKXFOQ.js";import{d as St,e as Ct}from"./chunk-TWB6D3BU.js";import{a as xt,b as Mt}from"./chunk-CWSZZ2DY.js";import{b as K,e as X,f as Z,j as tt,k as et}from"./chunk-K3BNOLHS.js";import{b as ut,f as ft,j as ht,x as gt}from"./chunk-AWW653NS.js";import{W as G,fa as J,la as it,na as nt,oa as ot,u as U,v as q}from"./chunk-QQQ5XT6I.js";import"./chunk-YXFY4UXK.js";import{d as Q}from"./chunk-FFRRSTTN.js";import"./chunk-EARUC3FY.js";import{l as j,m as R,s as Y}from"./chunk-BAM5RHC5.js";import{$b as g,Eb as _,Fb as y,Gb as O,Ib as N,Pb as o,Qb as i,Rb as w,Sb as C,Tb as x,U as b,Vb as M,bb as s,bc as d,cb as v,f as A,fc as H,gc as z,hc as W,lc as V,mc as a,nc as I,oa as u,oc as S,pa as f,pb as L,rc as E,sc as T,tc as D,uc as $,v as B,wb as h}from"./chunk-MLNNMN4J.js";import{a as k,b as P}from"./chunk-TSRGIXR5.js";function ie(e,l){if(e&1&&(o(0,"mat-option",39),a(1),i()),e&2){let t=l.$implicit;_("value",t.id),s(),S(" ",t.name," ")}}function ne(e,l){if(e&1&&(o(0,"mat-option",39),a(1),i()),e&2){let t=l.$implicit;_("value",t.id),s(),S(" ",t.name," ")}}function oe(e,l){if(e&1&&(o(0,"mat-option",39),a(1),i()),e&2){let t=l.$implicit;_("value",t.value),s(),S(" ",t.label," ")}}function ae(e,l){e&1&&(o(0,"div",40),w(1,"mat-spinner",41),i())}function re(e,l){if(e&1&&(o(0,"div",22)(1,"fuse-alert",42),a(2),i()()),e&2){let t=d();s(),_("dismissible",!0),s(),S(" ",t.error," ")}}function se(e,l){if(e&1&&(o(0,"th",70),a(1,"Placa"),i()),e&2){let t=d(2);y("width",t.isMobile?18:12,"%")}}function le(e,l){if(e&1&&w(0,"div",75),e&2){let t=d().$implicit,r=d(2);y("background-color",r.getStatusCircleColor(t.status)),_("matTooltip",r.getStatusLabel(t.status))}}function me(e,l){if(e&1&&(o(0,"td",71)(1,"div",72),h(2,le,1,3,"div",73),o(3,"div",74),a(4),i()()()),e&2){let t=l.$implicit,r=d(2);s(2),_("ngIf",r.isMobile),s(2),I(t.plate)}}function ce(e,l){e&1&&(o(0,"th",76),a(1,"Sector"),i())}function de(e,l){if(e&1&&(o(0,"td",71)(1,"div",77),a(2),i()()),e&2){let t=l.$implicit;s(2),I((t.sector==null?null:t.sector.name)||"N/A")}}function pe(e,l){e&1&&(o(0,"th",78),a(1,"Calle"),i())}function _e(e,l){if(e&1&&(o(0,"td",71)(1,"div",77),a(2),i()()),e&2){let t=l.$implicit;s(2),I((t.street==null?null:t.street.name)||"N/A")}}function ue(e,l){e&1&&(o(0,"th",79),a(1,"Operador"),i())}function fe(e,l){if(e&1&&(o(0,"td",71)(1,"div",77),a(2),i()()),e&2){let t=l.$implicit;s(2),I((t.operator==null?null:t.operator.name)||"N/A")}}function he(e,l){if(e&1&&(o(0,"th",80),a(1,"Inicio"),i()),e&2){let t=d(2);y("width",t.isMobile?18:15,"%")}}function ge(e,l){if(e&1&&(o(0,"td",71)(1,"div",77),a(2),i()()),e&2){let t=l.$implicit,r=d(2);s(),O("text-xs",r.isMobile),s(),S(" ",r.isMobile?r.formatDateTimeMobile(t.started_at):r.formatDateTime(t.started_at)," ")}}function Se(e,l){if(e&1&&(o(0,"th",81),a(1,"Fin"),i()),e&2){let t=d(2);y("width",t.isMobile?18:15,"%")}}function Ce(e,l){if(e&1&&(o(0,"td",71)(1,"div",77),a(2),i()()),e&2){let t=l.$implicit,r=d(2);s(),O("text-xs",r.isMobile),s(),S(" ",t.ended_at?r.isMobile?r.formatDateTimeMobile(t.ended_at):r.formatDateTime(t.ended_at):"-"," ")}}function xe(e,l){if(e&1&&(o(0,"th",82),a(1,"Duraci\xF3n"),i()),e&2){let t=d(2);y("width",t.isMobile?12:10,"%")}}function Me(e,l){if(e&1&&(o(0,"td",71)(1,"div",77),a(2),i()()),e&2){let t=l.$implicit,r=d(2);s(),O("text-xs",r.isMobile),s(),S(" ",t.duration_formatted||"-"," ")}}function be(e,l){if(e&1&&(o(0,"th",83),a(1,"Monto"),i()),e&2){let t=d(2);y("width",t.isMobile?12:10,"%")}}function ve(e,l){if(e&1&&(o(0,"td",71)(1,"div",84),a(2),i()()),e&2){let t=l.$implicit,r=d(2);s(),O("text-xs",r.isMobile),s(),S(" ",t.total_paid_formatted||"-"," ")}}function ye(e,l){e&1&&(o(0,"th",85),a(1,"Estado"),i())}function we(e,l){if(e&1&&(o(0,"td",71)(1,"span",86),a(2),i()()),e&2){let t=l.$implicit,r=d(2);s(),N("bg-"+r.getStatusColor(t.status)+"-100 text-"+r.getStatusColor(t.status)+"-800"),s(),S(" ",r.getStatusLabel(t.status)," ")}}function Ee(e,l){if(e&1&&(o(0,"th",87),a(1,"Acciones"),i()),e&2){let t=d(2);y("width",(t.isMobile,10),"%")}}function Te(e,l){if(e&1){let t=M();o(0,"button",90),g("click",function(){u(t);let n=d().$implicit,m=d(2);return f(m.editSession(n))}),o(1,"mat-icon"),a(2,"edit"),i(),a(3," Editar "),i()}}function De(e,l){if(e&1){let t=M();o(0,"button",90),g("click",function(){u(t);let n=d().$implicit,m=d(2);return f(m.checkoutSession(n))}),o(1,"mat-icon"),a(2,"exit_to_app"),i(),a(3," Checkout "),i()}}function ke(e,l){if(e&1){let t=M();o(0,"button",90),g("click",function(){u(t);let n=d().$implicit,m=d(2);return f(m.paySession(n))}),o(1,"mat-icon"),a(2,"payment"),i(),a(3," Pagar "),i()}}function Pe(e,l){if(e&1){let t=M();o(0,"button",93),g("click",function(){u(t);let n=d().$implicit,m=d(2);return f(m.cancelSession(n))}),o(1,"mat-icon"),a(2,"cancel"),i(),a(3," Cancelar "),i()}}function Oe(e,l){if(e&1){let t=M();o(0,"td",88)(1,"button",89)(2,"mat-icon"),a(3,"more_vert"),i()(),o(4,"mat-menu",null,2)(6,"button",90),g("click",function(){let n=u(t).$implicit,m=d(2);return f(m.viewSession(n))}),o(7,"mat-icon"),a(8,"visibility"),i(),a(9," Ver Detalles "),i(),h(10,Te,4,0,"button",91)(11,De,4,0,"button",91)(12,ke,4,0,"button",91)(13,Pe,4,0,"button",92),i()()}if(e&2){let t=l.$implicit,r=V(5),n=d(2);s(),_("matMenuTriggerFor",r),s(9),_("ngIf",n.canEdit(t)),s(),_("ngIf",n.canCheckout(t)),s(),_("ngIf",n.canPay(t)),s(),_("ngIf",n.canCancel(t))}}function Ie(e,l){e&1&&w(0,"tr",94)}function Ve(e,l){e&1&&w(0,"tr",95)}function Fe(e,l){if(e&1){let t=M();o(0,"mat-card")(1,"mat-card-content",43)(2,"div",44)(3,"table",45),g("matSortChange",function(n){u(t);let m=d();return f(m.onSortChange(n))}),C(4,46),h(5,se,2,2,"th",47)(6,me,5,2,"td",48),x(),C(7,49),h(8,ce,2,0,"th",50)(9,de,3,1,"td",48),x(),C(10,51),h(11,pe,2,0,"th",52)(12,_e,3,1,"td",48),x(),C(13,53),h(14,ue,2,0,"th",54)(15,fe,3,1,"td",48),x(),C(16,55),h(17,he,2,2,"th",56)(18,ge,3,3,"td",48),x(),C(19,57),h(20,Se,2,2,"th",58)(21,Ce,3,3,"td",48),x(),C(22,59),h(23,xe,2,2,"th",60)(24,Me,3,3,"td",48),x(),C(25,61),h(26,be,2,2,"th",62)(27,ve,3,3,"td",48),x(),C(28,63),h(29,ye,2,0,"th",64)(30,we,3,3,"td",48),x(),C(31,65),h(32,Ee,2,2,"th",66)(33,Oe,14,5,"td",67),x(),h(34,Ie,1,0,"tr",68)(35,Ve,1,0,"tr",69),i()()()()}if(e&2){let t=d();s(3),_("dataSource",t.sessions)("matSortActive",t.sortBy)("matSortDirection",t.sortOrder)("matSortDisableClear",!0),s(31),_("matHeaderRowDef",t.isMobile?t.displayedColumnsMobile:t.displayedColumns),s(),_("matRowDefColumns",t.isMobile?t.displayedColumnsMobile:t.displayedColumns)}}function Ae(e,l){if(e&1){let t=M();o(0,"mat-paginator",96),g("page",function(n){u(t);let m=d();return f(m.onPageChange(n))}),i()}if(e&2){let t=d();_("length",t.totalItems)("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("pageIndex",t.currentPage)}}function Be(e,l){if(e&1){let t=M();o(0,"div",97)(1,"mat-icon",98),a(2,"directions_car"),i(),o(3,"h3",99),a(4,"No hay sesiones"),i(),o(5,"p",100),a(6,"No se encontraron sesiones con los filtros aplicados."),i(),o(7,"button",7),g("click",function(){u(t);let n=d();return f(n.createNewSession())}),o(8,"mat-icon"),a(9,"add"),i(),a(10," Crear Nueva Sesi\xF3n "),i()()}}var ki=(()=>{class e{constructor(t,r,n,m,p,c,ee){this.sessionService=t,this.sectorService=r,this.operatorService=n,this.router=m,this.snackBar=p,this.confirmationService=c,this.breakpointObserver=ee,this._unsubscribeAll=new A,this.sessions=[],this.loading=!1,this.error=null,this.totalSessions=0,this.activeSessionsCount=0,this.completedSessionsCount=0,this.loadingMetrics=!1,this.totalItems=0,this.pageSize=15,this.currentPage=0,this.pageSizeOptions=[5,10,15,25,50],this.sortBy="started_at",this.sortOrder="desc",this.filters={plate:"",sector_id:void 0,operator_id:void 0,status:"",date_from:"",date_to:""},this.dateFromModel=null,this.dateToModel=null,this.sectors=[],this.operators=[],this.statusOptions=[{value:"",label:"Todos"},{value:"CREATED",label:"Creada"},{value:"ACTIVE",label:"Activa"},{value:"TO_PAY",label:"Por Pagar"},{value:"PAID",label:"Pagada"},{value:"CLOSED",label:"Cerrada"},{value:"CANCELED",label:"Cancelada"}],this.displayedColumns=["plate","sector","street","operator","started_at","ended_at","duration","amount","status","actions"],this.displayedColumnsMobile=["plate","started_at","ended_at","duration","amount","actions"],this.isMobile=!1}ngOnInit(){this.loadSectors(),this.loadOperators(),this.loadSessions(),this.loadMetrics(),this.breakpointObserver.observe([q.Handset]).pipe(b(this._unsubscribeAll)).subscribe(t=>{this.isMobile=t.matches})}ngAfterViewInit(){this.sort&&setTimeout(()=>{this.sort.active=this.sortBy,this.sort.direction=this.sortOrder},0)}onSortChange(t){console.log("Sort change event:",t),t.active===this.sortBy?this.sortOrder==="desc"?this.sortOrder="asc":this.sortOrder="desc":(this.sortBy=t.active,this.sortOrder=t.direction==="asc"?"asc":"desc"),console.log("Updated sortBy:",this.sortBy,"sortOrder:",this.sortOrder),this.currentPage=0,this.loadSessions()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadSessions(){this.loading=!0,this.error=null;let t={page:this.currentPage+1,per_page:this.pageSize,sort_by:this.sortBy,sort_order:this.sortOrder};this.filters.plate&&this.filters.plate.trim()!==""&&(t.plate=this.filters.plate.trim()),this.filters.sector_id!==void 0&&this.filters.sector_id!==null&&(t.sector_id=this.filters.sector_id),this.filters.operator_id!==void 0&&this.filters.operator_id!==null&&(t.operator_id=this.filters.operator_id),this.filters.status&&this.filters.status.trim()!==""&&(t.status=this.filters.status),this.filters.date_from&&this.filters.date_from.trim()!==""&&(t.date_from=this.filters.date_from),this.filters.date_to&&this.filters.date_to.trim()!==""&&(t.date_to=this.filters.date_to),this.sessionService.getSessions(t).pipe(b(this._unsubscribeAll)).subscribe({next:r=>{this.sessions=r.data||[],this.totalItems=r.pagination?.total||0,this.loading=!1},error:r=>{this.error="Error al cargar sesiones",this.loading=!1,console.error("Error loading sessions:",r),this.snackBar.open("Error al cargar sesiones","Cerrar",{duration:3e3})}})}loadMetrics(){this.loadingMetrics=!0;let t={};this.filters.plate&&this.filters.plate.trim()!==""&&(t.plate=this.filters.plate.trim()),this.filters.sector_id!==void 0&&this.filters.sector_id!==null&&(t.sector_id=this.filters.sector_id),this.filters.operator_id!==void 0&&this.filters.operator_id!==null&&(t.operator_id=this.filters.operator_id),this.filters.date_from&&this.filters.date_from.trim()!==""&&(t.date_from=this.filters.date_from),this.filters.date_to&&this.filters.date_to.trim()!==""&&(t.date_to=this.filters.date_to);let r=P(k({},t),{page:1,per_page:1}),n=P(k({},t),{status:"ACTIVE",page:1,per_page:1}),m=P(k({},t),{status:"COMPLETED",page:1,per_page:1});if(this.filters.status&&this.filters.status.trim()!==""){let p=P(k({},t),{status:this.filters.status,page:1,per_page:1});this.sessionService.getSessions(p).pipe(b(this._unsubscribeAll)).subscribe({next:c=>{this.totalSessions=c.pagination?.total||0,this.filters.status==="ACTIVE"?(this.activeSessionsCount=c.pagination?.total||0,this.completedSessionsCount=0):this.filters.status==="COMPLETED"?(this.activeSessionsCount=0,this.completedSessionsCount=c.pagination?.total||0):(this.activeSessionsCount=0,this.completedSessionsCount=0),this.loadingMetrics=!1},error:c=>{console.error("Error loading metrics:",c),this.loadingMetrics=!1}})}else B({total:this.sessionService.getSessions(r),active:this.sessionService.getSessions(n),completed:this.sessionService.getSessions(m)}).pipe(b(this._unsubscribeAll)).subscribe({next:p=>{this.totalSessions=p.total?.pagination?.total||0,this.activeSessionsCount=p.active?.pagination?.total||0,this.completedSessionsCount=p.completed?.pagination?.total||0,this.loadingMetrics=!1},error:p=>{console.error("Error loading metrics:",p),this.loadingMetrics=!1}})}loadSectors(){this.sectorService.getSectors().pipe(b(this._unsubscribeAll)).subscribe({next:t=>{this.sectors=t.data?.data||[]},error:t=>{console.error("Error loading sectors:",t)}})}loadOperators(){this.operatorService.getOperators().pipe(b(this._unsubscribeAll)).subscribe({next:t=>{this.operators=t.data?.data||[]},error:t=>{console.error("Error loading operators:",t)}})}viewSession(t){this.router.navigate(["/parking/sessions",t.id])}editSession(t){t.status==="ACTIVE"?this.router.navigate(["/parking/sessions",t.id,"edit"]):this.snackBar.open("Solo se pueden editar sesiones activas","Cerrar",{duration:3e3})}cancelSession(t){if(t.status!=="ACTIVE"){this.snackBar.open("Solo se pueden cancelar sesiones activas","Cerrar",{duration:3e3});return}this.confirmationService.open({title:"Cancelar Sesi\xF3n",message:`\xBFEst\xE1 seguro de cancelar la sesi\xF3n de la placa ${t.plate}?`,icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Cancelar Sesi\xF3n",color:"warn"},cancel:{show:!0,label:"No"}}}).afterClosed().subscribe(n=>{n==="confirmed"&&this.sessionService.cancelSession(t.id).pipe(b(this._unsubscribeAll)).subscribe({next:m=>{this.snackBar.open("Sesi\xF3n cancelada exitosamente","Cerrar",{duration:3e3}),this.loadSessions()},error:m=>{this.snackBar.open("Error al cancelar sesi\xF3n","Cerrar",{duration:3e3}),console.error("Error canceling session:",m)}})})}checkoutSession(t){if(t.status!=="ACTIVE"){this.snackBar.open("Solo se puede hacer checkout de sesiones activas","Cerrar",{duration:3e3});return}this.router.navigate(["/parking/sessions",t.id,"checkout"])}paySession(t){if(t.status!=="TO_PAY"){this.snackBar.open("Solo se pueden pagar sesiones pendientes de pago","Cerrar",{duration:3e3});return}this.router.navigate(["/parking/sessions",t.id,"payment"])}formatAmount(t){return this.sessionService.formatAmount(t)}formatDate(t){return new Date(t).toLocaleString("es-CL")}formatDateTime(t){if(!t)return"N/A";let r=new Date(t);if(isNaN(r.getTime()))return"N/A";let n=r.toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"2-digit"}),m=r.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${n} ${m}`}formatDateTimeMobile(t){if(!t)return"-";let r=new Date(t);if(isNaN(r.getTime()))return"-";let n=String(r.getDate()).padStart(2,"0"),m=String(r.getMonth()+1).padStart(2,"0"),p=String(r.getHours()).padStart(2,"0"),c=String(r.getMinutes()).padStart(2,"0");return`${n}/${m} ${p}:${c}`}formatDuration(t){return this.sessionService.formatDuration(t)}getStatusLabel(t){return this.sessionService.getStatusLabel(t)}getStatusColor(t){return this.sessionService.getStatusColor(t)}getStatusCircleColor(t){return{CREATED:"#6B7280",ACTIVE:"#3B82F6",TO_PAY:"#F59E0B",PAID:"#10B981",CLOSED:"#10B981",CANCELED:"#EF4444"}[t]||"#6B7280"}getTotalSessionsCount(){return this.loadingMetrics?0:this.totalSessions}getActiveSessionsCount(){return this.loadingMetrics?0:this.activeSessionsCount}getCompletedSessionsCount(){return this.loadingMetrics?0:this.completedSessionsCount}canEdit(t){return t.status==="ACTIVE"}canCancel(t){return t.status==="ACTIVE"}canCheckout(t){return t.status==="ACTIVE"}canPay(t){return t.status==="TO_PAY"}createNewSession(){this.router.navigate(["/parking/sessions/new"])}exportSessions(){this.snackBar.open("Funcionalidad de exportaci\xF3n en desarrollo","Cerrar",{duration:3e3})}refreshSessions(){this.loadSessions(),this.loadMetrics()}onSearchChange(t){this.filters.plate=t||""}onSectorChange(t){t===""||t===null?this.filters.sector_id=void 0:this.filters.sector_id=typeof t=="number"?t:parseInt(t,10),this.applyFilters()}onOperatorChange(t){t===""||t===null?this.filters.operator_id=void 0:this.filters.operator_id=typeof t=="number"?t:parseInt(t,10),this.applyFilters()}onStatusChange(t){this.filters.status=t||"",this.applyFilters()}formatDateLocal(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),m=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${m}`}onDateFromChange(t){t?this.filters.date_from=this.formatDateLocal(t):this.filters.date_from="",this.applyFilters()}onDateToChange(t){t?this.filters.date_to=this.formatDateLocal(t):this.filters.date_to="",this.applyFilters()}onPageChange(t){this.currentPage=t.pageIndex,this.pageSize=t.pageSize,this.loadSessions()}applyFilters(){this.currentPage=0,this.loadSessions(),this.loadMetrics()}clearFilters(){this.filters={plate:"",sector_id:void 0,operator_id:void 0,status:"",date_from:"",date_to:""},this.dateFromModel=null,this.dateToModel=null,this.currentPage=0,this.loadSessions(),this.loadMetrics()}static{this.\u0275fac=function(r){return new(r||e)(v(Ot),v(Zt),v(te),v(Q),v(bt),v(st),v(U))}}static{this.\u0275cmp=L({type:e,selectors:[["app-sessions"]],viewQuery:function(r,n){if(r&1&&H(F,5),r&2){let m;z(m=W())&&(n.sort=m.first)}},features:[$([{provide:jt,useValue:Xt()}])],decls:101,vars:21,consts:[["pickerFrom",""],["pickerTo",""],["actionMenu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","mb-6"],[1,"p-6"],[1,"flex","items-center"],[1,"p-3","bg-blue-100","rounded-full"],[1,"text-blue-600"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"p-3","bg-green-100","rounded-full"],[1,"text-green-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"p-3","bg-purple-100","rounded-full"],[1,"text-purple-600"],[1,"text-2xl","font-bold","text-purple-600"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["appearance","outline"],["matInput","","placeholder","ABC123",3,"ngModelChange","ngModel"],["matPrefix",""],[3,"ngModelChange","selectionChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","DD/MM/YYYY",3,"ngModelChange","dateChange","matDatepicker","ngModel"],["matSuffix","",3,"for"],[1,"flex","justify-end","gap-2","mt-4"],["mat-stroked-button","",1,"rounded-sm",3,"click"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","mb-6",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","","class","mt-4",3,"length","pageSize","pageSizeOptions","pageIndex","page",4,"ngIf"],["class","text-center py-12",4,"ngIf"],[3,"value"],[1,"flex","justify-center","items-center","h-64"],["diameter","50"],["type","error",3,"dismissible"],[1,"p-0"],[1,"overflow-x-auto"],["mat-table","","matSort","",1,"w-full","mat-elevation-z2",2,"width","100%","table-layout","fixed",3,"matSortChange","dataSource","matSortActive","matSortDirection","matSortDisableClear"],["matColumnDef","plate"],["mat-header-cell","","mat-sort-header","plate",3,"width",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sector"],["mat-header-cell","","mat-sort-header","sector_id","style","width: 12%;",4,"matHeaderCellDef"],["matColumnDef","street"],["mat-header-cell","","mat-sort-header","street_id","style","width: 12%;",4,"matHeaderCellDef"],["matColumnDef","operator"],["mat-header-cell","","mat-sort-header","operator_in_id","style","width: 15%;",4,"matHeaderCellDef"],["matColumnDef","started_at"],["mat-header-cell","","mat-sort-header","started_at",3,"width",4,"matHeaderCellDef"],["matColumnDef","ended_at"],["mat-header-cell","","mat-sort-header","ended_at",3,"width",4,"matHeaderCellDef"],["matColumnDef","duration"],["mat-header-cell","","mat-sort-header","seconds_total",3,"width",4,"matHeaderCellDef"],["matColumnDef","amount"],["mat-header-cell","","mat-sort-header","net_amount",3,"width",4,"matHeaderCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","status","style","width: 10%;",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","text-right",3,"width",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","plate"],["mat-cell",""],[1,"flex","items-center","gap-2"],["class","status-circle flex-shrink-0",3,"background-color","matTooltip",4,"ngIf"],[1,"font-medium","text-gray-900"],[1,"status-circle","flex-shrink-0",3,"matTooltip"],["mat-header-cell","","mat-sort-header","sector_id",2,"width","12%"],[1,"text-sm","text-gray-600"],["mat-header-cell","","mat-sort-header","street_id",2,"width","12%"],["mat-header-cell","","mat-sort-header","operator_in_id",2,"width","15%"],["mat-header-cell","","mat-sort-header","started_at"],["mat-header-cell","","mat-sort-header","ended_at"],["mat-header-cell","","mat-sort-header","seconds_total"],["mat-header-cell","","mat-sort-header","net_amount"],[1,"text-sm","font-medium","text-gray-900"],["mat-header-cell","","mat-sort-header","status",2,"width","10%"],[1,"px-2","py-1","rounded","text-xs","font-medium"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","","class","text-red-600",3,"click",4,"ngIf"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""],["showFirstLastButtons","",1,"mt-4",3,"page","length","pageSize","pageSizeOptions","pageIndex"],[1,"text-center","py-12"],[1,"text-6xl","text-gray-400","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"]],template:function(r,n){if(r&1){let m=M();o(0,"div",3)(1,"div",4)(2,"div")(3,"h1",5),a(4,"Sesiones"),i(),o(5,"p",6),a(6,"Gestiona las sesiones de estacionamiento del sistema"),i()(),o(7,"button",7),g("click",function(){return u(m),f(n.createNewSession())}),o(8,"mat-icon"),a(9,"add"),i(),a(10," Nueva Sesi\xF3n "),i()(),o(11,"div",8)(12,"mat-card")(13,"mat-card-content",9)(14,"div",10)(15,"div",11)(16,"mat-icon",12),a(17,"directions_car"),i()(),o(18,"div",13)(19,"p",14),a(20,"Total de Sesiones"),i(),o(21,"p",15),a(22),i()()()()(),o(23,"mat-card")(24,"mat-card-content",9)(25,"div",10)(26,"div",16)(27,"mat-icon",17),a(28,"play_circle"),i()(),o(29,"div",13)(30,"p",14),a(31,"Sesiones Activas"),i(),o(32,"p",18),a(33),i()()()()(),o(34,"mat-card")(35,"mat-card-content",9)(36,"div",10)(37,"div",19)(38,"mat-icon",20),a(39,"check_circle"),i()(),o(40,"div",13)(41,"p",14),a(42,"Sesiones Completadas"),i(),o(43,"p",21),a(44),i()()()()()(),o(45,"mat-card",22)(46,"mat-card-content",9)(47,"div",23)(48,"mat-form-field",24)(49,"mat-label"),a(50,"Buscar por Placa"),i(),o(51,"input",25),D("ngModelChange",function(c){return u(m),T(n.filters.plate,c)||(n.filters.plate=c),f(c)}),i(),o(52,"mat-icon",26),a(53,"search"),i()(),o(54,"mat-form-field",24)(55,"mat-label"),a(56,"Sector"),i(),o(57,"mat-select",27),D("ngModelChange",function(c){return u(m),T(n.filters.sector_id,c)||(n.filters.sector_id=c),f(c)}),g("selectionChange",function(c){return u(m),f(n.onSectorChange(c.value))}),o(58,"mat-option",28),a(59,"Todos los sectores"),i(),h(60,ie,2,2,"mat-option",29),i()(),o(61,"mat-form-field",24)(62,"mat-label"),a(63,"Operador"),i(),o(64,"mat-select",27),D("ngModelChange",function(c){return u(m),T(n.filters.operator_id,c)||(n.filters.operator_id=c),f(c)}),g("selectionChange",function(c){return u(m),f(n.onOperatorChange(c.value))}),o(65,"mat-option",28),a(66,"Todos los operadores"),i(),h(67,ne,2,2,"mat-option",29),i()(),o(68,"mat-form-field",24)(69,"mat-label"),a(70,"Estado"),i(),o(71,"mat-select",27),D("ngModelChange",function(c){return u(m),T(n.filters.status,c)||(n.filters.status=c),f(c)}),g("selectionChange",function(c){return u(m),f(n.onStatusChange(c.value))}),h(72,oe,2,2,"mat-option",29),i()(),o(73,"mat-form-field",24)(74,"mat-label"),a(75,"Fecha Desde"),i(),o(76,"input",30),D("ngModelChange",function(c){return u(m),T(n.dateFromModel,c)||(n.dateFromModel=c),f(c)}),g("dateChange",function(c){return u(m),f(n.onDateFromChange(c.value))}),i(),w(77,"mat-datepicker-toggle",31)(78,"mat-datepicker",null,0),i(),o(80,"mat-form-field",24)(81,"mat-label"),a(82,"Fecha Hasta"),i(),o(83,"input",30),D("ngModelChange",function(c){return u(m),T(n.dateToModel,c)||(n.dateToModel=c),f(c)}),g("dateChange",function(c){return u(m),f(n.onDateToChange(c.value))}),i(),w(84,"mat-datepicker-toggle",31)(85,"mat-datepicker",null,1),i()(),o(87,"div",32)(88,"button",33),g("click",function(){return u(m),f(n.clearFilters())}),o(89,"mat-icon"),a(90,"clear"),i(),a(91," Limpiar "),i(),o(92,"button",7),g("click",function(){return u(m),f(n.applyFilters())}),o(93,"mat-icon"),a(94,"search"),i(),a(95," Filtrar "),i()()()(),h(96,ae,2,0,"div",34)(97,re,3,2,"div",35)(98,Fe,36,6,"mat-card",36)(99,Ae,1,4,"mat-paginator",37)(100,Be,11,0,"div",38),i()}if(r&2){let m=V(79),p=V(86);s(22),S(" ",n.loadingMetrics?"...":n.getTotalSessionsCount()," "),s(11),S(" ",n.loadingMetrics?"...":n.getActiveSessionsCount()," "),s(11),S(" ",n.loadingMetrics?"...":n.getCompletedSessionsCount()," "),s(7),E("ngModel",n.filters.plate),s(6),E("ngModel",n.filters.sector_id),s(3),_("ngForOf",n.sectors),s(4),E("ngModel",n.filters.operator_id),s(3),_("ngForOf",n.operators),s(4),E("ngModel",n.filters.status),s(),_("ngForOf",n.statusOptions),s(4),_("matDatepicker",m),E("ngModel",n.dateFromModel),s(),_("for",m),s(6),_("matDatepicker",p),E("ngModel",n.dateToModel),s(),_("for",p),s(12),_("ngIf",n.loading),s(),_("ngIf",n.error),s(),_("ngIf",!n.loading),s(),_("ngIf",!n.loading&&n.sessions.length>0),s(),_("ngIf",!n.loading&&n.sessions.length===0)}},dependencies:[Y,j,R,gt,ut,ft,ht,$t,It,Ft,Nt,At,Vt,Ht,Bt,Lt,zt,Wt,Yt,Rt,Ut,F,Qt,ot,it,nt,rt,at,et,tt,K,X,Z,Ct,St,Pt,kt,J,Dt,wt,Et,Tt,G,qt,mt,lt,_t,dt,ct,pt,vt,Mt,xt,yt,Kt,Gt,Jt],styles:[".mat-chip[_ngcontent-%COMP%]{font-size:12px;font-weight:500}.mat-chip.mat-chip-green[_ngcontent-%COMP%]{background-color:#10b981;color:#fff}.mat-chip.mat-chip-blue[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.mat-chip.mat-chip-orange[_ngcontent-%COMP%]{background-color:#f59e0b;color:#fff}.mat-chip.mat-chip-red[_ngcontent-%COMP%]{background-color:#ef4444;color:#fff}.mat-chip.mat-chip-gray[_ngcontent-%COMP%]{background-color:#6b7280;color:#fff}.table-container[_ngcontent-%COMP%]{overflow-x:auto}@media (max-width: 768px){.mat-table[_ngcontent-%COMP%]{font-size:14px}.mat-header-cell[_ngcontent-%COMP%]{font-size:11px!important;font-weight:500}.mat-column-actions[_ngcontent-%COMP%]{width:60px}.mat-column-street[_ngcontent-%COMP%], .mat-column-operator[_ngcontent-%COMP%], .mat-column-sector[_ngcontent-%COMP%]{display:none}.status-circle[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:2px;display:inline-block;cursor:pointer;transition:transform .2s}.status-circle[_ngcontent-%COMP%]:hover{transform:scale(1.2)}}.filters-section[_ngcontent-%COMP%]{background:#f8fafc;border-radius:8px;padding:1.5rem;margin-bottom:1.5rem}.action-button[_ngcontent-%COMP%]{margin-right:8px}.action-button[_ngcontent-%COMP%]:last-child{margin-right:0}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;height:4rem;width:4rem;color:#9ca3af;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#111827;font-size:1.125rem;font-weight:500;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:16rem}.error-container[_ngcontent-%COMP%]{margin-bottom:1.5rem}"]})}}return e})();export{ki as SessionsComponent};
