import{a as Tt}from"./chunk-VWULJZWU.js";import{a as wt}from"./chunk-6KBHBSH5.js";import{c as Et}from"./chunk-ZMAIZYCZ.js";import{a as vt,b as bt,c as xt,d as Te,e as Mt,f as St,g as Wt}from"./chunk-JDQ2XOLK.js";import{a as _e,b as ge,c as Ce,d as ye,e as ve,f as be,g as xe,h as Me,i as Se,j as Ee,k as We}from"./chunk-A3W56N53.js";import{a as gt,c as Ct,f as yt}from"./chunk-CFZHHQ3I.js";import"./chunk-2LVKS4R7.js";import{a as H,b as fe}from"./chunk-FGUURFJS.js";import{a as mt,b as dt,c as pt,d as ct}from"./chunk-UQSNXR2K.js";import{b as lt}from"./chunk-3FSFXLFF.js";import{a as oe,b as se}from"./chunk-3FSLCT73.js";import"./chunk-AGGAQN5G.js";import{g as ue}from"./chunk-4Y4LGJ4R.js";import{a as Y,b as pe,c as nt,h as w}from"./chunk-ZMKJJYLL.js";import"./chunk-EOYQYJ3N.js";import{a as st}from"./chunk-ACMTDFES.js";import"./chunk-FWGAGG6F.js";import{a as ot}from"./chunk-VKB6BRO6.js";import{b as N,c as R}from"./chunk-72F6PA3H.js";import{d as O,e as j}from"./chunk-F2IYN6IZ.js";import{b as I,c as Z,e as ce,j as F,k as D}from"./chunk-EO526QJS.js";import{a as L,b as $}from"./chunk-6JXRNXI3.js";import{A as _t,B as ne,b as B,d as y,f as V,g as ee,j as ut,k as te,l as he,n as ae,q as ie,v as ht,x as ft,y as re}from"./chunk-XMMUWBM2.js";import{fa as X,la as P,na as k,oa as A}from"./chunk-56JILNRZ.js";import"./chunk-TTG7A5I5.js";import"./chunk-P2DCSIJY.js";import{a as it,d as rt}from"./chunk-FDUGCV2L.js";import{l as de,m as W,s as at,t as T}from"./chunk-IZAOXH6X.js";import{$b as u,Eb as p,Fc as et,Gb as Ue,Hc as tt,Pb as i,Qb as r,Rb as _,Sb as b,Tb as x,U as v,Vb as me,_ as ze,bb as l,bc as f,cb as h,da as qe,f as K,fc as Qe,gc as Je,hc as Ke,lc as Xe,mc as o,nc as C,oa as z,oc as M,pa as q,pb as E,pc as Ye,rc as Fe,sc as De,tc as Pe,uc as Ze,v as Ge,wb as c}from"./chunk-QDWFRTQW.js";import{a as Q,b as J}from"./chunk-TSRGIXR5.js";var G=(()=>{class t{constructor(e){this.http=e,this.baseUrl=ot.apiUrl}getCarWashTypes(){return this.http.get(`${this.baseUrl}/car-wash-types`)}createCarWashType(e){return this.http.post(`${this.baseUrl}/car-wash-types`,e)}updateCarWashType(e,n){return this.http.put(`${this.baseUrl}/car-wash-types/${e}`,n)}deleteCarWashType(e){return this.http.delete(`${this.baseUrl}/car-wash-types/${e}`)}getCarWashes(e={}){let n=new it;return Object.entries(e).forEach(([a,s])=>{s==null||s===""||(n=n.set(a,String(s)))}),this.http.get(`${this.baseUrl}/car-washes`,{params:n})}createCarWash(e){return this.http.post(`${this.baseUrl}/car-washes`,e)}updateCarWash(e,n){return this.http.put(`${this.baseUrl}/car-washes/${e}`,n)}static{this.\u0275fac=function(n){return new(n||t)(qe(rt))}}static{this.\u0275prov=ze({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Rt(t,m){t&1&&(i(0,"mat-error"),o(1,"Nombre es obligatorio"),r())}function Bt(t,m){t&1&&(i(0,"mat-error"),o(1,"Precio es obligatorio"),r())}function Vt(t,m){t&1&&(i(0,"mat-icon"),o(1,"save"),r())}function Ot(t,m){t&1&&_(0,"mat-spinner",24)}function jt(t,m){t&1&&(i(0,"div",25),_(1,"mat-spinner",26),i(2,"p",27),o(3,"Cargando tipos..."),r()())}function Lt(t,m){t&1&&(i(0,"th",42),o(1,"Nombre"),r())}function $t(t,m){if(t&1&&(i(0,"td",43),o(1),r()),t&2){let e=m.$implicit;l(),C(e.name)}}function Ht(t,m){t&1&&(i(0,"th",42),o(1,"Precio"),r())}function Gt(t,m){if(t&1&&(i(0,"td",44),o(1),r()),t&2){let e=m.$implicit,n=f(2);l(),C(n.formatAmount(e.price))}}function zt(t,m){t&1&&(i(0,"th",42),o(1,"Duraci\xF3n"),r())}function qt(t,m){if(t&1&&(i(0,"td",44),o(1),r()),t&2){let e=m.$implicit;l(),C(e.duration_minutes?e.duration_minutes+" min":"\u2014")}}function Ut(t,m){t&1&&(i(0,"th",45),o(1,"Acciones"),r())}function Qt(t,m){if(t&1){let e=me();i(0,"td",46)(1,"button",47),u("click",function(){let a=z(e).$implicit,s=f(2);return q(s.startEdit(a))}),i(2,"mat-icon"),o(3,"edit"),r()(),i(4,"button",48),u("click",function(){let a=z(e).$implicit,s=f(2);return q(s.delete(a))}),i(5,"mat-icon"),o(6,"delete"),r()()()}}function Jt(t,m){t&1&&_(0,"tr",49)}function Kt(t,m){t&1&&_(0,"tr",50)}function Xt(t,m){t&1&&(i(0,"div",51),o(1," No hay tipos creados todav\xEDa. "),r())}function Yt(t,m){if(t&1&&(i(0,"div",28)(1,"table",29),b(2,30),c(3,Lt,2,0,"th",31)(4,$t,2,1,"td",32),x(),b(5,33),c(6,Ht,2,0,"th",31)(7,Gt,2,1,"td",34),x(),b(8,35),c(9,zt,2,0,"th",31)(10,qt,2,1,"td",34),x(),b(11,36),c(12,Ut,2,0,"th",37)(13,Qt,7,0,"td",38),x(),c(14,Jt,1,0,"tr",39)(15,Kt,1,0,"tr",40),r(),c(16,Xt,2,0,"div",41),r()),t&2){let e=f();l(),p("dataSource",e.washTypes),l(13),p("matHeaderRowDef",e.displayedColumns),l(),p("matRowDefColumns",e.displayedColumns),l(),p("ngIf",e.washTypes.length===0)}}var It=(()=>{class t{constructor(e,n,a,s,d){this.dialogRef=e,this.fb=n,this.carWashService=a,this.snackBar=s,this.confirmationService=d,this._unsubscribeAll=new K,this.loading=!1,this.saving=!1,this.washTypes=[],this.displayedColumns=["name","price","duration","actions"],this.editingType=null,this.typeForm=this.fb.group({name:["",[y.required,y.minLength(2)]],price:[null,[y.required,y.min(0)]],duration_minutes:[null]})}ngOnInit(){this.loadTypes()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadTypes(){this.loading=!0,this.carWashService.getCarWashTypes().pipe(v(this._unsubscribeAll)).subscribe({next:e=>{this.washTypes=e.data||[],this.loading=!1},error:e=>{console.error("Error loading types:",e),this.snackBar.open("Error al cargar tipos de lavado","Cerrar",{duration:3e3}),this.loading=!1}})}startCreate(){this.editingType=null,this.typeForm.reset({name:"",price:null,duration_minutes:null})}startEdit(e){this.editingType=e,this.typeForm.reset({name:e.name,price:e.price,duration_minutes:e.duration_minutes??null})}save(){if(this.typeForm.invalid){this.typeForm.markAllAsTouched();return}let e={name:String(this.typeForm.value.name).trim(),price:Number(this.typeForm.value.price),duration_minutes:this.typeForm.value.duration_minutes===null||this.typeForm.value.duration_minutes===""?null:Number(this.typeForm.value.duration_minutes)};this.saving=!0,(this.editingType?.id?this.carWashService.updateCarWashType(this.editingType.id,e):this.carWashService.createCarWashType(e)).pipe(v(this._unsubscribeAll)).subscribe({next:a=>{a.success?(this.snackBar.open(this.editingType?"Tipo actualizado":"Tipo creado","Cerrar",{duration:2500}),this.editingType=null,this.typeForm.reset({name:"",price:null,duration_minutes:null}),this.loadTypes()):this.snackBar.open(a.message||"Error al guardar tipo","Cerrar",{duration:3e3}),this.saving=!1},error:a=>{console.error("Error saving type:",a);let s=a?.error?.message||"Error al guardar tipo de lavado";this.snackBar.open(s,"Cerrar",{duration:4e3}),this.saving=!1}})}delete(e){if(!e.id)return;this.confirmationService.open({title:"Eliminar Tipo de Lavado",message:`\xBFEst\xE1 seguro de eliminar el tipo "${e.name}"?`,icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Eliminar",color:"warn"},cancel:{show:!0,label:"Cancelar"}}}).afterClosed().subscribe(a=>{a==="confirmed"&&this.carWashService.deleteCarWashType(e.id).pipe(v(this._unsubscribeAll)).subscribe({next:s=>{s.success?(this.snackBar.open("Tipo eliminado","Cerrar",{duration:2500}),this.loadTypes()):this.snackBar.open(s.message||"Error al eliminar tipo","Cerrar",{duration:3e3})},error:s=>{console.error("Error deleting type:",s);let d=s?.error?.message||"Error al eliminar tipo";this.snackBar.open(d,"Cerrar",{duration:4e3})}})})}close(){this.dialogRef.close(!0)}formatAmount(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e||0)}static{this.\u0275fac=function(n){return new(n||t)(h(Y),h(re),h(G),h(H),h(ue))}}static{this.\u0275cmp=E({type:t,selectors:[["app-car-wash-types-modal"]],decls:49,vars:9,consts:[[1,"p-6"],[1,"flex","items-start","justify-between","mb-4"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-icon-button","","aria-label","Cerrar",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"bg-white","rounded","border","border-gray-200","p-4"],[1,"flex","items-center","justify-between","mb-3"],[1,"font-semibold","text-gray-900"],["mat-stroked-button","",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","gap-4",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Ej: Lavado completo"],[4,"ngIf"],["matInput","","type","number","formControlName","price","placeholder","Ej: 5000"],["matInput","","type","number","formControlName","duration_minutes","placeholder","Ej: 30"],[1,"flex","gap-2","justify-end"],["mat-stroked-button","","type","button",1,"rounded-sm",3,"click"],["mat-raised-button","","color","primary","type","button",1,"rounded-sm",3,"click","disabled"],["diameter","18",4,"ngIf"],[1,"font-semibold","text-gray-900","mb-3"],["class","text-center py-8",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],[1,"flex","justify-end","mt-6"],["diameter","18"],[1,"text-center","py-8"],["diameter","40",1,"mx-auto"],[1,"mt-3","text-gray-600"],[1,"overflow-x-auto"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","font-medium",4,"matCellDef"],["matColumnDef","price"],["mat-cell","",4,"matCellDef"],["matColumnDef","duration"],["matColumnDef","actions"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","py-6 text-center text-gray-600",4,"ngIf"],["mat-header-cell",""],["mat-cell","",1,"font-medium"],["mat-cell",""],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-icon-button","","aria-label","Editar",3,"click"],["mat-icon-button","","color","warn","aria-label","Eliminar",3,"click"],["mat-header-row",""],["mat-row",""],[1,"py-6","text-center","text-gray-600"]],template:function(n,a){if(n&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),o(4,"Tipos de Lavado"),r(),i(5,"p",3),o(6,"Administra nombre, precio y duraci\xF3n de los lavados"),r()(),i(7,"button",4),u("click",function(){return a.close()}),i(8,"mat-icon"),o(9,"close"),r()()(),i(10,"div",5)(11,"div",6)(12,"div",7)(13,"h3",8),o(14),r(),i(15,"button",9),u("click",function(){return a.startCreate()}),i(16,"mat-icon"),o(17,"add"),r(),o(18," Nuevo "),r()(),i(19,"form",10)(20,"mat-form-field",11)(21,"mat-label"),o(22,"Nombre lavado"),r(),_(23,"input",12),c(24,Rt,2,0,"mat-error",13),r(),i(25,"mat-form-field",11)(26,"mat-label"),o(27,"Precio lavado (CLP)"),r(),_(28,"input",14),c(29,Bt,2,0,"mat-error",13),r(),i(30,"mat-form-field",11)(31,"mat-label"),o(32,"Duraci\xF3n (min)"),r(),_(33,"input",15),r(),i(34,"div",16)(35,"button",17),u("click",function(){return a.startCreate()}),o(36," Cancelar "),r(),i(37,"button",18),u("click",function(){return a.save()}),c(38,Vt,2,0,"mat-icon",13)(39,Ot,1,0,"mat-spinner",19),o(40," Guardar "),r()()()(),i(41,"div",6)(42,"h3",20),o(43,"Listado"),r(),c(44,jt,4,0,"div",21)(45,Yt,17,4,"div",22),r()(),i(46,"div",23)(47,"button",9),u("click",function(){return a.close()}),o(48,"Cerrar"),r()()()),n&2){let s,d;l(14),C(a.editingType?"Editar tipo":"Nuevo tipo"),l(5),p("formGroup",a.typeForm),l(5),p("ngIf",(s=a.typeForm.get("name"))==null?null:s.hasError("required")),l(5),p("ngIf",(d=a.typeForm.get("price"))==null?null:d.hasError("required")),l(8),p("disabled",a.saving),l(),p("ngIf",!a.saving),l(),p("ngIf",a.saving),l(5),p("ngIf",a.loading),l(),p("ngIf",!a.loading)}},dependencies:[T,W,ne,te,B,he,V,ee,ae,ie,w,D,F,I,Z,j,O,A,P,k,R,N,We,_e,Ce,xe,ye,ge,Me,ve,be,Se,Ee,$,L],styles:["[_nghost-%COMP%]{display:block}table[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600}"]})}}return t})();function Zt(t,m){t&1&&(i(0,"mat-error"),o(1,"Placa es obligatoria"),r())}function ea(t,m){if(t&1&&(i(0,"mat-form-field",7)(1,"mat-label"),o(2,"Placa"),r(),_(3,"input",15),c(4,Zt,2,0,"mat-error",13),r()),t&2){let e,n=f();l(4),p("ngIf",(e=n.form.get("plate"))==null?null:e.hasError("required"))}}function ta(t,m){if(t&1&&(i(0,"mat-option",17),o(1),et(2,"number"),r()),t&2){let e=m.$implicit;p("value",e.id),l(),Ye(" ",e.name," \u2014 ",tt(2,3,e.price,"1.0-0")," CLP ")}}function aa(t,m){t&1&&(i(0,"mat-error"),o(1,"Tipo es obligatorio"),r())}function ia(t,m){if(t&1&&(i(0,"mat-form-field",7)(1,"mat-label"),o(2,"Tipo de lavado"),r(),i(3,"mat-select",16),c(4,ta,3,6,"mat-option",9),r(),c(5,aa,2,0,"mat-error",13),r()),t&2){let e,n=f();l(4),p("ngForOf",n.washTypes),l(),p("ngIf",(e=n.form.get("car_wash_type_id"))==null?null:e.hasError("required"))}}function ra(t,m){if(t&1&&(i(0,"mat-option",17),o(1),r()),t&2){let e=m.$implicit;p("value",e.value),l(),M(" ",e.label," ")}}function na(t,m){t&1&&(i(0,"mat-icon"),o(1,"save"),r())}function oa(t,m){t&1&&_(0,"mat-spinner",18)}var $e=(()=>{class t{constructor(e,n,a,s,d){this.dialogRef=e,this.data=n,this.fb=a,this.carWashService=s,this.snackBar=d,this.saving=!1,this.statusOptions=[{value:"PENDING",label:"Pendiente"},{value:"PAID",label:"Pagado"}],this.washTypes=[],this.isEdit=n?.isEdit||!1,this.washTypes=(n?.washTypes||[]).filter(g=>g.is_active!==!1),this.isEdit?(this.form=this.fb.group({plate:[""],car_wash_type_id:[null],status:["PENDING",[y.required]]}),n?.carWash&&this.loadCarWashData(n.carWash)):this.form=this.fb.group({plate:["",[y.required,y.minLength(4),y.maxLength(10)]],car_wash_type_id:[null,[y.required]],status:["PENDING",[y.required]]})}loadCarWashData(e){this.form.patchValue({plate:e.plate,car_wash_type_id:e.car_wash_type_id,status:e.status})}save(){if(this.form.invalid){this.form.markAllAsTouched();return}let e={status:this.form.value.status};this.isEdit||(e.plate=String(this.form.value.plate).trim().toUpperCase(),e.car_wash_type_id=Number(this.form.value.car_wash_type_id)),this.saving=!0,this.isEdit&&this.data?.carWash?.id?this.carWashService.updateCarWash(this.data.carWash.id,e).subscribe({next:n=>{n.success?(this.snackBar.open("Lavado actualizado","Cerrar",{duration:2500}),this.dialogRef.close(!0)):this.snackBar.open(n.message||"Error al actualizar lavado","Cerrar",{duration:3e3}),this.saving=!1},error:n=>{console.error("Error updating car wash:",n);let a=n?.error?.message||"Error al actualizar lavado";this.snackBar.open(a,"Cerrar",{duration:4e3}),this.saving=!1}}):this.carWashService.createCarWash(e).subscribe({next:n=>{n.success?(this.snackBar.open("Lavado creado","Cerrar",{duration:2500}),this.dialogRef.close(!0)):this.snackBar.open(n.message||"Error al crear lavado","Cerrar",{duration:3e3}),this.saving=!1},error:n=>{console.error("Error creating car wash:",n);let a=n?.error?.message||"Error al crear lavado";this.snackBar.open(a,"Cerrar",{duration:4e3}),this.saving=!1}})}cancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(n){return new(n||t)(h(Y),h(pe),h(re),h(G),h(H))}}static{this.\u0275cmp=E({type:t,selectors:[["app-car-wash-form-modal"]],decls:25,vars:9,consts:[[1,"p-6"],[1,"flex","items-start","justify-between","mb-4"],[1,"text-xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-icon-button","","aria-label","Cerrar",3,"click"],[1,"grid","grid-cols-1","gap-4",3,"formGroup"],["appearance","outline",4,"ngIf"],["appearance","outline"],["formControlName","status"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","gap-2","justify-end","mt-2"],["mat-stroked-button","","type","button",1,"rounded-sm",3,"click"],["mat-raised-button","","color","primary","type","button",1,"rounded-sm",3,"click","disabled"],[4,"ngIf"],["diameter","18",4,"ngIf"],["matInput","","formControlName","plate","placeholder","ABC123"],["formControlName","car_wash_type_id"],[3,"value"],["diameter","18"]],template:function(n,a){n&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),o(4),r(),i(5,"p",3),o(6),r()(),i(7,"button",4),u("click",function(){return a.cancel()}),i(8,"mat-icon"),o(9,"close"),r()()(),i(10,"form",5),c(11,ea,5,1,"mat-form-field",6)(12,ia,6,2,"mat-form-field",6),i(13,"mat-form-field",7)(14,"mat-label"),o(15,"Estado"),r(),i(16,"mat-select",8),c(17,ra,2,2,"mat-option",9),r()(),i(18,"div",10)(19,"button",11),u("click",function(){return a.cancel()}),o(20," Cancelar "),r(),i(21,"button",12),u("click",function(){return a.save()}),c(22,na,2,0,"mat-icon",13)(23,oa,1,0,"mat-spinner",14),o(24," Guardar "),r()()()()),n&2&&(l(4),C(a.isEdit?"Editar Lavado":"Nuevo Lavado"),l(2),C(a.isEdit?"Modifica los datos del lavado":"Asigna un lavado a un veh\xEDculo y define su estado"),l(4),p("formGroup",a.form),l(),p("ngIf",!a.isEdit),l(),p("ngIf",!a.isEdit),l(5),p("ngForOf",a.statusOptions),l(4),p("disabled",a.saving),l(),p("ngIf",!a.saving),l(),p("ngIf",a.saving))},dependencies:[T,de,W,at,ne,te,B,V,ee,ae,ie,w,D,F,I,Z,j,O,A,P,k,R,N,se,oe,X,$,L],styles:["[_nghost-%COMP%]{display:block}"]})}}return t})();function sa(t,m){t&1&&(i(0,"mat-error"),o(1," El m\xE9todo de pago es requerido "),r())}function la(t,m){t&1&&(i(0,"mat-error"),o(1," El monto es requerido "),r())}function ma(t,m){t&1&&(i(0,"mat-error"),o(1," El monto debe ser mayor a 0 "),r())}function da(t,m){t&1&&(i(0,"mat-form-field",12)(1,"mat-label"),o(2,"C\xF3digo de Autorizaci\xF3n (opcional)"),r(),_(3,"input",26),i(4,"mat-icon",19),o(5,"credit_card"),r()())}function pa(t,m){if(t&1&&(i(0,"div",27)(1,"div",28)(2,"div",29)(3,"mat-icon",30),o(4,"monetization_on"),r(),i(5,"span",31),o(6,"Vuelto a entregar:"),r()(),i(7,"span",32),o(8),r()()()),t&2){let e=f();l(8),C(e.formatAmount(e.calculateChange()))}}function ca(t,m){t&1&&_(0,"mat-spinner",33)}function ua(t,m){t&1&&(i(0,"mat-icon"),o(1,"payment"),r())}var Pt=(()=>{class t{constructor(e,n,a,s,d,g,S){this.dialogRef=e,this.data=n,this.fb=a,this.carWashService=s,this.shiftService=d,this.authService=g,this.snackBar=S,this._unsubscribeAll=new K,this.processing=!1,this.carWash=n.carWash,this.paymentForm=this.createForm()}ngOnInit(){this.onPaymentMethodChange()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createForm(){return this.fb.group({payment_method:["CASH",y.required],amount:["",[y.required,y.min(.01)]],approval_code:[""]})}onPaymentMethodChange(){let e=this.paymentForm.get("payment_method")?.value,n=this.carWash.amount||0;e==="CASH"?(this.paymentForm.patchValue({amount:""}),this.paymentForm.get("amount")?.enable(),this.paymentForm.get("approval_code")?.clearValidators(),this.paymentForm.get("approval_code")?.updateValueAndValidity()):e==="TRANSFER"?(this.paymentForm.patchValue({amount:n}),this.paymentForm.get("amount")?.disable(),this.paymentForm.get("approval_code")?.clearValidators(),this.paymentForm.get("approval_code")?.updateValueAndValidity()):e==="CARD"&&(this.paymentForm.patchValue({amount:n}),this.paymentForm.get("amount")?.disable(),this.paymentForm.get("approval_code")?.clearValidators(),this.paymentForm.get("approval_code")?.updateValueAndValidity())}isAmountFieldDisabled(){return this.paymentForm.get("payment_method")?.value!=="CASH"}shouldShowChange(){if(this.paymentForm.get("payment_method")?.value!=="CASH")return!1;let n=this.paymentForm.get("amount")?.value,a=this.parseAmount(n),s=this.carWash.amount||0;return a>s}calculateChange(){let e=this.paymentForm.get("amount")?.value,n=this.parseAmount(e),a=this.carWash.amount||0;return n-a}parseAmount(e){return e===""||e===null||e===void 0?0:typeof e=="string"?parseFloat(e)||0:Number(e)||0}formatAmount(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e||0)}onSubmit(){if(this.paymentForm.invalid){this.paymentForm.markAllAsTouched();return}this.processing=!0;let e=this.paymentForm.value,n=e.payment_method,a=e.amount,s=n==="CASH"?this.parseAmount(a):this.carWash.amount||0,d=this.authService.getCurrentUser();if(!d||!d.id){this.snackBar.open("No se pudo obtener el operador actual","Cerrar",{duration:3e3}),this.processing=!1;return}let g=d.id;this.shiftService.getCurrentShift(g).pipe(v(this._unsubscribeAll)).subscribe({next:S=>{let le=S.data?.shift?.id||null,He={status:"PAID",cashier_operator_id:g,approval_code:n==="CARD"&&e.approval_code||null};le&&(He.shift_id=le),this.carWashService.updateCarWash(this.carWash.id,He).pipe(v(this._unsubscribeAll)).subscribe({next:U=>{this.processing=!1,U.success?(this.snackBar.open("Pago procesado exitosamente","Cerrar",{duration:3e3}),this.dialogRef.close({success:!0,data:U.data})):this.snackBar.open(U.message||"Error al procesar el pago","Cerrar",{duration:3e3})},error:U=>{this.processing=!1,console.error("Error processing payment:",U);let kt=U.error?.message||"Error al procesar el pago";this.snackBar.open(kt,"Cerrar",{duration:3e3})}})},error:S=>{this.processing=!1,console.error("Error getting current shift:",S),this.snackBar.open("Error al obtener el turno actual","Cerrar",{duration:3e3})}})}onClose(){this.dialogRef.close({success:!1})}static{this.\u0275fac=function(n){return new(n||t)(h(Y),h(pe),h(re),h(G),h(wt),h(st),h(H))}}static{this.\u0275cmp=E({type:t,selectors:[["app-car-wash-payment-modal"]],decls:50,vars:13,consts:[[1,"car-wash-payment-modal"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","bg-gray-50","rounded-t-lg"],[1,"flex","items-center","gap-3"],[1,"text-blue-600"],[1,"text-xl","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],["mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"p-6"],[1,"bg-primary-50","border","border-primary-200","rounded-lg","p-6","mb-6","text-center"],[1,"text-lg","font-semibold","text-primary-700","mb-2"],[1,"text-4xl","font-bold","text-primary-900"],[1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["formControlName","payment_method",3,"selectionChange"],["value","CASH"],["value","CARD"],["value","TRANSFER"],[4,"ngIf"],["matInput","","type","number","formControlName","amount","placeholder","0","step","1","min","0",3,"readonly"],["matPrefix",""],["appearance","outline","class","w-full",4,"ngIf"],["class","bg-green-50 border border-green-200 rounded-lg p-4",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","gap-3","justify-end","pt-4"],["type","button","mat-stroked-button","",1,"rounded-sm",3,"click"],["type","submit","mat-raised-button","","color","primary",1,"rounded-sm",3,"disabled"],["diameter","20","class","mr-2",4,"ngIf"],["matInput","","formControlName","approval_code","placeholder","Ingrese el c\xF3digo de autorizaci\xF3n","maxlength","50"],[1,"bg-green-50","border","border-green-200","rounded-lg","p-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-2"],[1,"text-green-600"],[1,"text-green-800","font-semibold"],[1,"text-xl","font-bold","text-green-700"],["diameter","20",1,"mr-2"]],template:function(n,a){if(n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),o(4,"payment"),r(),i(5,"div")(6,"h2",4),o(7," Pagar Lavado "),r(),i(8,"p",5),o(9),r()()(),i(10,"button",6),u("click",function(){return a.onClose()}),i(11,"mat-icon"),o(12,"close"),r()()(),i(13,"div",7)(14,"div",8)(15,"h3",9),o(16,"Total a Pagar"),r(),i(17,"p",10),o(18),r()(),i(19,"form",11),u("ngSubmit",function(){return a.onSubmit()}),i(20,"mat-form-field",12)(21,"mat-label"),o(22,"M\xE9todo de Pago"),r(),i(23,"mat-select",13),u("selectionChange",function(){return a.onPaymentMethodChange()}),i(24,"mat-option",14),o(25,"Efectivo"),r(),i(26,"mat-option",15),o(27,"Tarjeta"),r(),i(28,"mat-option",16),o(29,"Transferencia"),r()(),c(30,sa,2,0,"mat-error",17),r(),i(31,"mat-form-field",12)(32,"mat-label"),o(33,"Monto Pagado"),r(),_(34,"input",18),i(35,"span",19),o(36,"$\xA0"),r(),c(37,la,2,0,"mat-error",17)(38,ma,2,0,"mat-error",17),r(),c(39,da,6,0,"mat-form-field",20)(40,pa,9,1,"div",21),i(41,"div",22)(42,"button",23),u("click",function(){return a.onClose()}),i(43,"mat-icon"),o(44,"close"),r(),o(45," Cancelar "),r(),i(46,"button",24),c(47,ca,1,0,"mat-spinner",25)(48,ua,2,0,"mat-icon",17),o(49),r()()()()()),n&2){let s,d,g,S,le;l(9),M("Placa: ",a.carWash.plate,""),l(9),C(a.formatAmount(a.carWash.amount||0)),l(),p("formGroup",a.paymentForm),l(11),p("ngIf",(s=a.paymentForm.get("payment_method"))==null?null:s.hasError("required")),l(4),p("readonly",a.isAmountFieldDisabled()),l(3),p("ngIf",(d=a.paymentForm.get("amount"))==null?null:d.hasError("required")),l(),p("ngIf",(g=a.paymentForm.get("amount"))==null?null:g.hasError("min")),l(),p("ngIf",((S=a.paymentForm.get("payment_method"))==null?null:S.value)==="CARD"),l(),p("ngIf",((le=a.paymentForm.get("payment_method"))==null?null:le.value)==="CASH"&&a.shouldShowChange()),l(6),p("disabled",a.paymentForm.invalid||a.processing),l(),p("ngIf",a.processing),l(),p("ngIf",!a.processing),l(),M(" ",a.processing?"Procesando...":"Confirmar Pago"," ")}},dependencies:[T,W,ne,te,B,he,V,ee,ft,ht,ae,ie,w,D,F,I,Z,ce,j,O,A,P,k,R,N,se,oe,X,$,L,fe],styles:[".car-wash-payment-modal[_ngcontent-%COMP%]{min-width:500px}@media (max-width: 768px){.car-wash-payment-modal[_ngcontent-%COMP%]{min-width:auto;width:100%}}"]})}}return t})();function ha(t,m){if(t&1&&(i(0,"mat-option",53),o(1),r()),t&2){let e=m.$implicit;p("value",e.value),l(),M(" ",e.label," ")}}function fa(t,m){t&1&&(i(0,"th",54),o(1,"Placa"),r())}function _a(t,m){if(t&1&&(i(0,"td",55),o(1),r()),t&2){let e=m.$implicit;l(),C(e.plate)}}function ga(t,m){t&1&&(i(0,"th",56),o(1,"Tipo"),r())}function Ca(t,m){if(t&1&&(i(0,"td",57),o(1),r()),t&2){let e=m.$implicit,n=f();l(),C(n.getTypeName(e))}}function ya(t,m){t&1&&(i(0,"th",58),o(1,"Precio"),r())}function va(t,m){if(t&1&&(i(0,"td",57),o(1),r()),t&2){let e=m.$implicit,n=f();l(),C(n.formatAmount(e.amount))}}function ba(t,m){t&1&&(i(0,"th",56),o(1,"Duraci\xF3n Aprox."),r())}function xa(t,m){if(t&1&&(i(0,"td",57),o(1),r()),t&2){let e=m.$implicit;l(),M(" ",e.duration_minutes?e.duration_minutes+" min":"\u2014"," ")}}function Ma(t,m){t&1&&(i(0,"th",59),o(1,"Fecha"),r())}function Sa(t,m){if(t&1&&(i(0,"td",57),o(1),r()),t&2){let e=m.$implicit,n=f();l(),C(n.formatDateTime(e.performed_at))}}function Ea(t,m){t&1&&(i(0,"th",56),o(1,"Estado"),r())}function Wa(t,m){if(t&1&&(i(0,"td",60)(1,"span",61),o(2),r()()),t&2){let e=m.$implicit,n=f();l(),Ue("chip-success",e.status==="PAID")("chip-warn",e.status==="PENDING"),l(),M(" ",n.getStatusLabel(e.status)," ")}}function Ta(t,m){t&1&&(i(0,"th",62),o(1,"Acciones"),r())}function wa(t,m){if(t&1){let e=me();i(0,"button",65),u("click",function(){z(e);let a=f().$implicit,s=f();return q(s.payCarWash(a))}),i(1,"mat-icon"),o(2,"payment"),r(),o(3," Pagar "),r()}}function Ia(t,m){if(t&1){let e=me();i(0,"td",63)(1,"button",64)(2,"mat-icon"),o(3,"more_vert"),r()(),i(4,"mat-menu",null,0)(6,"button",65),u("click",function(){let a=z(e).$implicit,s=f();return q(s.viewCarWash(a))}),i(7,"mat-icon"),o(8,"visibility"),r(),o(9," Ver detalles "),r(),i(10,"button",65),u("click",function(){let a=z(e).$implicit,s=f();return q(s.editCarWash(a))}),i(11,"mat-icon"),o(12,"edit"),r(),o(13," Editar "),r(),c(14,wa,4,0,"button",66),r()()}if(t&2){let e=m.$implicit,n=Xe(5);l(),p("matMenuTriggerFor",n),l(13),p("ngIf",e.status==="PENDING")}}function Fa(t,m){t&1&&_(0,"tr",67)}function Da(t,m){t&1&&_(0,"tr",68)}function Pa(t,m){t&1&&(i(0,"div",69),_(1,"mat-spinner",70),i(2,"p",71),o(3,"Cargando lavados..."),r()())}function ka(t,m){if(t&1&&(i(0,"div",69)(1,"p",72),o(2),r()()),t&2){let e=f();l(2),C(e.error)}}function Aa(t,m){t&1&&(i(0,"div",69)(1,"p",4),o(2,"No hay lavados para los filtros seleccionados."),r()())}var qi=(()=>{class t{constructor(e,n,a,s){this.carWashService=e,this.snackBar=n,this.dialog=a,this.confirmationService=s,this._unsubscribeAll=new K,this.carWashes=[],this.washTypes=[],this.loading=!1,this.error=null,this.totalCarWashes=0,this.pendingCarWashes=0,this.paidCarWashes=0,this.totalRevenue=0,this.loadingMetrics=!1,this.totalItems=0,this.pageSize=15,this.currentPage=0,this.pageSizeOptions=[5,10,15,25,50],this.sortBy="performed_at",this.sortOrder="desc",this.filters={plate:"",status:""},this.statusOptions=[{value:"",label:"Todos"},{value:"PENDING",label:"Pendiente"},{value:"PAID",label:"Pagado"}],this.displayedColumns=["plate","type","amount","duration","performed_at","status","actions"]}ngOnInit(){this.loadWashTypes(),this.loadCarWashes(),this.loadMetrics()}ngAfterViewInit(){this.sort&&setTimeout(()=>{this.sort.active=this.sortBy,this.sort.direction=this.sortOrder},0)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadWashTypes(){this.carWashService.getCarWashTypes().pipe(v(this._unsubscribeAll)).subscribe({next:e=>{this.washTypes=e.data||[]},error:e=>{console.error("Error loading car wash types:",e),this.snackBar.open("Error al cargar tipos de lavado","Cerrar",{duration:3e3})}})}loadCarWashes(){this.loading=!0,this.error=null;let e={page:this.currentPage+1,per_page:this.pageSize,sort_by:this.sortBy,sort_order:this.sortOrder};this.filters.plate&&this.filters.plate.trim()!==""&&(e.plate=this.filters.plate.trim()),this.filters.status!==""&&(e.status=this.filters.status),this.carWashService.getCarWashes(e).pipe(v(this._unsubscribeAll)).subscribe({next:n=>{this.carWashes=n.data||[],this.totalItems=n.pagination?.total||0,this.loading=!1},error:n=>{console.error("Error loading car washes:",n),this.error="Error al cargar lavados",this.loading=!1,this.snackBar.open("Error al cargar lavados","Cerrar",{duration:3e3})}})}onSortChange(e){e.active===this.sortBy?this.sortOrder=this.sortOrder==="desc"?"asc":"desc":(this.sortBy=e.active,this.sortOrder=e.direction==="asc"?"asc":"desc"),this.currentPage=0,this.loadCarWashes()}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.loadCarWashes()}applyFilters(){this.currentPage=0,this.loadCarWashes(),this.loadMetrics()}clearFilters(){this.filters={plate:"",status:""},this.currentPage=0,this.loadCarWashes(),this.loadMetrics()}loadMetrics(){this.loadingMetrics=!0;let e={};this.filters.plate&&this.filters.plate.trim()!==""&&(e.plate=this.filters.plate.trim());let n=J(Q({},e),{page:1,per_page:1}),a=J(Q({},e),{status:"PENDING",page:1,per_page:1}),s=J(Q({},e),{status:"PAID",page:1,per_page:1});if(this.filters.status&&this.filters.status.trim()!==""){let d=J(Q({},e),{status:this.filters.status,page:1,per_page:1});this.carWashService.getCarWashes(d).pipe(v(this._unsubscribeAll)).subscribe({next:g=>{this.totalCarWashes=g.pagination?.total||0,this.filters.status==="PENDING"?(this.pendingCarWashes=g.pagination?.total||0,this.paidCarWashes=0,this.totalRevenue=0):this.filters.status==="PAID"?(this.pendingCarWashes=0,this.paidCarWashes=g.pagination?.total||0,this.calculateTotalRevenue(e)):(this.pendingCarWashes=0,this.paidCarWashes=0,this.totalRevenue=0),this.loadingMetrics=!1},error:g=>{console.error("Error loading metrics:",g),this.loadingMetrics=!1}})}else Ge({total:this.carWashService.getCarWashes(n),pending:this.carWashService.getCarWashes(a),paid:this.carWashService.getCarWashes(s)}).pipe(v(this._unsubscribeAll)).subscribe({next:d=>{this.totalCarWashes=d.total?.pagination?.total||0,this.pendingCarWashes=d.pending?.pagination?.total||0,this.paidCarWashes=d.paid?.pagination?.total||0,this.calculateTotalRevenue(e),this.loadingMetrics=!1},error:d=>{console.error("Error loading metrics:",d),this.loadingMetrics=!1}})}calculateTotalRevenue(e){let n=J(Q({},e),{status:"PAID",page:1,per_page:1e3});this.carWashService.getCarWashes(n).pipe(v(this._unsubscribeAll)).subscribe({next:a=>{let s=a.data||[];this.totalRevenue=s.reduce((d,g)=>d+(g.amount||0),0)},error:a=>{console.error("Error calculating total revenue:",a),this.totalRevenue=0}})}getTotalCarWashesCount(){return this.loadingMetrics?0:this.totalCarWashes}getPendingCarWashesCount(){return this.loadingMetrics?0:this.pendingCarWashes}getPaidCarWashesCount(){return this.loadingMetrics?0:this.paidCarWashes}getTotalRevenue(){return this.loadingMetrics?0:this.totalRevenue}openWashTypesModal(){this.dialog.open(It,{width:"900px",maxWidth:"95vw"}).afterClosed().subscribe(n=>{n&&this.loadWashTypes()})}openNewCarWashModal(){this.dialog.open($e,{width:"520px",maxWidth:"95vw",data:{washTypes:this.washTypes,isEdit:!1}}).afterClosed().subscribe(n=>{n&&(this.loadCarWashes(),this.loadMetrics())})}viewCarWash(e){let n=this.getTypeName(e),a=[{label:"Placa",key:"plate",icon:"confirmation_number",type:"text"},{label:"Tipo de Lavado",key:"car_wash_type",icon:"local_car_wash",type:"text",format:d=>d&&d.name||n},{label:"Monto",key:"amount",icon:"attach_money",type:"text",format:d=>this.formatAmount(d)},{label:"Duraci\xF3n",key:"duration_minutes",icon:"schedule",type:"text",format:d=>d?`${d} minutos`:"No especificado"},{label:"Estado",key:"status",icon:"info",type:"badge",format:d=>this.getStatusLabel(d),badgeColor:d=>d==="PAID"?"success":"warn"},{label:"Fecha de Realizaci\xF3n",key:"performed_at",icon:"event",type:"text",format:d=>d?this.formatDateTime(d):"No especificado"},{label:"Fecha de Pago",key:"paid_at",icon:"payment",type:"text",format:d=>d?this.formatDateTime(d):"No especificado"},{label:"Fecha de Creaci\xF3n",key:"created_at",icon:"schedule",type:"text",format:d=>d?this.formatDateTime(d):"No especificado"}],s=this.dialog.open(Tt,{width:"600px",data:{title:"Detalles del Lavado",data:e,fields:a,actions:[{label:"Editar",icon:"edit",color:"primary",action:()=>{s.close(),this.editCarWash(e)}}]}})}editCarWash(e){this.dialog.open($e,{width:"520px",maxWidth:"95vw",data:{carWash:e,washTypes:this.washTypes,isEdit:!0}}).afterClosed().subscribe(a=>{a&&(this.loadCarWashes(),this.loadMetrics())})}payCarWash(e){if(e.status!=="PENDING"){this.snackBar.open("Solo se pueden pagar lavados pendientes","Cerrar",{duration:3e3});return}this.dialog.open(Pt,{width:"520px",maxWidth:"95vw",data:{carWash:e}}).afterClosed().subscribe(a=>{a?.success&&(this.loadCarWashes(),this.loadMetrics())})}getTypeName(e){let n=e.car_wash_type?.name||e.carWashType?.name;return n||this.washTypes.find(s=>s.id===e.car_wash_type_id)?.name||"N/A"}formatAmount(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e||0)}formatDateTime(e){if(!e)return"N/A";let n=new Date(e);if(isNaN(n.getTime()))return"N/A";let a=n.toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"}),s=n.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${a} ${s}`}getStatusLabel(e){return e==="PAID"?"Pagado":"Pendiente"}getStatusColor(e){return e==="PAID"?"accent":"warn"}static{this.\u0275fac=function(n){return new(n||t)(h(G),h(H),h(nt),h(ue))}}static{this.\u0275cmp=E({type:t,selectors:[["app-car-washes"]],viewQuery:function(n,a){if(n&1&&Qe(Te,5),n&2){let s;Je(s=Ke())&&(a.sort=s.first)}},features:[Ze([{provide:vt,useValue:Wt()}])],decls:104,vars:16,consts:[["menu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"flex","gap-2"],["mat-stroked-button","",1,"rounded-sm",3,"click"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","mb-6"],[1,"p-6"],[1,"flex","items-center"],[1,"p-3","bg-blue-100","rounded-full"],[1,"text-blue-600"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"p-3","bg-yellow-100","rounded-full"],[1,"text-yellow-600"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"p-3","bg-green-100","rounded-full"],[1,"text-green-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["appearance","outline"],["matInput","","placeholder","ABC123",3,"ngModelChange","ngModel"],["matPrefix",""],[3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","gap-2","items-center","justify-end"],[1,"p-0"],[1,"overflow-x-auto"],["mat-table","","matSort","",1,"w-full",3,"matSortChange","dataSource"],["matColumnDef","plate"],["mat-header-cell","","mat-sort-header","plate",4,"matHeaderCellDef"],["mat-cell","","class","font-medium text-sm text-gray-900",4,"matCellDef"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-sm text-gray-600",4,"matCellDef"],["matColumnDef","amount"],["mat-header-cell","","mat-sort-header","amount",4,"matHeaderCellDef"],["matColumnDef","duration"],["matColumnDef","performed_at"],["mat-header-cell","","mat-sort-header","performed_at",4,"matHeaderCellDef"],["matColumnDef","status"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","p-6 text-center",4,"ngIf"],["showFirstLastButtons","",3,"page","length","pageSize","pageIndex","pageSizeOptions"],[3,"value"],["mat-header-cell","","mat-sort-header","plate"],["mat-cell","",1,"font-medium","text-sm","text-gray-900"],["mat-header-cell",""],["mat-cell","",1,"text-sm","text-gray-600"],["mat-header-cell","","mat-sort-header","amount"],["mat-header-cell","","mat-sort-header","performed_at"],["mat-cell",""],[1,"px-2","py-1","rounded","text-xs","font-medium"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row",""],[1,"p-6","text-center"],["diameter","40",1,"mx-auto"],[1,"mt-3","text-gray-600"],[1,"text-red-600"]],template:function(n,a){n&1&&(i(0,"div",1)(1,"div",2)(2,"div")(3,"h1",3),o(4,"Lavado de Autos"),r(),i(5,"p",4),o(6,"Gestiona los lavados de autos ofrecidos en el estacionamiento"),r()(),i(7,"div",5)(8,"button",6),u("click",function(){return a.openWashTypesModal()}),i(9,"mat-icon"),o(10,"settings"),r(),o(11," Tipos de Lavado "),r(),i(12,"button",7),u("click",function(){return a.openNewCarWashModal()}),i(13,"mat-icon"),o(14,"add"),r(),o(15," Nuevo Lavado "),r()()(),i(16,"div",8)(17,"mat-card")(18,"mat-card-content",9)(19,"div",10)(20,"div",11)(21,"mat-icon",12),o(22,"local_car_wash"),r()(),i(23,"div",13)(24,"p",14),o(25,"Total de Lavados"),r(),i(26,"p",15),o(27),r()()()()(),i(28,"mat-card")(29,"mat-card-content",9)(30,"div",10)(31,"div",16)(32,"mat-icon",17),o(33,"schedule"),r()(),i(34,"div",13)(35,"p",14),o(36,"Pendientes"),r(),i(37,"p",18),o(38),r()()()()(),i(39,"mat-card")(40,"mat-card-content",9)(41,"div",10)(42,"div",19)(43,"mat-icon",20),o(44,"check_circle"),r()(),i(45,"div",13)(46,"p",14),o(47,"Pagados"),r(),i(48,"p",21),o(49),r()()()()()(),i(50,"mat-card",22)(51,"mat-card-content",9)(52,"div",23)(53,"mat-form-field",24)(54,"mat-label"),o(55,"Buscar por Placa"),r(),i(56,"input",25),Pe("ngModelChange",function(d){return De(a.filters.plate,d)||(a.filters.plate=d),d}),r(),i(57,"mat-icon",26),o(58,"search"),r()(),i(59,"mat-form-field",24)(60,"mat-label"),o(61,"Estado"),r(),i(62,"mat-select",27),Pe("ngModelChange",function(d){return De(a.filters.status,d)||(a.filters.status=d),d}),c(63,ha,2,2,"mat-option",28),r()(),i(64,"div",29)(65,"button",6),u("click",function(){return a.clearFilters()}),i(66,"mat-icon"),o(67,"clear"),r(),o(68," Limpiar "),r(),i(69,"button",7),u("click",function(){return a.applyFilters()}),i(70,"mat-icon"),o(71,"filter_alt"),r(),o(72," Aplicar "),r()()()()(),i(73,"mat-card")(74,"mat-card-content",30)(75,"div",31)(76,"table",32),u("matSortChange",function(d){return a.onSortChange(d)}),b(77,33),c(78,fa,2,0,"th",34)(79,_a,2,1,"td",35),x(),b(80,36),c(81,ga,2,0,"th",37)(82,Ca,2,1,"td",38),x(),b(83,39),c(84,ya,2,0,"th",40)(85,va,2,1,"td",38),x(),b(86,41),c(87,ba,2,0,"th",37)(88,xa,2,1,"td",38),x(),b(89,42),c(90,Ma,2,0,"th",43)(91,Sa,2,1,"td",38),x(),b(92,44),c(93,Ea,2,0,"th",37)(94,Wa,3,5,"td",45),x(),b(95,46),c(96,Ta,2,0,"th",47)(97,Ia,15,2,"td",48),x(),c(98,Fa,1,0,"tr",49)(99,Da,1,0,"tr",50),r()(),c(100,Pa,4,0,"div",51)(101,ka,3,1,"div",51)(102,Aa,3,0,"div",51),i(103,"mat-paginator",52),u("page",function(d){return a.onPageChange(d)}),r()()()()),n&2&&(l(27),M(" ",a.loadingMetrics?"...":a.getTotalCarWashesCount()," "),l(11),M(" ",a.loadingMetrics?"...":a.getPendingCarWashesCount()," "),l(11),M(" ",a.loadingMetrics?"...":a.getPaidCarWashesCount()," "),l(7),Fe("ngModel",a.filters.plate),l(6),Fe("ngModel",a.filters.status),l(),p("ngForOf",a.statusOptions),l(13),p("dataSource",a.carWashes),l(22),p("matHeaderRowDef",a.displayedColumns),l(),p("matRowDefColumns",a.displayedColumns),l(),p("ngIf",a.loading),l(),p("ngIf",!a.loading&&a.error),l(),p("ngIf",!a.loading&&!a.error&&a.carWashes.length===0),l(),p("length",a.totalItems)("pageSize",a.pageSize)("pageIndex",a.currentPage)("pageSizeOptions",a.pageSizeOptions))},dependencies:[T,de,W,_t,B,V,ut,A,P,k,R,N,yt,gt,Ct,We,_e,Ce,xe,ye,ge,Me,ve,be,Se,Ee,D,F,I,ce,j,O,se,oe,X,$,L,fe,xt,bt,St,Te,Mt,Et,lt,ct,dt,mt,pt,w],styles:[".chip-success[_ngcontent-%COMP%]{background-color:#d1fae5!important;color:#059669!important}.chip-warn[_ngcontent-%COMP%]{background-color:#fef3c7!important;color:#d97706!important}.mat-table[_ngcontent-%COMP%]{font-size:.875rem}.mat-header-cell[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#374151}.mat-cell[_ngcontent-%COMP%]{font-size:.875rem}@media (max-width: 768px){.mat-table[_ngcontent-%COMP%]{font-size:14px}.mat-header-cell[_ngcontent-%COMP%]{font-size:11px!important;font-weight:500}.mat-cell[_ngcontent-%COMP%]{font-size:14px}}"]})}}return t})();export{qi as CarWashesComponent};
