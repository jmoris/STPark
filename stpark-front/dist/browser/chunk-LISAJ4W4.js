import{a as l}from"./chunk-VKB6BRO6.js";import{a as i,d as p}from"./chunk-7OGW3PNS.js";import{_ as c,c as o,da as u}from"./chunk-BSJZAB7M.js";var E=(()=>{class a{constructor(t){this.http=t,this.baseUrl=`${l.apiUrl}/sessions`}createSession(t){return this.http.post(this.baseUrl,t)}getQuote(t,e){return this.http.post(`${this.baseUrl}/${t}/quote`,e)}checkoutSession(t,e){return this.http.post(`${this.baseUrl}/${t}/checkout`,e)}getSession(t){return this.http.get(`${this.baseUrl}/${t}`)}getSessions(t={}){let e=new i;return t.page!==void 0&&t.page!==null&&(e=e.set("page",t.page.toString())),t.per_page!==void 0&&t.per_page!==null&&(e=e.set("per_page",t.per_page.toString())),Object.keys(t).forEach(s=>{if(s==="page"||s==="per_page")return;let r=t[s];r!=null&&r!==""&&(e=e.set(s,r.toString()))}),this.http.get(this.baseUrl,{params:e})}cancelSession(t){return this.http.post(`${this.baseUrl}/${t}/cancel`,{})}getActiveSessionByPlate(t,e){let s=new i().set("plate",t).set("sector_id",e.toString());return this.http.get(`${this.baseUrl}/active-by-plate`,{params:s})}getActiveSessions(t){let e={status:"ACTIVE",operator_id:t};return new o(s=>{this.getSessions(e).subscribe({next:r=>{s.next({success:r.success,data:r.data||[],message:"Sesiones activas obtenidas"}),s.complete()},error:r=>{s.error(r)}})})}getTodaySessions(t){let e=new Date().toISOString().split("T")[0],s={date_from:e,date_to:e,operator_id:t};return new o(r=>{this.getSessions(s).subscribe({next:n=>{r.next({success:n.success,data:n.data||[],message:"Sesiones del d\xEDa obtenidas"}),r.complete()},error:n=>{r.error(n)}})})}hasActiveSession(t,e){return new o(s=>{this.getActiveSessionByPlate(t,e).subscribe({next:r=>{s.next(r.data!==null),s.complete()},error:r=>{s.error(r)}})})}formatDuration(t){let e=Math.floor(t/3600),s=Math.floor(t%3600/60);return e>0?`${e}h ${s}m`:`${s}m`}formatAmount(t){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}validateChileanPlate(t){let e=t.toUpperCase().replace(/\s/g,"");return[/^[A-Z]{2}[0-9]{4}$/,/^[0-9]{4}[A-Z]{2}$/,/^[A-Z]{4}[0-9]{2}$/].some(r=>r.test(e))}getStatusLabel(t){return{CREATED:"Creada",ACTIVE:"Activa",TO_PAY:"Por Pagar",PAID:"Pagada",CLOSED:"Cerrada",CANCELED:"Cancelada",CANCELLED:"Cancelada",COMPLETED:"Completada",FORCED_CHECKOUT:"Checkout Forzado"}[t]||t}getStatusColor(t){return{CREATED:"blue",ACTIVE:"green",TO_PAY:"orange",PAID:"green",CLOSED:"gray",CANCELED:"red",CANCELLED:"red",COMPLETED:"green",FORCED_CHECKOUT:"orange"}[t]||"gray"}static{this.\u0275fac=function(e){return new(e||a)(u(p))}}static{this.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{E as a};
