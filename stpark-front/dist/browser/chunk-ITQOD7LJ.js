import{a as Je}from"./chunk-OE5D7KXE.js";import{a as nt}from"./chunk-ZMZZWBL4.js";import{c as Ke}from"./chunk-FRZBS72K.js";import{a as Ae,b as Ne,c as Be,d as Le,e as je,f as He,g as Ue,h as ze,i as qe,j as Ge,k as We,l as Ye,m as Xe}from"./chunk-DVKEPSGT.js";import{a as et,c as tt,f as it}from"./chunk-XQK4L4ZU.js";import{a as Re,b as Fe,c as ke,d as $e}from"./chunk-CYULJBIT.js";import{a as Ve,b as Oe}from"./chunk-3TK3OLOO.js";import"./chunk-2LVKS4R7.js";import{a as Qe,b as Ze}from"./chunk-2A6RA7CH.js";import{g as me}from"./chunk-CCPXNPAN.js";import{c as X}from"./chunk-RRH7I2VE.js";import{c as ce,d as se,e as de,f as pe}from"./chunk-BY5IVZ2R.js";import"./chunk-YGRHM56X.js";import{a as R}from"./chunk-VKB6BRO6.js";import{a as Ie,b as De}from"./chunk-OVLCZUMA.js";import{b as oe,c as le}from"./chunk-WP7DXJZF.js";import{a as Me,b as Te}from"./chunk-4LV3ZYQA.js";import{b as J,c as K,d as Q,e as Z,f as ee,j as te,k as ie,o as ye,p as we}from"./chunk-4UMW4R4I.js";import{b as ue,d as M,f as _e,g as fe,j as ge,k as xe,l as ve,n as he,o as Pe,s as Ce,v as Ee,x as be,y as Se}from"./chunk-EGGCURRC.js";import{ea as Y,ka as ne,ma as re,na as ae}from"./chunk-HOABDKFW.js";import"./chunk-CQGOYTFO.js";import{a as G,d as W}from"./chunk-7OGW3PNS.js";import{l as U,m as z,s as q}from"./chunk-TQARHOKX.js";import{$b as _,Eb as c,Ib as I,Pb as n,Qb as t,Rb as v,Sb as P,Tb as C,U as y,Vb as w,_ as B,bb as l,bc as s,cb as T,da as L,f as N,lc as D,mc as r,nc as h,oa as g,oc as u,pa as x,pb as j,pc as V,qc as H,rc as F,sc as k,tc as $,wb as p}from"./chunk-BSJZAB7M.js";import{a as O,b as A}from"./chunk-TSRGIXR5.js";var rt=(()=>{class i{constructor(e){this.http=e,this.baseUrl=`${R.apiUrl}/pricing-profiles`}getPricingProfiles(e={}){let a=new G;return Object.keys(e).forEach(o=>{e[o]!==null&&e[o]!==void 0&&e[o]!==""&&(a=a.set(o,e[o].toString()))}),this.http.get(this.baseUrl,{params:a})}getPricingProfile(e){return this.http.get(`${this.baseUrl}/${e}`)}createPricingProfile(e){return this.http.post(this.baseUrl,e)}updatePricingProfile(e,a){return this.http.put(`${this.baseUrl}/${e}`,a)}deletePricingProfile(e){return this.http.delete(`${this.baseUrl}/${e}`)}togglePricingProfile(e,a){return this.http.post(`${this.baseUrl}/${e}/toggle-status`,{is_active:a})}getPricingRules(e){return this.http.get(`${this.baseUrl}/${e}/rules`)}createPricingRule(e){return this.http.post(`${R.apiUrl}/pricing-rules`,e)}updatePricingRule(e,a){return this.http.put(`${R.apiUrl}/pricing-rules/${e}`,a)}deletePricingRule(e){return this.http.delete(`${R.apiUrl}/pricing-rules/${e}`)}togglePricingRule(e,a){return this.http.post(`${R.apiUrl}/pricing-rules/${e}/toggle-status`,{is_active:a})}static{this.\u0275fac=function(a){return new(a||i)(L(W))}}static{this.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function lt(i,m){if(i&1&&(n(0,"mat-option",30),r(1),t()),i&2){let e=m.$implicit;c("value",e.id),l(),u(" ",e.name," ")}}function mt(i,m){i&1&&(n(0,"div",41),v(1,"mat-spinner",42),t())}function ct(i,m){if(i&1&&(n(0,"div",25)(1,"fuse-alert",43),r(2),t()()),i&2){let e=s();l(),c("dismissible",!0),l(),u(" ",e.error," ")}}function st(i,m){i&1&&(n(0,"th",62),r(1,"Nombre"),t())}function dt(i,m){if(i&1&&(n(0,"div",66),r(1),t()),i&2){let e=s().$implicit;l(),h(e.description)}}function pt(i,m){if(i&1&&(n(0,"td",63)(1,"div",64),r(2),t(),p(3,dt,2,1,"div",65),t()),i&2){let e=m.$implicit;l(2),h(e.name),l(),c("ngIf",e.description)}}function ut(i,m){i&1&&(n(0,"th",67),r(1,"Sector"),t())}function _t(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(2),h(a.getSectorName(e.sector_id))}}function ft(i,m){i&1&&(n(0,"th",67),r(1,"Vigente Desde"),t())}function gt(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(2),h(a.formatDate(e.active_from))}}function xt(i,m){i&1&&(n(0,"th",67),r(1,"Vigente Hasta"),t())}function vt(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(2),h(e.active_to?a.formatDate(e.active_to):"Indefinido")}}function ht(i,m){i&1&&(n(0,"th",68),r(1,"Estado"),t())}function Pt(i,m){if(i&1&&(n(0,"td",63)(1,"span",69),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(),I("bg-"+a.getStatusColor(e.is_active)+"-100 text-"+a.getStatusColor(e.is_active)+"-800"),l(),u(" ",a.getStatusLabel(e.is_active)," ")}}function Ct(i,m){i&1&&(n(0,"th",68),r(1,"Reglas"),t())}function Et(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit;l(2),h((e.pricing_rules==null?null:e.pricing_rules.length)||0)}}function bt(i,m){i&1&&(n(0,"th",70),r(1,"Acciones"),t())}function St(i,m){if(i&1){let e=w();n(0,"td",71)(1,"button",72)(2,"mat-icon"),r(3,"more_vert"),t()(),n(4,"mat-menu",null,0)(6,"button",73),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.manageRules(o))}),n(7,"mat-icon"),r(8,"rule"),t(),r(9," Gestionar Reglas "),t(),n(10,"button",73),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.editProfile(o))}),n(11,"mat-icon"),r(12,"edit"),t(),r(13," Editar Perfil "),t(),n(14,"button",73),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.toggleProfile(o))}),n(15,"mat-icon"),r(16),t(),r(17),t(),n(18,"button",74),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.deleteProfile(o))}),n(19,"mat-icon"),r(20,"delete"),t(),r(21," Eliminar "),t()()()}if(i&2){let e=m.$implicit,a=D(5);l(),c("matMenuTriggerFor",a),l(15),h(e.is_active?"pause":"play_arrow"),l(),u(" ",e.is_active?"Desactivar":"Activar"," ")}}function yt(i,m){i&1&&v(0,"tr",75)}function wt(i,m){i&1&&v(0,"tr",76)}function Mt(i,m){if(i&1&&(n(0,"mat-card")(1,"mat-card-content",44)(2,"div",45)(3,"table",46),P(4,47),p(5,st,2,0,"th",48)(6,pt,4,2,"td",49),C(),P(7,50),p(8,ut,2,0,"th",51)(9,_t,3,1,"td",49),C(),P(10,52),p(11,ft,2,0,"th",51)(12,gt,3,1,"td",49),C(),P(13,53),p(14,xt,2,0,"th",51)(15,vt,3,1,"td",49),C(),P(16,54),p(17,ht,2,0,"th",55)(18,Pt,3,3,"td",49),C(),P(19,56),p(20,Ct,2,0,"th",55)(21,Et,3,1,"td",49),C(),P(22,57),p(23,bt,2,0,"th",58)(24,St,22,3,"td",59),C(),p(25,yt,1,0,"tr",60)(26,wt,1,0,"tr",61),t()()()()),i&2){let e=s();l(3),c("dataSource",e.pricingProfiles),l(22),c("matHeaderRowDef",e.displayedColumns),l(),c("matRowDefColumns",e.displayedColumns)}}function Tt(i,m){if(i&1){let e=w();n(0,"mat-paginator",77),_("page",function(o){g(e);let d=s();return x(d.onPageChange(o))}),t()}if(i&2){let e=s();c("length",e.totalItems)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("pageIndex",e.currentPage)}}function It(i,m){if(i&1){let e=w();n(0,"div",78)(1,"mat-icon",79),r(2,"price_check"),t(),n(3,"h3",80),r(4,"No hay perfiles de precios"),t(),n(5,"p",81),r(6,"No se encontraron perfiles de precios con los filtros aplicados."),t(),n(7,"button",8),_("click",function(){g(e);let o=s();return x(o.createProfile())}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Crear Nuevo Perfil "),t()()}}function Dt(i,m){if(i&1&&(n(0,"mat-option",30),r(1),t()),i&2){let e=m.$implicit;c("value",e.id),l(),u(" ",e.name," ")}}function Rt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(2);l(),u(" ",e.getErrorMessage("sector_id")," ")}}function Ft(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(2);l(),u(" ",e.getErrorMessage("name")," ")}}function kt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(2);l(),u(" ",e.getErrorMessage("name")," ")}}function $t(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(2);l(),u(" ",e.getErrorMessage("active_from")," ")}}function Vt(i,m){if(i&1){let e=w();n(0,"div",82)(1,"div",83)(2,"h2",84),r(3),t(),n(4,"form",85),_("ngSubmit",function(){g(e);let o=s();return x(o.saveProfile())}),n(5,"div",86)(6,"mat-form-field",27)(7,"mat-label"),r(8,"Sector"),t(),n(9,"mat-select",87),p(10,Dt,2,2,"mat-option",31),t(),p(11,Rt,2,1,"mat-error",36),t(),n(12,"mat-form-field",27)(13,"mat-label"),r(14,"Nombre"),t(),v(15,"input",88),p(16,Ft,2,1,"mat-error",36)(17,kt,2,1,"mat-error",36),t(),n(18,"mat-form-field",27)(19,"mat-label"),r(20,"Vigente Desde"),t(),v(21,"input",89)(22,"mat-datepicker-toggle",90)(23,"mat-datepicker",null,1),p(25,$t,2,1,"mat-error",36),t(),n(26,"mat-form-field",27)(27,"mat-label"),r(28,"Vigente Hasta (Opcional)"),t(),v(29,"input",91)(30,"mat-datepicker-toggle",90)(31,"mat-datepicker",null,2),t()(),n(33,"mat-form-field",92)(34,"mat-label"),r(35,"Descripci\xF3n"),t(),v(36,"textarea",93),t(),n(37,"div",25)(38,"mat-checkbox",94),r(39," Perfil activo "),t()(),n(40,"div",95)(41,"button",96),_("click",function(){g(e);let o=s();return x(o.cancelEdit())}),r(42," Cancelar "),t(),n(43,"button",97),r(44),t()()()()()}if(i&2){let e,a,o,d,f=D(24),S=D(32),b=s();l(3),u(" ",b.editingProfile?"Editar Perfil de Precios":"Nuevo Perfil de Precios"," "),l(),c("formGroup",b.profileForm),l(6),c("ngForOf",b.sectors),l(),c("ngIf",(e=b.profileForm.get("sector_id"))==null?null:e.hasError("required")),l(5),c("ngIf",(a=b.profileForm.get("name"))==null?null:a.hasError("required")),l(),c("ngIf",(o=b.profileForm.get("name"))==null?null:o.hasError("minlength")),l(4),c("matDatepicker",f),l(),c("for",f),l(3),c("ngIf",(d=b.profileForm.get("active_from"))==null?null:d.hasError("required")),l(4),c("matDatepicker",S),l(),c("for",S),l(13),c("disabled",b.profileForm.invalid),l(),u(" ",b.editingProfile?"Actualizar":"Crear"," Perfil ")}}function Ot(i,m){i&1&&(n(0,"th",129),r(1,"Nombre"),t())}function At(i,m){if(i&1&&(n(0,"td",130)(1,"div",64),r(2),t()()),i&2){let e=m.$implicit;l(2),h(e.name)}}function Nt(i,m){i&1&&(n(0,"th",129),r(1,"Tipo"),t())}function Bt(i,m){if(i&1&&(n(0,"td",130)(1,"span",131),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(),I("bg-"+a.getRuleTypeColor(e.rule_type)+"-100 text-"+a.getRuleTypeColor(e.rule_type)+"-800"),l(),u(" ",a.getRuleTypeLabel(e.rule_type)," ")}}function Lt(i,m){i&1&&(n(0,"th",129),r(1,"Duraci\xF3n"),t())}function jt(i,m){if(i&1&&(n(0,"div",134),r(1),t()),i&2){let e=s().$implicit;l(),u(" M\xEDn: $",e.min_amount," ")}}function Ht(i,m){if(i&1&&(n(0,"div",135),r(1),t()),i&2){let e=s().$implicit;l(),u(" M\xE1x: $",e.daily_max_amount," ")}}function Ut(i,m){if(i&1&&(n(0,"td",130)(1,"div",66)(2,"div"),r(3),t(),p(4,jt,2,1,"div",132)(5,Ht,2,1,"div",133),t()()),i&2){let e=m.$implicit;l(3),V("",e.min_duration_minutes,"-",e.max_duration_minutes||"\u221E"," min"),l(),c("ngIf",e.min_amount),l(),c("ngIf",e.daily_max_amount)}}function zt(i,m){i&1&&(n(0,"th",129),r(1,"Precio"),t())}function qt(i,m){if(i&1&&(n(0,"span",18),r(1),t()),i&2){let e=s().$implicit;l(),u("$",e.fixed_price,"")}}function Gt(i,m){if(i&1&&(n(0,"span",13),r(1),t()),i&2){let e=s().$implicit;l(),u("$",e.price_per_min,"/min")}}function Wt(i,m){if(i&1&&(n(0,"td",130)(1,"div",136),p(2,qt,2,1,"span",137)(3,Gt,2,1,"span",138),t()()),i&2){let e=m.$implicit;l(2),c("ngIf",e.fixed_price),l(),c("ngIf",e.price_per_min)}}function Yt(i,m){i&1&&(n(0,"th",129),r(1,"D\xEDas"),t())}function Xt(i,m){if(i&1&&(n(0,"td",130)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(2),u(" ",a.getDaysLabel(e.days_of_week)," ")}}function Jt(i,m){i&1&&(n(0,"th",129),r(1,"Horario"),t())}function Kt(i,m){if(i&1&&(n(0,"td",130)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(2),u(" ",a.formatTimeRange(e.start_time,e.end_time)," ")}}function Qt(i,m){i&1&&(n(0,"th",129),r(1,"Estado"),t())}function Zt(i,m){if(i&1&&(n(0,"td",130)(1,"span",131),r(2),t()()),i&2){let e=m.$implicit,a=s(2);l(),I("bg-"+a.getStatusColor(e.is_active)+"-100 text-"+a.getStatusColor(e.is_active)+"-800"),l(),u(" ",a.getStatusLabel(e.is_active)," ")}}function ei(i,m){i&1&&(n(0,"th",139),r(1,"Acciones"),t())}function ti(i,m){if(i&1){let e=w();n(0,"td",140)(1,"button",141)(2,"mat-icon"),r(3,"more_vert"),t()(),n(4,"mat-menu",null,3)(6,"button",73),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.editRule(o))}),n(7,"mat-icon"),r(8,"edit"),t(),r(9," Editar "),t(),n(10,"button",73),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.toggleRule(o))}),n(11,"mat-icon"),r(12),t(),r(13),t(),n(14,"button",74),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.deleteRule(o))}),n(15,"mat-icon"),r(16,"delete"),t(),r(17," Eliminar "),t()()()}if(i&2){let e=m.$implicit,a=D(5);l(),c("matMenuTriggerFor",a),l(11),h(e.is_active?"pause":"play_arrow"),l(),u(" ",e.is_active?"Desactivar":"Activar"," ")}}function ii(i,m){i&1&&v(0,"tr",142)}function ni(i,m){i&1&&v(0,"tr",143)}function ri(i,m){if(i&1&&(n(0,"div",134),r(1),t()),i&2){let e=s().$implicit;l(),u(" M\xEDn: $",e.min_amount," ")}}function ai(i,m){if(i&1&&(n(0,"div",135),r(1),t()),i&2){let e=s().$implicit;l(),u(" M\xE1x: $",e.daily_max_amount," ")}}function oi(i,m){if(i&1&&(n(0,"span",134),r(1),t()),i&2){let e=s().$implicit;l(),u("$",e.fixed_price,"")}}function li(i,m){if(i&1&&(n(0,"span",135),r(1),t()),i&2){let e=s().$implicit;l(),u("$",e.price_per_min,"/min")}}function mi(i,m){if(i&1){let e=w();n(0,"div",144)(1,"div",145)(2,"div",146)(3,"h3",147),r(4),t(),n(5,"div",148)(6,"span",131),r(7),t(),n(8,"span",131),r(9),t()()(),n(10,"button",149)(11,"mat-icon"),r(12,"more_vert"),t()(),n(13,"mat-menu",null,3)(15,"button",73),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.editRule(o))}),n(16,"mat-icon"),r(17,"edit"),t(),r(18," Editar "),t(),n(19,"button",73),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.toggleRule(o))}),n(20,"mat-icon"),r(21),t(),r(22),t(),n(23,"button",74),_("click",function(){let o=g(e).$implicit,d=s(2);return x(d.deleteRule(o))}),n(24,"mat-icon"),r(25,"delete"),t(),r(26," Eliminar "),t()()(),n(27,"div",150)(28,"div")(29,"span",151),r(30,"Duraci\xF3n:"),t(),v(31,"br"),r(32),p(33,ri,2,1,"div",132)(34,ai,2,1,"div",133),t(),n(35,"div")(36,"span",151),r(37,"Precio:"),t(),v(38,"br"),p(39,oi,2,1,"span",132)(40,li,2,1,"span",133),t(),n(41,"div")(42,"span",151),r(43,"D\xEDas:"),t(),v(44,"br"),r(45),t(),n(46,"div")(47,"span",151),r(48,"Horario:"),t(),v(49,"br"),r(50),t()()()}if(i&2){let e=m.$implicit,a=D(14),o=s(2);l(4),h(e.name),l(2),I("bg-"+o.getRuleTypeColor(e.rule_type)+"-100 text-"+o.getRuleTypeColor(e.rule_type)+"-800"),l(),u(" ",o.getRuleTypeLabel(e.rule_type)," "),l(),I("bg-"+o.getStatusColor(e.is_active)+"-100 text-"+o.getStatusColor(e.is_active)+"-800"),l(),u(" ",o.getStatusLabel(e.is_active)," "),l(),c("matMenuTriggerFor",a),l(11),h(e.is_active?"pause":"play_arrow"),l(),u(" ",e.is_active?"Desactivar":"Activar"," "),l(10),V(" ",e.min_duration_minutes,"-",e.max_duration_minutes||"\u221E"," min "),l(),c("ngIf",e.min_amount),l(),c("ngIf",e.daily_max_amount),l(5),c("ngIf",e.fixed_price),l(),c("ngIf",e.price_per_min),l(5),u(" ",o.getDaysLabel(e.days_of_week)," "),l(5),u(" ",o.formatTimeRange(e.start_time,e.end_time)," ")}}function ci(i,m){if(i&1){let e=w();n(0,"div",78)(1,"mat-icon",79),r(2,"rule"),t(),n(3,"h3",80),r(4,"No hay reglas de precios"),t(),n(5,"p",152),r(6,"Este perfil no tiene reglas de precios configuradas."),t(),n(7,"button",108),_("click",function(){g(e);let o=s(2);return x(o.addRule())}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Crear Primera Regla "),t()()}}function si(i,m){if(i&1){let e=w();n(0,"div",98)(1,"div",99)(2,"div",100)(3,"div",101)(4,"mat-icon",13),r(5,"price_check"),t(),n(6,"div")(7,"h2",102),r(8," Gestionar Reglas de Precios "),t(),n(9,"p",66),r(10),t()()(),n(11,"button",103),_("click",function(){g(e);let o=s();return x(o.closeRulesModal())}),n(12,"mat-icon"),r(13,"close"),t()()(),n(14,"div",104)(15,"div",105)(16,"div",106)(17,"div",107)(18,"button",108),_("click",function(){g(e);let o=s();return x(o.addRule())}),n(19,"mat-icon"),r(20,"add"),t(),r(21," Nueva Regla "),t(),n(22,"span",66),r(23),t()()()(),n(24,"div",109)(25,"div",110)(26,"div",111)(27,"table",112),P(28,47),p(29,Ot,2,0,"th",113)(30,At,3,1,"td",114),C(),P(31,115),p(32,Nt,2,0,"th",113)(33,Bt,3,3,"td",114),C(),P(34,116),p(35,Lt,2,0,"th",113)(36,Ut,6,4,"td",114),C(),P(37,117),p(38,zt,2,0,"th",113)(39,Wt,4,2,"td",114),C(),P(40,118),p(41,Yt,2,0,"th",113)(42,Xt,3,1,"td",114),C(),P(43,119),p(44,Jt,2,0,"th",113)(45,Kt,3,1,"td",114),C(),P(46,54),p(47,Qt,2,0,"th",113)(48,Zt,3,3,"td",114),C(),P(49,57),p(50,ei,2,0,"th",120)(51,ti,18,3,"td",121),C(),p(52,ii,1,0,"tr",122)(53,ni,1,0,"tr",123),t()(),n(54,"div",124),p(55,mi,51,18,"div",125),t()()(),n(56,"div",126)(57,"div",127)(58,"button",128),_("click",function(){g(e);let o=s();return x(o.closeRulesModal())}),r(59," Cerrar "),t()(),p(60,ci,11,0,"div",38),t()()()()}if(i&2){let e=s();l(10),h(e.selectedProfile==null?null:e.selectedProfile.name),l(13),H(" ",e.pricingRules.length," regla",e.pricingRules.length!==1?"s":""," configurada",e.pricingRules.length!==1?"s":""," "),l(4),c("dataSource",e.pricingRules),l(25),c("matHeaderRowDef",e.ruleColumns),l(),c("matRowDefColumns",e.ruleColumns),l(2),c("ngForOf",e.pricingRules),l(5),c("ngIf",e.pricingRules.length===0)}}function di(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(2);l(),u(" ",e.getErrorMessage("name")," ")}}function pi(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(2);l(),u(" ",e.getErrorMessage("rule_type")," ")}}function ui(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(2);l(),u(" ",e.getErrorMessage("min_duration_minutes")," ")}}function _i(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(3);l(),u(" ",e.getErrorMessage("price_per_minute")," ")}}function fi(i,m){if(i&1&&(n(0,"mat-form-field",27)(1,"mat-label"),r(2,"Precio por Minuto"),t(),v(3,"input",173),n(4,"span",163),r(5,"$\xA0"),t(),p(6,_i,2,1,"mat-error",36),t()),i&2){let e,a=s(2);l(6),c("ngIf",(e=a.ruleForm.get("price_per_minute"))==null?null:e.hasError("required"))}}function gi(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=s(3);l(),u(" ",e.getErrorMessage("fixed_price")," ")}}function xi(i,m){if(i&1&&(n(0,"mat-form-field",27)(1,"mat-label"),r(2,"Precio Fijo"),t(),v(3,"input",174),n(4,"span",163),r(5,"$\xA0"),t(),p(6,gi,2,1,"mat-error",36),t()),i&2){let e,a=s(2);l(6),c("ngIf",(e=a.ruleForm.get("fixed_price"))==null?null:e.hasError("required"))}}function vi(i,m){if(i&1){let e=w();n(0,"mat-checkbox",175),_("change",function(o){let d=g(e).$implicit,f=s(2);return x(f.onDayChange(o,d.value))}),r(1),t()}if(i&2){let e=m.$implicit,a=s(2);c("value",e.value)("checked",a.isDaySelected(e.value)),l(),u(" ",e.label," ")}}function hi(i,m){if(i&1){let e=w();n(0,"div",82)(1,"div",153)(2,"h2",84),r(3),t(),n(4,"form",85),_("ngSubmit",function(){g(e);let o=s();return x(o.saveRule())}),n(5,"div",86)(6,"mat-form-field",27)(7,"mat-label"),r(8,"Nombre de la Regla"),t(),v(9,"input",154),p(10,di,2,1,"mat-error",36),t(),n(11,"mat-form-field",27)(12,"mat-label"),r(13,"Tipo de Regla"),t(),n(14,"mat-select",155)(15,"mat-option",156),r(16,"Por Tiempo"),t(),n(17,"mat-option",157),r(18,"Precio Fijo"),t(),n(19,"mat-option",158),r(20,"Graduada"),t(),n(21,"mat-option",159),r(22,"Por Hora"),t()(),p(23,pi,2,1,"mat-error",36),t(),n(24,"mat-form-field",27)(25,"mat-label"),r(26,"Duraci\xF3n M\xEDnima (min)"),t(),v(27,"input",160),p(28,ui,2,1,"mat-error",36),t(),n(29,"mat-form-field",27)(30,"mat-label"),r(31,"Duraci\xF3n M\xE1xima (min)"),t(),v(32,"input",161),n(33,"mat-hint"),r(34,"Dejar vac\xEDo para sin l\xEDmite"),t()(),n(35,"mat-form-field",27)(36,"mat-label"),r(37,"Monto M\xE1ximo Diario"),t(),v(38,"input",162),n(39,"span",163),r(40,"$\xA0"),t(),n(41,"mat-hint"),r(42,"Monto m\xE1ximo a cobrar por d\xEDa completo (ej: $10.000)"),t()(),n(43,"mat-form-field",27)(44,"mat-label"),r(45,"Monto M\xEDnimo"),t(),v(46,"input",164),n(47,"span",163),r(48,"$\xA0"),t(),n(49,"mat-hint"),r(50,"Monto m\xEDnimo a cobrar independientemente del tiempo (ej: $500)"),t()(),p(51,fi,7,1,"mat-form-field",165)(52,xi,7,1,"mat-form-field",165),n(53,"mat-form-field",27)(54,"mat-label"),r(55,"Hora de Inicio"),t(),n(56,"input",166),_("change",function(o){g(e);let d=s();return x(d.onTimeChange("start_time",o))}),t(),n(57,"mat-hint"),r(58,"Dejar vac\xEDo para todo el d\xEDa"),t()(),n(59,"mat-form-field",27)(60,"mat-label"),r(61,"Hora de Fin"),t(),n(62,"input",167),_("change",function(o){g(e);let d=s();return x(d.onTimeChange("end_time",o))}),t(),n(63,"mat-hint"),r(64,"Dejar vac\xEDo para todo el d\xEDa"),t()()(),n(65,"div",168)(66,"label",169),r(67,"D\xEDas de la Semana"),t(),n(68,"div",170),p(69,vi,2,3,"mat-checkbox",171),t(),n(70,"mat-hint"),r(71,"Seleccionar d\xEDas aplicables (opcional)"),t()(),n(72,"mat-form-field",92)(73,"mat-label"),r(74,"Prioridad"),t(),v(75,"input",172),n(76,"mat-hint"),r(77,"Las reglas con mayor prioridad se eval\xFAan primero"),t()(),n(78,"div",25)(79,"mat-checkbox",94),r(80," Regla activa "),t()(),n(81,"div",95)(82,"button",96),_("click",function(){g(e);let o=s();return x(o.cancelRuleEdit())}),r(83," Cancelar "),t(),n(84,"button",97),r(85),t()()()()()}if(i&2){let e,a,o,d,f,S,b,E=s();l(3),u(" ",E.editingRule?"Editar Regla de Precios":"Nueva Regla de Precios"," "),l(),c("formGroup",E.ruleForm),l(6),c("ngIf",(e=E.ruleForm.get("name"))==null?null:e.hasError("required")),l(13),c("ngIf",(a=E.ruleForm.get("rule_type"))==null?null:a.hasError("required")),l(5),c("ngIf",(o=E.ruleForm.get("min_duration_minutes"))==null?null:o.hasError("required")),l(23),c("ngIf",((d=E.ruleForm.get("rule_type"))==null?null:d.value)==="TIME_BASED"||((d=E.ruleForm.get("rule_type"))==null?null:d.value)==="HOURLY"),l(),c("ngIf",((f=E.ruleForm.get("rule_type"))==null?null:f.value)==="FIXED"),l(4),c("value",E.getTimeValue((S=E.ruleForm.get("start_time"))==null?null:S.value)),l(6),c("value",E.getTimeValue((b=E.ruleForm.get("end_time"))==null?null:b.value)),l(7),c("ngForOf",E.daysOfWeek),l(15),c("disabled",E.ruleForm.invalid),l(),u(" ",E.editingRule?"Actualizar":"Crear"," Regla ")}}var ln=(()=>{class i{constructor(e,a,o,d,f,S){this.pricingProfileService=e,this.sectorService=a,this.fb=o,this.snackBar=d,this.dialog=f,this.confirmationService=S,this._unsubscribeAll=new N,this.pricingProfiles=[],this.sectors=[],this.loading=!1,this.error=null,this.totalItems=0,this.pageSize=10,this.currentPage=0,this.pageSizeOptions=[5,10,25,50],this.filters={sector_id:void 0,name:"",is_active:void 0},this.showForm=!1,this.editingProfile=null,this.showRulesModal=!1,this.showRuleForm=!1,this.selectedProfile=null,this.pricingRules=[],this.editingRule=null,this.selectedDays=[],this.daysOfWeek=[{value:0,label:"Domingo"},{value:1,label:"Lunes"},{value:2,label:"Martes"},{value:3,label:"Mi\xE9rcoles"},{value:4,label:"Jueves"},{value:5,label:"Viernes"},{value:6,label:"S\xE1bado"}],this.ruleColumns=["name","rule_type","duration","price","days","time","status","actions"],this.displayedColumns=["name","sector","active_from","active_to","status","rules_count","actions"],this.profileForm=this.createForm(),this.ruleForm=this.createRuleForm()}ngOnInit(){this.loadSectors(),this.loadPricingProfiles()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createForm(){return this.fb.group({sector_id:["",[M.required]],name:["",[M.required,M.minLength(2)]],description:[""],active_from:[new Date,[M.required]],active_to:[null],is_active:[!0]})}loadSectors(){this.sectorService.getSectors().pipe(y(this._unsubscribeAll)).subscribe({next:e=>{this.sectors=e.data?.data||e.data||[]},error:e=>{console.error("Error loading sectors:",e)}})}loadPricingProfiles(){this.loading=!0;let e={page:this.currentPage+1,per_page:this.pageSize};this.filters.name&&this.filters.name.trim()!==""&&(e.name=this.filters.name),this.filters.sector_id!==void 0&&(e.sector_id=this.filters.sector_id),this.filters.is_active!==void 0&&(e.is_active=this.filters.is_active),this.pricingProfileService.getPricingProfiles(e).pipe(y(this._unsubscribeAll)).subscribe({next:a=>{this.pricingProfiles=a.data?.data||[],this.totalItems=a.data?.total||0,this.loading=!1},error:a=>{this.error="Error al cargar perfiles de precios",this.loading=!1,console.error("Error loading pricing profiles:",a),this.snackBar.open("Error al cargar perfiles de precios","Cerrar",{duration:3e3})}})}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.loadPricingProfiles()}applyFilters(){this.currentPage=0,this.loadPricingProfiles()}clearFilters(){this.filters={sector_id:void 0,name:"",is_active:void 0},this.currentPage=0,this.loadPricingProfiles()}createProfile(){this.editingProfile=null,this.profileForm.reset(),this.profileForm.patchValue({active_from:new Date,is_active:!0}),this.showForm=!0}editProfile(e){this.editingProfile=e,this.profileForm.patchValue({sector_id:e.sector_id,name:e.name,description:e.description,active_from:new Date(e.active_from),active_to:e.active_to?new Date(e.active_to):null,is_active:e.is_active}),this.showForm=!0}saveProfile(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}let e=this.profileForm.value,a=A(O({},e),{active_from:e.active_from.toISOString(),active_to:e.active_to?e.active_to.toISOString():null});(this.editingProfile?this.pricingProfileService.updatePricingProfile(this.editingProfile.id,a):this.pricingProfileService.createPricingProfile(a)).pipe(y(this._unsubscribeAll)).subscribe({next:d=>{this.snackBar.open(this.editingProfile?"Perfil actualizado exitosamente":"Perfil creado exitosamente","Cerrar",{duration:3e3}),this.showForm=!1,this.loadPricingProfiles()},error:d=>{console.error("Error saving profile:",d),this.snackBar.open("Error al guardar perfil","Cerrar",{duration:3e3})}})}cancelEdit(){this.showForm=!1,this.editingProfile=null,this.profileForm.reset()}deleteProfile(e){let a=e.pricing_rules?.length||0,o=`\xBFEst\xE1 seguro de eliminar el perfil "${e.name}"?`;a>0&&(o+=`

\u26A0\uFE0F Tambi\xE9n se eliminar\xE1n ${a} regla${a>1?"s":""} de precios asociada${a>1?"s":""}.`),this.confirmationService.open({title:"Eliminar Perfil de Precios",message:o,icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Eliminar Todo",color:"warn"},cancel:{show:!0,label:"Cancelar"}}}).afterClosed().subscribe(f=>{f==="confirmed"&&this.pricingProfileService.deletePricingProfile(e.id).pipe(y(this._unsubscribeAll)).subscribe({next:S=>{let b=S.message||"Perfil eliminado exitosamente";this.snackBar.open(b,"Cerrar",{duration:4e3}),this.loadPricingProfiles()},error:S=>{console.error("Error deleting profile:",S),this.snackBar.open("Error al eliminar perfil","Cerrar",{duration:3e3})}})})}toggleProfile(e){this.pricingProfileService.togglePricingProfile(e.id,!e.is_active).pipe(y(this._unsubscribeAll)).subscribe({next:a=>{this.snackBar.open(e.is_active?"Perfil desactivado":"Perfil activado","Cerrar",{duration:3e3}),this.loadPricingProfiles()},error:a=>{console.error("Error toggling profile:",a),this.snackBar.open("Error al cambiar estado del perfil","Cerrar",{duration:3e3})}})}getSectorName(e){let a=this.sectors.find(o=>o.id===e);return a?a.name:"N/A"}formatDate(e){return new Date(e).toLocaleDateString("es-CL")}getStatusLabel(e){return e?"Activo":"Inactivo"}getStatusColor(e){return e?"green":"gray"}getErrorMessage(e){let a=this.profileForm.get(e);return a?.hasError("required")?"Este campo es requerido":a?.hasError("minlength")?`M\xEDnimo ${a.errors?.minlength.requiredLength} caracteres`:""}createRuleForm(){return this.fb.group({name:["",M.required],rule_type:["TIME_BASED",M.required],min_duration_minutes:[0,M.required],max_duration_minutes:[null],daily_max_amount:[null],min_amount:[null],price_per_minute:[0,M.required],fixed_price:[0],start_time:[""],end_time:[""],priority:[1],is_active:[!0]})}manageRules(e){this.selectedProfile=e,this.showRulesModal=!0,this.loadPricingRules(e.id)}closeRulesModal(){this.showRulesModal=!1,this.selectedProfile=null,this.pricingRules=[],this.showRuleForm=!1,this.editingRule=null}loadPricingRules(e){this.pricingProfileService.getPricingRules(e).pipe(y(this._unsubscribeAll)).subscribe({next:a=>{console.log("Respuesta del servicio de reglas:",a),this.pricingRules=a.data||[],console.log("Reglas cargadas:",this.pricingRules)},error:a=>{console.error("Error loading pricing rules:",a),this.snackBar.open("Error al cargar reglas de precios","Cerrar",{duration:3e3})}})}addRule(){this.editingRule=null,this.selectedDays=[],this.ruleForm.reset({name:"",rule_type:"TIME_BASED",min_duration_minutes:0,max_duration_minutes:null,daily_max_amount:null,min_amount:null,price_per_minute:0,fixed_price:0,start_time:"",end_time:"",priority:1,is_active:!0}),this.showRuleForm=!0}editRule(e){console.log("Editando regla:",e),this.editingRule=e,this.selectedDays=e.days_of_week||[];let a="",o="";e.start_min!==void 0&&e.end_min!==void 0?(a=this.minutesToTimeString(e.start_min),o=this.minutesToTimeString(e.end_min)):e.start_time&&e.end_time&&(a=e.start_time,o=e.end_time);let d={name:e.name||"",rule_type:e.rule_type||"TIME_BASED",min_duration_minutes:e.min_duration_minutes||0,max_duration_minutes:e.max_duration_minutes||null,daily_max_amount:e.daily_max_amount||null,min_amount:e.min_amount||null,price_per_minute:e.price_per_minute||e.price_per_min||0,fixed_price:e.fixed_price||0,start_time:a,end_time:o,priority:e.priority||1,is_active:e.is_active!==void 0?e.is_active:!0};console.log("Datos del formulario:",d),this.ruleForm.setValue(d),console.log("Estado del formulario despu\xE9s de setValue:",this.ruleForm.value),console.log("Formulario v\xE1lido:",this.ruleForm.valid),console.log("Campo name:",this.ruleForm.get("name")?.value),console.log("Campo rule_type:",this.ruleForm.get("rule_type")?.value),console.log("Campo start_time:",this.ruleForm.get("start_time")?.value),console.log("Campo end_time:",this.ruleForm.get("end_time")?.value),this.showRuleForm=!0,setTimeout(()=>{console.log("Estado del formulario despu\xE9s de mostrar:",this.ruleForm.value)},100)}minutesToTimeString(e){let a=Math.floor(e/60),o=e%60;return`${a.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}saveRule(){if(this.ruleForm.valid&&this.selectedProfile){let e=this.ruleForm.value.rule_type==="HOURLY"?"TIME_BASED":this.ruleForm.value.rule_type,a={profile_id:this.selectedProfile.id,name:this.ruleForm.value.name,rule_type:e,min_duration_minutes:this.ruleForm.value.min_duration_minutes,max_duration_minutes:this.ruleForm.value.max_duration_minutes,daily_max_amount:this.ruleForm.value.daily_max_amount,min_amount:this.ruleForm.value.min_amount,price_per_minute:this.ruleForm.value.price_per_minute,fixed_price:this.ruleForm.value.fixed_price,days_of_week:this.selectedDays,start_time:this.ruleForm.value.start_time||null,end_time:this.ruleForm.value.end_time||null,priority:this.ruleForm.value.priority,is_active:this.ruleForm.value.is_active};console.log("Datos a enviar al backend:",a),console.log("ID de la regla:",this.editingRule?.id),this.editingRule?this.pricingProfileService.updatePricingRule(this.editingRule.id,a).pipe(y(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla actualizada exitosamente","Cerrar",{duration:3e3}),this.cancelRuleEdit(),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error updating rule:",o),console.error("Error details:",o.error),this.snackBar.open("Error al actualizar regla: "+(o.error?.message||o.message),"Cerrar",{duration:5e3})}}):this.pricingProfileService.createPricingRule(a).pipe(y(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla creada exitosamente","Cerrar",{duration:3e3}),this.cancelRuleEdit(),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error creating rule:",o),this.snackBar.open("Error al crear regla","Cerrar",{duration:3e3})}})}}cancelRuleEdit(){this.showRuleForm=!1,this.editingRule=null,this.selectedDays=[],this.ruleForm.reset()}deleteRule(e){this.confirmationService.open({title:"Eliminar Regla",message:`\xBFEst\xE1s seguro de que quieres eliminar la regla "${e.name}"?`,actions:{confirm:{show:!0,label:"Eliminar",color:"warn"},cancel:{show:!0,label:"Cancelar"}}}).afterClosed().subscribe(a=>{a==="confirmed"&&this.pricingProfileService.deletePricingRule(e.id).pipe(y(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla eliminada exitosamente","Cerrar",{duration:3e3}),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error deleting rule:",o),this.snackBar.open("Error al eliminar regla","Cerrar",{duration:3e3})}})})}toggleRule(e){this.pricingProfileService.togglePricingRule(e.id,!e.is_active).pipe(y(this._unsubscribeAll)).subscribe({next:a=>{this.snackBar.open(e.is_active?"Regla desactivada":"Regla activada","Cerrar",{duration:3e3}),this.loadPricingRules(this.selectedProfile.id)},error:a=>{console.error("Error toggling rule:",a),this.snackBar.open("Error al cambiar estado de la regla","Cerrar",{duration:3e3})}})}onDayChange(e,a){e.checked?this.selectedDays.includes(a)||this.selectedDays.push(a):this.selectedDays=this.selectedDays.filter(o=>o!==a)}isDaySelected(e){return this.selectedDays.includes(e)}getRuleTypeLabel(e){return{TIME_BASED:"Por Tiempo",FIXED:"Precio Fijo",GRADUATED:"Graduada",HOURLY:"Por Hora"}[e]||e}getDaysLabel(e){if(!e||e.length===0)return"Todos";let a=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];return e.map(o=>a[o]).join(", ")}getRuleTypeColor(e){return{TIME_BASED:"blue",FIXED:"green",GRADUATED:"purple",HOURLY:"blue"}[e]||"gray"}formatTimeRange(e,a){if(!e||!a)return"Todo el d\xEDa";try{let o=new Date(e),d=new Date(a),f=o.toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"})+" "+o.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit",hour12:!1}),S=d.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${f} - ${S}`}catch(o){return console.error("Error formatting time range:",o),"Todo el d\xEDa"}}getActiveProfilesCount(){return this.pricingProfiles.filter(e=>e.is_active).length}getInactiveProfilesCount(){return this.pricingProfiles.filter(e=>!e.is_active).length}getTotalRulesCount(){return this.pricingProfiles.reduce((e,a)=>e+(a.pricing_rules?.length||0),0)}getTimeValue(e){if(!e||e===""||e===null||e==="00:00")return"";if(typeof e=="string"&&/^\d{2}:\d{2}$/.test(e)&&e!=="00:00")return e;if(e instanceof Date){let a=e.toTimeString().slice(0,5);return a==="00:00"?"":a}return""}onTimeChange(e,a){let o=a.target.value;o===""||o===null||o==="00:00"?this.ruleForm.get(e)?.setValue(""):this.ruleForm.get(e)?.setValue(o)}static{this.\u0275fac=function(a){return new(a||i)(T(rt),T(nt),T(Ee),T(Qe),T(X),T(me))}}static{this.\u0275cmp=j({type:i,selectors:[["app-pricing-profiles"]],decls:97,vars:20,consts:[["actionMenu","matMenu"],["activeFromPicker",""],["activeToPicker",""],["ruleActionMenu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-6"],[1,"p-6"],[1,"flex","items-center"],[1,"p-3","bg-blue-100","rounded-full"],[1,"text-blue-600"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"p-3","bg-green-100","rounded-full"],[1,"text-green-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"p-3","bg-gray-100","rounded-full"],[1,"text-2xl","font-bold","text-gray-600"],[1,"p-3","bg-purple-100","rounded-full"],[1,"text-purple-600"],[1,"text-2xl","font-bold","text-purple-600"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["appearance","outline"],["matInput","","placeholder","Nombre del perfil",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","justify-end","gap-2","mt-4"],["mat-stroked-button","",1,"rounded-sm",3,"click"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","mb-6",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","","class","mt-4",3,"length","pageSize","pageSizeOptions","pageIndex","page",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","modal-overlay bg-black bg-opacity-50 flex items-center justify-center",4,"ngIf"],["class","modal-overlay bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4",4,"ngIf"],[1,"flex","justify-center","items-center","h-64"],["diameter","50"],["type","error",3,"dismissible"],[1,"p-0"],[1,"overflow-x-auto"],["mat-table","",1,"w-full","mat-elevation-z2",2,"width","100%","table-layout","fixed",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sector"],["mat-header-cell","","style","width: 15%;",4,"matHeaderCellDef"],["matColumnDef","active_from"],["matColumnDef","active_to"],["matColumnDef","status"],["mat-header-cell","","style","width: 10%;",4,"matHeaderCellDef"],["matColumnDef","rules_count"],["matColumnDef","actions"],["mat-header-cell","","class","text-right","style","width: 15%;",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","20%"],["mat-cell",""],[1,"font-medium","text-gray-900"],["class","text-sm text-gray-600",4,"ngIf"],[1,"text-sm","text-gray-600"],["mat-header-cell","",2,"width","15%"],["mat-header-cell","",2,"width","10%"],[1,"px-2","py-1","rounded","text-xs","font-medium"],["mat-header-cell","",1,"text-right",2,"width","15%"],["mat-cell","",1,"text-right"],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""],["showFirstLastButtons","",1,"mt-4",3,"page","length","pageSize","pageSizeOptions","pageIndex"],[1,"text-center","py-12"],[1,"text-6xl","text-gray-400","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],[1,"modal-overlay","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-2xl","mx-4","max-h-screen","overflow-y-auto"],[1,"text-xl","font-semibold","text-gray-900","mb-4"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],["formControlName","sector_id"],["matInput","","formControlName","name","placeholder","Nombre del perfil"],["matInput","","formControlName","active_from",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","active_to",3,"matDatepicker"],["appearance","outline",1,"w-full","mb-4"],["matInput","","formControlName","description","rows","3","placeholder","Descripci\xF3n del perfil"],["formControlName","is_active"],[1,"flex","justify-end","gap-3"],["type","button","mat-stroked-button","",1,"rounded-sm",3,"click"],["type","submit","mat-raised-button","","color","primary",1,"rounded-sm",3,"disabled"],[1,"modal-overlay","bg-black","bg-opacity-50","flex","items-center","justify-center","p-2","sm:p-4"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-[95vw]","sm:max-w-[90vw]","md:max-w-[85vw]","lg:max-w-[80vw]","xl:max-w-[75vw]","max-h-[95vh]","flex","flex-col"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","bg-gray-50","rounded-t-lg"],[1,"flex","items-center","gap-3"],[1,"text-xl","font-semibold","text-gray-900"],["mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"flex-1","overflow-hidden","flex","flex-col"],[1,"p-6","border-b","border-gray-200","bg-white"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["mat-raised-button","","color","primary",3,"click"],[1,"flex-1","overflow-auto","p-2","sm:p-4","lg:p-6"],[1,"bg-white","rounded-lg","border","border-gray-200","overflow-hidden"],[1,"hidden","md:block"],["mat-table","",1,"w-full",3,"dataSource"],["mat-header-cell","","class","font-semibold text-gray-700",4,"matHeaderCellDef"],["mat-cell","","class","py-4",4,"matCellDef"],["matColumnDef","rule_type"],["matColumnDef","duration"],["matColumnDef","price"],["matColumnDef","days"],["matColumnDef","time"],["mat-header-cell","","class","font-semibold text-gray-700 text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right py-4",4,"matCellDef"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50",4,"matRowDef","matRowDefColumns"],[1,"md:hidden"],["class","border-b border-gray-200 p-4 last:border-b-0",4,"ngFor","ngForOf"],[1,"p-6","border-t","border-gray-200","bg-gray-50","rounded-b-lg"],[1,"flex","justify-end"],["mat-button","",1,"mr-3",3,"click"],["mat-header-cell","",1,"font-semibold","text-gray-700"],["mat-cell","",1,"py-4"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],["class","text-green-600 font-medium",4,"ngIf"],["class","text-blue-600 font-medium",4,"ngIf"],[1,"text-green-600","font-medium"],[1,"text-blue-600","font-medium"],[1,"text-sm","font-medium","text-gray-900"],["class","text-green-600",4,"ngIf"],["class","text-blue-600",4,"ngIf"],["mat-header-cell","",1,"font-semibold","text-gray-700","text-right"],["mat-cell","",1,"text-right","py-4"],["mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"matMenuTriggerFor"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50"],[1,"border-b","border-gray-200","p-4","last:border-b-0"],[1,"flex","items-start","justify-between","mb-3"],[1,"flex-1"],[1,"font-medium","text-gray-900","text-sm"],[1,"flex","items-center","gap-2","mt-1"],["mat-icon-button","",1,"text-gray-500",3,"matMenuTriggerFor"],[1,"grid","grid-cols-2","gap-3","text-xs","text-gray-600"],[1,"font-medium"],[1,"text-gray-600","mb-6"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-4xl","mx-4","max-h-screen","overflow-y-auto"],["matInput","","formControlName","name","placeholder","Ej: Tarifa est\xE1ndar"],["formControlName","rule_type"],["value","TIME_BASED"],["value","FIXED"],["value","GRADUATED"],["value","HOURLY"],["matInput","","formControlName","min_duration_minutes","type","number","min","0"],["matInput","","formControlName","max_duration_minutes","type","number","min","0"],["matInput","","formControlName","daily_max_amount","type","number","min","0","step","0.01"],["matPrefix",""],["matInput","","formControlName","min_amount","type","number","min","0","step","0.01"],["appearance","outline",4,"ngIf"],["matInput","","formControlName","start_time","type","time",3,"change","value"],["matInput","","formControlName","end_time","type","time",3,"change","value"],[1,"mb-4"],[1,"text-sm","font-medium","text-gray-700","mb-2","block"],[1,"flex","flex-wrap","gap-2"],[3,"value","checked","change",4,"ngFor","ngForOf"],["matInput","","formControlName","priority","type","number","min","1","value","1"],["matInput","","formControlName","price_per_minute","type","number","min","0","step","0.01"],["matInput","","formControlName","fixed_price","type","number","min","0","step","0.01"],[3,"change","value","checked"]],template:function(a,o){a&1&&(n(0,"div",4)(1,"div",5)(2,"div")(3,"h1",6),r(4,"Perfiles de Precios"),t(),n(5,"p",7),r(6,"Gestiona los perfiles de precios por sector"),t()(),n(7,"button",8),_("click",function(){return o.createProfile()}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Nuevo Perfil "),t()(),n(11,"div",9)(12,"mat-card")(13,"mat-card-content",10)(14,"div",11)(15,"div",12)(16,"mat-icon",13),r(17,"price_check"),t()(),n(18,"div",14)(19,"p",15),r(20,"Total Perfiles"),t(),n(21,"p",16),r(22),t()()()()(),n(23,"mat-card")(24,"mat-card-content",10)(25,"div",11)(26,"div",17)(27,"mat-icon",18),r(28,"check_circle"),t()(),n(29,"div",14)(30,"p",15),r(31,"Activos"),t(),n(32,"p",19),r(33),t()()()()(),n(34,"mat-card")(35,"mat-card-content",10)(36,"div",11)(37,"div",20)(38,"mat-icon",7),r(39,"pause_circle"),t()(),n(40,"div",14)(41,"p",15),r(42,"Inactivos"),t(),n(43,"p",21),r(44),t()()()()(),n(45,"mat-card")(46,"mat-card-content",10)(47,"div",11)(48,"div",22)(49,"mat-icon",23),r(50,"rule"),t()(),n(51,"div",14)(52,"p",15),r(53,"Total Reglas"),t(),n(54,"p",24),r(55),t()()()()()(),n(56,"mat-card",25)(57,"mat-card-content",10)(58,"div",26)(59,"mat-form-field",27)(60,"mat-label"),r(61,"Buscar por Nombre"),t(),n(62,"input",28),$("ngModelChange",function(f){return k(o.filters.name,f)||(o.filters.name=f),f}),t()(),n(63,"mat-form-field",27)(64,"mat-label"),r(65,"Sector"),t(),n(66,"mat-select",29),$("ngModelChange",function(f){return k(o.filters.sector_id,f)||(o.filters.sector_id=f),f}),n(67,"mat-option",30),r(68,"Todos"),t(),p(69,lt,2,2,"mat-option",31),t()(),n(70,"mat-form-field",27)(71,"mat-label"),r(72,"Estado"),t(),n(73,"mat-select",29),$("ngModelChange",function(f){return k(o.filters.is_active,f)||(o.filters.is_active=f),f}),n(74,"mat-option",30),r(75,"Todos"),t(),n(76,"mat-option",30),r(77,"Activo"),t(),n(78,"mat-option",30),r(79,"Inactivo"),t()()()(),n(80,"div",32)(81,"button",33),_("click",function(){return o.clearFilters()}),n(82,"mat-icon"),r(83,"clear"),t(),r(84," Limpiar "),t(),n(85,"button",8),_("click",function(){return o.applyFilters()}),n(86,"mat-icon"),r(87,"search"),t(),r(88," Filtrar "),t()()()(),p(89,mt,2,0,"div",34)(90,ct,3,2,"div",35)(91,Mt,27,3,"mat-card",36)(92,Tt,1,4,"mat-paginator",37)(93,It,11,0,"div",38),t(),p(94,Vt,45,13,"div",39)(95,si,61,9,"div",40)(96,hi,86,12,"div",39)),a&2&&(l(22),h(o.pricingProfiles.length),l(11),h(o.getActiveProfilesCount()),l(11),h(o.getInactiveProfilesCount()),l(11),h(o.getTotalRulesCount()),l(7),F("ngModel",o.filters.name),l(4),F("ngModel",o.filters.sector_id),l(),c("value",void 0),l(2),c("ngForOf",o.sectors),l(4),F("ngModel",o.filters.is_active),l(),c("value",void 0),l(2),c("value",!0),l(2),c("value",!1),l(11),c("ngIf",o.loading),l(),c("ngIf",o.error),l(),c("ngIf",!o.loading),l(),c("ngIf",!o.loading&&o.pricingProfiles.length>0),l(),c("ngIf",!o.loading&&o.pricingProfiles.length===0),l(),c("ngIf",o.showForm),l(),c("ngIf",o.showRulesModal),l(),c("ngIf",o.showRuleForm))},dependencies:[q,U,z,Se,xe,ue,ve,_e,fe,Ce,he,Pe,be,ge,ae,ne,re,le,oe,it,et,tt,We,Ae,Be,Ue,Le,Ne,ze,je,He,qe,Ge,ie,te,J,Q,K,Z,ee,we,ye,Oe,Ve,Y,Te,Me,Ze,Xe,Ye,Je,Ke,pe,se,ce,de,$e,Re,Fe,ke,De,Ie],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed!important;inset:0 0 0 280px!important;z-index:250!important}@media (max-width: 768px){.modal-overlay[_ngcontent-%COMP%]{left:0!important}}.rules-modal[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden}.rules-modal[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{background-color:#f9fafb}.rules-modal[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.rules-modal[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .rules-modal[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{padding:16px 12px}.rule-form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.rule-form[_ngcontent-%COMP%]   .days-selector[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}.rule-form[_ngcontent-%COMP%]   .day-chip[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.rule-form[_ngcontent-%COMP%]   .day-chip.selected[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.rule-form[_ngcontent-%COMP%]   .day-chip[_ngcontent-%COMP%]:hover{background-color:#e5e7eb}@media (max-width: 768px){.rules-modal[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{font-size:14px}.rules-modal[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .rules-modal[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{padding:12px 8px}}"]})}}return i})();export{ln as PricingProfilesComponent};
