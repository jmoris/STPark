import{a as l}from"./chunk-VKB6BRO6.js";import{d as g}from"./chunk-FDUGCV2L.js";import{B as c,_ as m,ea as f,g as r,l as o,p as s}from"./chunk-QDWFRTQW.js";import{a as i}from"./chunk-TSRGIXR5.js";var v=(()=>{class n{constructor(){this._httpClient=f(g),this._systemConfig=new r({name:"STPark - Sistema de Gesti\xF3n de Estacionamientos",currency:"CLP",timezone:"America/Santiago",language:"es",pos_tuu:!1,boleta_electronica:!1,max_capacity:0,car_wash_enabled:!1,car_wash_payment_deferred:!1}),this._configLoaded=!1}loadConfig(){let t={name:"STPark - Sistema de Gesti\xF3n de Estacionamientos",currency:"CLP",timezone:"America/Santiago",language:"es",pos_tuu:!1,boleta_electronica:!1,max_capacity:0,car_wash_enabled:!1,car_wash_payment_deferred:!1};return this._httpClient.get(`${l.apiUrl}/settings/general`).pipe(s(a=>{let e;a&&a.success&&a.data?(e=i(i({},t),a.data),(!e.name||e.name.trim()==="")&&(e.name=t.name)):e=t,this._systemConfig.next(e),this._configLoaded=!0;try{sessionStorage.setItem("system_config",JSON.stringify(e)),console.log("ConfigService: Configuraci\xF3n guardada en sessionStorage:",{name:e.name,car_wash_enabled:e.car_wash_enabled})}catch(u){console.warn("ConfigService: No se pudo guardar en sessionStorage:",u)}return e}),c(a=>{console.error("ConfigService: Error al cargar configuraci\xF3n:",a),this._systemConfig.next(t),this._configLoaded=!0;try{sessionStorage.setItem("system_config",JSON.stringify(t))}catch{}return o(t)}))}refreshConfig(){this.loadConfig().subscribe()}isConfigLoaded(){return this._configLoaded}get systemConfig$(){return this._systemConfig.asObservable()}getSystemConfig(){return this._systemConfig.value}getSystemName(){return this._systemConfig.value.name}getSystemName$(){return this._systemConfig.asObservable().pipe(s(t=>t.name))}getCurrency(){return this._systemConfig.value.currency}getTimezone(){return this._systemConfig.value.timezone}getLanguage(){return this._systemConfig.value.language}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275prov=m({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{v as a};
