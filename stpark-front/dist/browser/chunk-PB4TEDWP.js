import{a as ot}from"./chunk-7M455HP6.js";import{a as Oe,b as Ne,c as Be,d as Le}from"./chunk-EEUJEGPN.js";import{a as at}from"./chunk-ZMFSOZJA.js";import{c as nt}from"./chunk-ICPS6N2F.js";import{a as Ke,b as Ze,c as et,d as R,e as tt,f as it,g as rt}from"./chunk-TU7IT4N6.js";import{a as He,b as je,c as qe,d as ze,e as Ge,f as We,g as Ue,h as Xe,i as Ye,j as Qe,k as Je}from"./chunk-Y6UNS2UZ.js";import{a as Ve,c as $e,f as Ae}from"./chunk-N7KP3IEB.js";import"./chunk-2LVKS4R7.js";import{a as Ie,b as Te}from"./chunk-FSRW5HPF.js";import{a as me,b as se,c as ce,d as de}from"./chunk-IDWAZBHT.js";import"./chunk-FSA3IEFI.js";import{a as De,b as Fe}from"./chunk-POSCZER2.js";import{g as le}from"./chunk-G2G2ZAA3.js";import{c as X}from"./chunk-65NYBKEE.js";import"./chunk-ECYJLMJT.js";import"./chunk-VKB6BRO6.js";import{a as ke,b as Re}from"./chunk-RDXEG6SZ.js";import{b as ae,c as oe}from"./chunk-IMRKXFOQ.js";import{d as Se,e as ye}from"./chunk-5Q7CCL6V.js";import{b as Y,c as Q,d as J,e as K,f as Z,j as ee,k as te}from"./chunk-K3BNOLHS.js";import{a as we,b as Me}from"./chunk-CWSZZ2DY.js";import{A as be,b as _e,d as w,f as ue,g as pe,j as fe,k as ge,l as xe,n as ve,q as he,u as Pe,x as Ce,z as Ee}from"./chunk-ZTFUS4RN.js";import{fa as U,la as ie,na as ne,oa as re}from"./chunk-QQQ5XT6I.js";import"./chunk-YXFY4UXK.js";import"./chunk-EARUC3FY.js";import{l as z,m as G,s as W}from"./chunk-BAM5RHC5.js";import{$b as f,Eb as c,Ib as I,Pb as n,Qb as t,Rb as g,Sb as C,Tb as E,U as b,Vb as y,bb as l,bc as d,cb as M,f as O,fc as B,gc as L,hc as H,lc as T,mc as r,nc as P,oa as v,oc as u,pa as h,pb as N,pc as V,qc as j,rc as D,sc as F,tc as k,uc as q,wb as _}from"./chunk-MLNNMN4J.js";import{a as $,b as A}from"./chunk-TSRGIXR5.js";function lt(i,m){if(i&1&&(n(0,"mat-option",30),r(1),t()),i&2){let e=m.$implicit;c("value",e.id),l(),u(" ",e.name," ")}}function mt(i,m){i&1&&(n(0,"div",41),g(1,"mat-spinner",42),t())}function st(i,m){if(i&1&&(n(0,"div",25)(1,"fuse-alert",43),r(2),t()()),i&2){let e=d();l(),c("dismissible",!0),l(),u(" ",e.error," ")}}function ct(i,m){i&1&&(n(0,"th",65),r(1,"Nombre"),t())}function dt(i,m){if(i&1&&(n(0,"div",69),r(1),t()),i&2){let e=d().$implicit;l(),P(e.description)}}function _t(i,m){if(i&1&&(n(0,"td",66)(1,"div",67),r(2),t(),_(3,dt,2,1,"div",68),t()),i&2){let e=m.$implicit;l(2),P(e.name),l(),c("ngIf",e.description)}}function ut(i,m){i&1&&(n(0,"th",70),r(1,"Sector"),t())}function pt(i,m){if(i&1&&(n(0,"td",66)(1,"div",69),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),P(a.getSectorName(e.sector_id))}}function ft(i,m){i&1&&(n(0,"th",71),r(1,"Vigente Desde"),t())}function gt(i,m){if(i&1&&(n(0,"td",66)(1,"div",69),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),P(a.formatDate(e.active_from))}}function xt(i,m){i&1&&(n(0,"th",72),r(1,"Vigente Hasta"),t())}function vt(i,m){if(i&1&&(n(0,"td",66)(1,"div",69),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),P(e.active_to?a.formatDate(e.active_to):"Indefinido")}}function ht(i,m){i&1&&(n(0,"th",73),r(1,"Estado"),t())}function Pt(i,m){if(i&1&&(n(0,"td",66)(1,"span",74),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(),I("bg-"+a.getStatusColor(e.is_active)+"-100 text-"+a.getStatusColor(e.is_active)+"-800"),l(),u(" ",a.getStatusLabel(e.is_active)," ")}}function Ct(i,m){i&1&&(n(0,"th",75),r(1,"Reglas"),t())}function Et(i,m){if(i&1&&(n(0,"td",66)(1,"div",69),r(2),t()()),i&2){let e=m.$implicit;l(2),P((e.pricing_rules==null?null:e.pricing_rules.length)||0)}}function bt(i,m){i&1&&(n(0,"th",76),r(1,"Acciones"),t())}function St(i,m){if(i&1){let e=y();n(0,"td",77)(1,"button",78)(2,"mat-icon"),r(3,"more_vert"),t()(),n(4,"mat-menu",null,0)(6,"button",79),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.manageRules(o))}),n(7,"mat-icon"),r(8,"rule"),t(),r(9," Gestionar Reglas "),t(),n(10,"button",79),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.editProfile(o))}),n(11,"mat-icon"),r(12,"edit"),t(),r(13," Editar Perfil "),t(),n(14,"button",79),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.toggleProfile(o))}),n(15,"mat-icon"),r(16),t(),r(17),t(),n(18,"button",80),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.deleteProfile(o))}),n(19,"mat-icon"),r(20,"delete"),t(),r(21," Eliminar "),t()()()}if(i&2){let e=m.$implicit,a=T(5);l(),c("matMenuTriggerFor",a),l(15),P(e.is_active?"pause":"play_arrow"),l(),u(" ",e.is_active?"Desactivar":"Activar"," ")}}function yt(i,m){i&1&&g(0,"tr",81)}function wt(i,m){i&1&&g(0,"tr",82)}function Mt(i,m){if(i&1&&(n(0,"mat-card")(1,"mat-card-content",44)(2,"div",45)(3,"table",46),C(4,47),_(5,ct,2,0,"th",48)(6,_t,4,2,"td",49),E(),C(7,50),_(8,ut,2,0,"th",51)(9,pt,3,1,"td",49),E(),C(10,52),_(11,ft,2,0,"th",53)(12,gt,3,1,"td",49),E(),C(13,54),_(14,xt,2,0,"th",55)(15,vt,3,1,"td",49),E(),C(16,56),_(17,ht,2,0,"th",57)(18,Pt,3,3,"td",49),E(),C(19,58),_(20,Ct,2,0,"th",59)(21,Et,3,1,"td",49),E(),C(22,60),_(23,bt,2,0,"th",61)(24,St,22,3,"td",62),E(),_(25,yt,1,0,"tr",63)(26,wt,1,0,"tr",64),t()()()()),i&2){let e=d();l(3),c("dataSource",e.pricingProfiles)("matSortActive",e.sortBy)("matSortDirection",e.sortOrder),l(22),c("matHeaderRowDef",e.displayedColumns),l(),c("matRowDefColumns",e.displayedColumns)}}function It(i,m){if(i&1){let e=y();n(0,"mat-paginator",83),f("page",function(o){v(e);let s=d();return h(s.onPageChange(o))}),t()}if(i&2){let e=d();c("length",e.totalItems)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("pageIndex",e.currentPage)}}function Tt(i,m){if(i&1){let e=y();n(0,"div",84)(1,"mat-icon",85),r(2,"price_check"),t(),n(3,"h3",86),r(4,"No hay perfiles de precios"),t(),n(5,"p",87),r(6,"No se encontraron perfiles de precios con los filtros aplicados."),t(),n(7,"button",8),f("click",function(){v(e);let o=d();return h(o.createProfile())}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Crear Nuevo Perfil "),t()()}}function Dt(i,m){if(i&1&&(n(0,"mat-option",30),r(1),t()),i&2){let e=m.$implicit;c("value",e.id),l(),u(" ",e.name," ")}}function Ft(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),u(" ",e.getErrorMessage("sector_id")," ")}}function kt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),u(" ",e.getErrorMessage("name")," ")}}function Rt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),u(" ",e.getErrorMessage("name")," ")}}function Vt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),u(" ",e.getErrorMessage("active_from")," ")}}function $t(i,m){if(i&1){let e=y();n(0,"div",88)(1,"div",89)(2,"h2",90),r(3),t(),n(4,"form",91),f("ngSubmit",function(){v(e);let o=d();return h(o.saveProfile())}),n(5,"div",92)(6,"mat-form-field",27)(7,"mat-label"),r(8,"Sector"),t(),n(9,"mat-select",93),_(10,Dt,2,2,"mat-option",31),t(),_(11,Ft,2,1,"mat-error",36),t(),n(12,"mat-form-field",27)(13,"mat-label"),r(14,"Nombre"),t(),g(15,"input",94),_(16,kt,2,1,"mat-error",36)(17,Rt,2,1,"mat-error",36),t(),n(18,"mat-form-field",27)(19,"mat-label"),r(20,"Vigente Desde"),t(),g(21,"input",95)(22,"mat-datepicker-toggle",96)(23,"mat-datepicker",null,1),_(25,Vt,2,1,"mat-error",36),t(),n(26,"mat-form-field",27)(27,"mat-label"),r(28,"Vigente Hasta (Opcional)"),t(),g(29,"input",97)(30,"mat-datepicker-toggle",96)(31,"mat-datepicker",null,2),t()(),n(33,"mat-form-field",98)(34,"mat-label"),r(35,"Descripci\xF3n"),t(),g(36,"textarea",99),t(),n(37,"div",25)(38,"mat-checkbox",100),r(39," Perfil activo "),t()(),n(40,"div",101)(41,"button",102),f("click",function(){v(e);let o=d();return h(o.cancelEdit())}),r(42," Cancelar "),t(),n(43,"button",103),r(44),t()()()()()}if(i&2){let e,a,o,s,p=T(24),x=T(32),S=d();l(3),u(" ",S.editingProfile?"Editar Perfil de Precios":"Nuevo Perfil de Precios"," "),l(),c("formGroup",S.profileForm),l(6),c("ngForOf",S.sectors),l(),c("ngIf",(e=S.profileForm.get("sector_id"))==null?null:e.hasError("required")),l(5),c("ngIf",(a=S.profileForm.get("name"))==null?null:a.hasError("required")),l(),c("ngIf",(o=S.profileForm.get("name"))==null?null:o.hasError("minlength")),l(4),c("matDatepicker",p),l(),c("for",p),l(3),c("ngIf",(s=S.profileForm.get("active_from"))==null?null:s.hasError("required")),l(4),c("matDatepicker",x),l(),c("for",x),l(13),c("disabled",S.profileForm.invalid),l(),u(" ",S.editingProfile?"Actualizar":"Crear"," Perfil ")}}function At(i,m){i&1&&(n(0,"th",135),r(1,"Nombre"),t())}function Ot(i,m){if(i&1&&(n(0,"td",136)(1,"div",67),r(2),t()()),i&2){let e=m.$implicit;l(2),P(e.name)}}function Nt(i,m){i&1&&(n(0,"th",135),r(1,"Tipo"),t())}function Bt(i,m){if(i&1&&(n(0,"td",136)(1,"span",137),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(),I("bg-"+a.getRuleTypeColor(e.rule_type)+"-100 text-"+a.getRuleTypeColor(e.rule_type)+"-800"),l(),u(" ",a.getRuleTypeLabel(e.rule_type)," ")}}function Lt(i,m){i&1&&(n(0,"th",135),r(1,"Duraci\xF3n"),t())}function Ht(i,m){if(i&1&&(n(0,"div",140),r(1),t()),i&2){let e=d().$implicit;l(),u(" M\xEDn: $",e.min_amount," ")}}function jt(i,m){if(i&1&&(n(0,"div",141),r(1),t()),i&2){let e=d().$implicit;l(),u(" M\xE1x: $",e.daily_max_amount," ")}}function qt(i,m){if(i&1&&(n(0,"td",136)(1,"div",69)(2,"div"),r(3),t(),_(4,Ht,2,1,"div",138)(5,jt,2,1,"div",139),t()()),i&2){let e=m.$implicit;l(3),V("",e.min_duration_minutes,"-",e.max_duration_minutes||"\u221E"," min"),l(),c("ngIf",e.min_amount),l(),c("ngIf",e.daily_max_amount)}}function zt(i,m){i&1&&(n(0,"th",135),r(1,"Precio"),t())}function Gt(i,m){if(i&1&&(n(0,"span",18),r(1),t()),i&2){let e=d().$implicit;l(),u("$",e.fixed_price,"")}}function Wt(i,m){if(i&1&&(n(0,"span",13),r(1),t()),i&2){let e=d().$implicit;l(),u("$",e.price_per_min,"/min")}}function Ut(i,m){if(i&1&&(n(0,"td",136)(1,"div",142),_(2,Gt,2,1,"span",143)(3,Wt,2,1,"span",144),t()()),i&2){let e=m.$implicit;l(2),c("ngIf",e.fixed_price),l(),c("ngIf",e.price_per_min)}}function Xt(i,m){i&1&&(n(0,"th",135),r(1,"D\xEDas"),t())}function Yt(i,m){if(i&1&&(n(0,"td",136)(1,"div",69),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),u(" ",a.getDaysLabel(e.days_of_week)," ")}}function Qt(i,m){i&1&&(n(0,"th",135),r(1,"Horario"),t())}function Jt(i,m){if(i&1&&(n(0,"td",136)(1,"div",69),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),u(" ",a.formatTimeRange(e.start_time,e.end_time)," ")}}function Kt(i,m){i&1&&(n(0,"th",135),r(1,"Estado"),t())}function Zt(i,m){if(i&1&&(n(0,"td",136)(1,"span",137),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(),I("bg-"+a.getStatusColor(e.is_active)+"-100 text-"+a.getStatusColor(e.is_active)+"-800"),l(),u(" ",a.getStatusLabel(e.is_active)," ")}}function ei(i,m){i&1&&(n(0,"th",145),r(1,"Acciones"),t())}function ti(i,m){if(i&1){let e=y();n(0,"td",146)(1,"button",147)(2,"mat-icon"),r(3,"more_vert"),t()(),n(4,"mat-menu",null,3)(6,"button",79),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.editRule(o))}),n(7,"mat-icon"),r(8,"edit"),t(),r(9," Editar "),t(),n(10,"button",79),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.toggleRule(o))}),n(11,"mat-icon"),r(12),t(),r(13),t(),n(14,"button",80),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.deleteRule(o))}),n(15,"mat-icon"),r(16,"delete"),t(),r(17," Eliminar "),t()()()}if(i&2){let e=m.$implicit,a=T(5);l(),c("matMenuTriggerFor",a),l(11),P(e.is_active?"pause":"play_arrow"),l(),u(" ",e.is_active?"Desactivar":"Activar"," ")}}function ii(i,m){i&1&&g(0,"tr",148)}function ni(i,m){i&1&&g(0,"tr",149)}function ri(i,m){if(i&1&&(n(0,"div",140),r(1),t()),i&2){let e=d().$implicit;l(),u(" M\xEDn: $",e.min_amount," ")}}function ai(i,m){if(i&1&&(n(0,"div",141),r(1),t()),i&2){let e=d().$implicit;l(),u(" M\xE1x: $",e.daily_max_amount," ")}}function oi(i,m){if(i&1&&(n(0,"span",140),r(1),t()),i&2){let e=d().$implicit;l(),u("$",e.fixed_price,"")}}function li(i,m){if(i&1&&(n(0,"span",141),r(1),t()),i&2){let e=d().$implicit;l(),u("$",e.price_per_min,"/min")}}function mi(i,m){if(i&1){let e=y();n(0,"div",150)(1,"div",151)(2,"div",152)(3,"h3",153),r(4),t(),n(5,"div",154)(6,"span",137),r(7),t(),n(8,"span",137),r(9),t()()(),n(10,"button",155)(11,"mat-icon"),r(12,"more_vert"),t()(),n(13,"mat-menu",null,3)(15,"button",79),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.editRule(o))}),n(16,"mat-icon"),r(17,"edit"),t(),r(18," Editar "),t(),n(19,"button",79),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.toggleRule(o))}),n(20,"mat-icon"),r(21),t(),r(22),t(),n(23,"button",80),f("click",function(){let o=v(e).$implicit,s=d(2);return h(s.deleteRule(o))}),n(24,"mat-icon"),r(25,"delete"),t(),r(26," Eliminar "),t()()(),n(27,"div",156)(28,"div")(29,"span",157),r(30,"Duraci\xF3n:"),t(),g(31,"br"),r(32),_(33,ri,2,1,"div",138)(34,ai,2,1,"div",139),t(),n(35,"div")(36,"span",157),r(37,"Precio:"),t(),g(38,"br"),_(39,oi,2,1,"span",138)(40,li,2,1,"span",139),t(),n(41,"div")(42,"span",157),r(43,"D\xEDas:"),t(),g(44,"br"),r(45),t(),n(46,"div")(47,"span",157),r(48,"Horario:"),t(),g(49,"br"),r(50),t()()()}if(i&2){let e=m.$implicit,a=T(14),o=d(2);l(4),P(e.name),l(2),I("bg-"+o.getRuleTypeColor(e.rule_type)+"-100 text-"+o.getRuleTypeColor(e.rule_type)+"-800"),l(),u(" ",o.getRuleTypeLabel(e.rule_type)," "),l(),I("bg-"+o.getStatusColor(e.is_active)+"-100 text-"+o.getStatusColor(e.is_active)+"-800"),l(),u(" ",o.getStatusLabel(e.is_active)," "),l(),c("matMenuTriggerFor",a),l(11),P(e.is_active?"pause":"play_arrow"),l(),u(" ",e.is_active?"Desactivar":"Activar"," "),l(10),V(" ",e.min_duration_minutes,"-",e.max_duration_minutes||"\u221E"," min "),l(),c("ngIf",e.min_amount),l(),c("ngIf",e.daily_max_amount),l(5),c("ngIf",e.fixed_price),l(),c("ngIf",e.price_per_min),l(5),u(" ",o.getDaysLabel(e.days_of_week)," "),l(5),u(" ",o.formatTimeRange(e.start_time,e.end_time)," ")}}function si(i,m){if(i&1){let e=y();n(0,"div",84)(1,"mat-icon",85),r(2,"rule"),t(),n(3,"h3",86),r(4,"No hay reglas de precios"),t(),n(5,"p",158),r(6,"Este perfil no tiene reglas de precios configuradas."),t(),n(7,"button",114),f("click",function(){v(e);let o=d(2);return h(o.addRule())}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Crear Primera Regla "),t()()}}function ci(i,m){if(i&1){let e=y();n(0,"div",104)(1,"div",105)(2,"div",106)(3,"div",107)(4,"mat-icon",13),r(5,"price_check"),t(),n(6,"div")(7,"h2",108),r(8," Gestionar Reglas de Precios "),t(),n(9,"p",69),r(10),t()()(),n(11,"button",109),f("click",function(){v(e);let o=d();return h(o.closeRulesModal())}),n(12,"mat-icon"),r(13,"close"),t()()(),n(14,"div",110)(15,"div",111)(16,"div",112)(17,"div",113)(18,"button",114),f("click",function(){v(e);let o=d();return h(o.addRule())}),n(19,"mat-icon"),r(20,"add"),t(),r(21," Nueva Regla "),t(),n(22,"span",69),r(23),t()()()(),n(24,"div",115)(25,"div",116)(26,"div",117)(27,"table",118),C(28,47),_(29,At,2,0,"th",119)(30,Ot,3,1,"td",120),E(),C(31,121),_(32,Nt,2,0,"th",119)(33,Bt,3,3,"td",120),E(),C(34,122),_(35,Lt,2,0,"th",119)(36,qt,6,4,"td",120),E(),C(37,123),_(38,zt,2,0,"th",119)(39,Ut,4,2,"td",120),E(),C(40,124),_(41,Xt,2,0,"th",119)(42,Yt,3,1,"td",120),E(),C(43,125),_(44,Qt,2,0,"th",119)(45,Jt,3,1,"td",120),E(),C(46,56),_(47,Kt,2,0,"th",119)(48,Zt,3,3,"td",120),E(),C(49,60),_(50,ei,2,0,"th",126)(51,ti,18,3,"td",127),E(),_(52,ii,1,0,"tr",128)(53,ni,1,0,"tr",129),t()(),n(54,"div",130),_(55,mi,51,18,"div",131),t()()(),n(56,"div",132)(57,"div",133)(58,"button",134),f("click",function(){v(e);let o=d();return h(o.closeRulesModal())}),r(59," Cerrar "),t()(),_(60,si,11,0,"div",38),t()()()()}if(i&2){let e=d();l(10),P(e.selectedProfile==null?null:e.selectedProfile.name),l(13),j(" ",e.pricingRules.length," regla",e.pricingRules.length!==1?"s":""," configurada",e.pricingRules.length!==1?"s":""," "),l(4),c("dataSource",e.pricingRules),l(25),c("matHeaderRowDef",e.ruleColumns),l(),c("matRowDefColumns",e.ruleColumns),l(2),c("ngForOf",e.pricingRules),l(5),c("ngIf",e.pricingRules.length===0)}}function di(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),u(" ",e.getErrorMessage("name")," ")}}function _i(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),u(" ",e.getErrorMessage("rule_type")," ")}}function ui(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),u(" ",e.getErrorMessage("min_duration_minutes")," ")}}function pi(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(3);l(),u(" ",e.getErrorMessage("price_per_minute")," ")}}function fi(i,m){if(i&1&&(n(0,"mat-form-field",27)(1,"mat-label"),r(2,"Precio por Minuto"),t(),g(3,"input",182),n(4,"span",169),r(5,"$\xA0"),t(),_(6,pi,2,1,"mat-error",36),t()),i&2){let e,a=d(2);l(6),c("ngIf",(e=a.ruleForm.get("price_per_minute"))==null?null:e.hasError("required"))}}function gi(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(3);l(),u(" ",e.getErrorMessage("fixed_price")," ")}}function xi(i,m){if(i&1&&(n(0,"mat-form-field",27)(1,"mat-label"),r(2,"Precio Fijo"),t(),g(3,"input",183),n(4,"span",169),r(5,"$\xA0"),t(),_(6,gi,2,1,"mat-error",36),t()),i&2){let e,a=d(2);l(6),c("ngIf",(e=a.ruleForm.get("fixed_price"))==null?null:e.hasError("required"))}}function vi(i,m){if(i&1){let e=y();n(0,"mat-checkbox",184),f("change",function(o){let s=v(e).$implicit,p=d(2);return h(p.onDayChange(o,s.value))}),r(1),t()}if(i&2){let e=m.$implicit,a=d(2);c("value",e.value)("checked",a.isDaySelected(e.value)),l(),u(" ",e.label," ")}}function hi(i,m){if(i&1){let e=y();n(0,"div",88)(1,"div",159)(2,"h2",90),r(3),t(),n(4,"form",91),f("ngSubmit",function(){v(e);let o=d();return h(o.saveRule())}),n(5,"div",92)(6,"mat-form-field",27)(7,"mat-label"),r(8,"Nombre de la Regla"),t(),g(9,"input",160),_(10,di,2,1,"mat-error",36),t(),n(11,"mat-form-field",27)(12,"mat-label"),r(13,"Tipo de Regla"),t(),n(14,"mat-select",161)(15,"mat-option",162),r(16,"Por Tiempo"),t(),n(17,"mat-option",163),r(18,"Precio Fijo"),t(),n(19,"mat-option",164),r(20,"Graduada"),t(),n(21,"mat-option",165),r(22,"Por Hora"),t()(),_(23,_i,2,1,"mat-error",36),t(),n(24,"mat-form-field",27)(25,"mat-label"),r(26,"Duraci\xF3n M\xEDnima (min)"),t(),g(27,"input",166),_(28,ui,2,1,"mat-error",36),t(),n(29,"mat-form-field",27)(30,"mat-label"),r(31,"Duraci\xF3n M\xE1xima (min)"),t(),g(32,"input",167),n(33,"mat-hint"),r(34,"Dejar vac\xEDo para sin l\xEDmite"),t()(),n(35,"mat-form-field",27)(36,"mat-label"),r(37,"Monto M\xE1ximo Diario"),t(),g(38,"input",168),n(39,"span",169),r(40,"$\xA0"),t(),n(41,"mat-hint"),r(42,"Monto m\xE1ximo a cobrar por d\xEDa completo (ej: $10.000)"),t()(),n(43,"mat-form-field",27)(44,"mat-label"),r(45,"Monto M\xEDnimo"),t(),g(46,"input",170),n(47,"span",169),r(48,"$\xA0"),t(),n(49,"mat-hint"),r(50,"Monto m\xEDnimo a cobrar independientemente del tiempo (ej: $500)"),t()(),n(51,"div",171)(52,"mat-checkbox",172),r(53," Monto m\xEDnimo como base despu\xE9s del tiempo m\xEDnimo "),t(),n(54,"mat-hint",173),r(55," Si est\xE1 activo, se cobrar\xE1 el monto m\xEDnimo hasta el tiempo m\xEDnimo y luego se sumar\xE1n los minutos adicionales. Ejemplo: $500 m\xEDnimo + 15 min m\xEDnimo \u2192 A 16 min = $525, A 17 min = $550 "),t()(),_(56,fi,7,1,"mat-form-field",174)(57,xi,7,1,"mat-form-field",174),n(58,"mat-form-field",27)(59,"mat-label"),r(60,"Hora de Inicio"),t(),g(61,"input",175),n(62,"mat-hint"),r(63,"Dejar vac\xEDo para todo el d\xEDa"),t()(),n(64,"mat-form-field",27)(65,"mat-label"),r(66,"Hora de Fin"),t(),g(67,"input",176),n(68,"mat-hint"),r(69,"Dejar vac\xEDo para todo el d\xEDa"),t()()(),n(70,"div",177)(71,"label",178),r(72,"D\xEDas de la Semana"),t(),n(73,"div",179),_(74,vi,2,3,"mat-checkbox",180),t(),n(75,"mat-hint"),r(76,"Seleccionar d\xEDas aplicables (opcional)"),t()(),n(77,"mat-form-field",98)(78,"mat-label"),r(79,"Prioridad"),t(),g(80,"input",181),n(81,"mat-hint"),r(82,"Las reglas con mayor prioridad se eval\xFAan primero"),t()(),n(83,"div",25)(84,"mat-checkbox",100),r(85," Regla activa "),t()(),n(86,"div",101)(87,"button",102),f("click",function(){v(e);let o=d();return h(o.cancelRuleEdit())}),r(88," Cancelar "),t(),n(89,"button",103),r(90),t()()()()()}if(i&2){let e,a,o,s,p,x=d();l(3),u(" ",x.editingRule?"Editar Regla de Precios":"Nueva Regla de Precios"," "),l(),c("formGroup",x.ruleForm),l(6),c("ngIf",(e=x.ruleForm.get("name"))==null?null:e.hasError("required")),l(13),c("ngIf",(a=x.ruleForm.get("rule_type"))==null?null:a.hasError("required")),l(5),c("ngIf",(o=x.ruleForm.get("min_duration_minutes"))==null?null:o.hasError("required")),l(28),c("ngIf",((s=x.ruleForm.get("rule_type"))==null?null:s.value)==="TIME_BASED"||((s=x.ruleForm.get("rule_type"))==null?null:s.value)==="HOURLY"),l(),c("ngIf",((p=x.ruleForm.get("rule_type"))==null?null:p.value)==="FIXED"),l(17),c("ngForOf",x.daysOfWeek),l(15),c("disabled",x.ruleForm.invalid),l(),u(" ",x.editingRule?"Actualizar":"Crear"," Regla ")}}var mn=(()=>{class i{constructor(e,a,o,s,p,x){this.pricingProfileService=e,this.sectorService=a,this.fb=o,this.snackBar=s,this.dialog=p,this.confirmationService=x,this._unsubscribeAll=new O,this.pricingProfiles=[],this.sectors=[],this.loading=!1,this.error=null,this.totalItems=0,this.pageSize=10,this.currentPage=0,this.pageSizeOptions=[5,10,25,50],this.sortBy="name",this.sortOrder="asc",this.filters={sector_id:void 0,name:"",is_active:void 0},this.showForm=!1,this.editingProfile=null,this.showRulesModal=!1,this.showRuleForm=!1,this.selectedProfile=null,this.pricingRules=[],this.editingRule=null,this.selectedDays=[],this.daysOfWeek=[{value:0,label:"Domingo"},{value:1,label:"Lunes"},{value:2,label:"Martes"},{value:3,label:"Mi\xE9rcoles"},{value:4,label:"Jueves"},{value:5,label:"Viernes"},{value:6,label:"S\xE1bado"}],this.ruleColumns=["name","rule_type","duration","price","days","time","status","actions"],this.displayedColumns=["name","sector","active_from","active_to","status","rules_count","actions"],this.profileForm=this.createForm(),this.ruleForm=this.createRuleForm()}ngOnInit(){this.loadSectors(),this.loadPricingProfiles()}ngAfterViewInit(){this.sort&&this.sort.sortChange.pipe(b(this._unsubscribeAll)).subscribe(e=>{this.sortBy=e.active,this.sortOrder=e.direction==="asc"?"asc":"desc",this.currentPage=0,this.loadPricingProfiles()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createForm(){return this.fb.group({sector_id:["",[w.required]],name:["",[w.required,w.minLength(2)]],description:[""],active_from:[new Date,[w.required]],active_to:[null],is_active:[!0]})}loadSectors(){this.sectorService.getSectors().pipe(b(this._unsubscribeAll)).subscribe({next:e=>{this.sectors=e.data?.data||e.data||[]},error:e=>{console.error("Error loading sectors:",e)}})}loadPricingProfiles(){this.loading=!0;let e={page:this.currentPage+1,per_page:this.pageSize,sort_by:this.sortBy,sort_order:this.sortOrder};this.filters.name&&this.filters.name.trim()!==""&&(e.name=this.filters.name),this.filters.sector_id!==void 0&&(e.sector_id=this.filters.sector_id),this.filters.is_active!==void 0&&(e.is_active=this.filters.is_active),this.pricingProfileService.getPricingProfiles(e).pipe(b(this._unsubscribeAll)).subscribe({next:a=>{this.pricingProfiles=a.data?.data||[],this.totalItems=a.data?.total||0,this.loading=!1},error:a=>{this.error="Error al cargar perfiles de precios",this.loading=!1,console.error("Error loading pricing profiles:",a),this.snackBar.open("Error al cargar perfiles de precios","Cerrar",{duration:3e3})}})}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.loadPricingProfiles()}applyFilters(){this.currentPage=0,this.loadPricingProfiles()}clearFilters(){this.filters={sector_id:void 0,name:"",is_active:void 0},this.currentPage=0,this.loadPricingProfiles()}createProfile(){this.editingProfile=null,this.profileForm.reset(),this.profileForm.patchValue({active_from:new Date,is_active:!0}),this.showForm=!0}editProfile(e){this.editingProfile=e,this.profileForm.patchValue({sector_id:e.sector_id,name:e.name,description:e.description,active_from:new Date(e.active_from),active_to:e.active_to?new Date(e.active_to):null,is_active:e.is_active}),this.showForm=!0}saveProfile(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}let e=this.profileForm.value,a=A($({},e),{active_from:e.active_from.toISOString(),active_to:e.active_to?e.active_to.toISOString():null});(this.editingProfile?this.pricingProfileService.updatePricingProfile(this.editingProfile.id,a):this.pricingProfileService.createPricingProfile(a)).pipe(b(this._unsubscribeAll)).subscribe({next:s=>{this.snackBar.open(this.editingProfile?"Perfil actualizado exitosamente":"Perfil creado exitosamente","Cerrar",{duration:3e3}),this.showForm=!1,this.loadPricingProfiles()},error:s=>{console.error("Error saving profile:",s);let p="Error al guardar perfil";(s.error?.error_code==="PLAN_LIMIT_EXCEEDED"&&s.error?.message||s.error?.message)&&(p=s.error.message),this.snackBar.open(p,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}cancelEdit(){this.showForm=!1,this.editingProfile=null,this.profileForm.reset()}deleteProfile(e){let a=e.pricing_rules?.length||0,o=`\xBFEst\xE1 seguro de eliminar el perfil "${e.name}"?`;a>0&&(o+=`

\u26A0\uFE0F Tambi\xE9n se eliminar\xE1n ${a} regla${a>1?"s":""} de precios asociada${a>1?"s":""}.`),this.confirmationService.open({title:"Eliminar Perfil de Precios",message:o,icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Eliminar Todo",color:"warn"},cancel:{show:!0,label:"Cancelar"}}}).afterClosed().subscribe(p=>{p==="confirmed"&&this.pricingProfileService.deletePricingProfile(e.id).pipe(b(this._unsubscribeAll)).subscribe({next:x=>{let S=x.message||"Perfil eliminado exitosamente";this.snackBar.open(S,"Cerrar",{duration:4e3}),this.loadPricingProfiles()},error:x=>{console.error("Error deleting profile:",x),this.snackBar.open("Error al eliminar perfil","Cerrar",{duration:3e3})}})})}toggleProfile(e){this.pricingProfileService.togglePricingProfile(e.id,!e.is_active).pipe(b(this._unsubscribeAll)).subscribe({next:a=>{this.snackBar.open(e.is_active?"Perfil desactivado":"Perfil activado","Cerrar",{duration:3e3}),this.loadPricingProfiles()},error:a=>{console.error("Error toggling profile:",a),this.snackBar.open("Error al cambiar estado del perfil","Cerrar",{duration:3e3})}})}getSectorName(e){let a=this.sectors.find(o=>o.id===e);return a?a.name:"N/A"}formatDate(e){return new Date(e).toLocaleDateString("es-CL")}getStatusLabel(e){return e?"Activo":"Inactivo"}getStatusColor(e){return e?"green":"gray"}getErrorMessage(e){let a=this.profileForm.get(e);return a?.hasError("required")?"Este campo es requerido":a?.hasError("minlength")?`M\xEDnimo ${a.errors?.minlength.requiredLength} caracteres`:""}createRuleForm(){return this.fb.group({name:["",w.required],rule_type:["TIME_BASED",w.required],min_duration_minutes:[0,w.required],max_duration_minutes:[null],daily_max_amount:[null],min_amount:[null],min_amount_is_base:[!1],price_per_minute:[0,w.required],fixed_price:[0],start_time:[""],end_time:[""],priority:[1],is_active:[!0]})}manageRules(e){this.selectedProfile=e,this.showRulesModal=!0,this.loadPricingRules(e.id)}closeRulesModal(){this.showRulesModal=!1,this.selectedProfile=null,this.pricingRules=[],this.showRuleForm=!1,this.editingRule=null}loadPricingRules(e){this.pricingProfileService.getPricingRules(e).pipe(b(this._unsubscribeAll)).subscribe({next:a=>{console.log("Respuesta del servicio de reglas:",a),this.pricingRules=a.data||[],console.log("Reglas cargadas:",this.pricingRules)},error:a=>{console.error("Error loading pricing rules:",a),this.snackBar.open("Error al cargar reglas de precios","Cerrar",{duration:3e3})}})}addRule(){this.editingRule=null,this.selectedDays=[],this.ruleForm.reset({name:"",rule_type:"TIME_BASED",min_duration_minutes:0,max_duration_minutes:null,daily_max_amount:null,min_amount:null,min_amount_is_base:!1,price_per_minute:0,fixed_price:0,start_time:"",end_time:"",priority:1,is_active:!0}),this.showRuleForm=!0}editRule(e){console.log("Editando regla:",e),console.log("start_time raw:",e.start_time),console.log("end_time raw:",e.end_time),console.log("start_min:",e.start_min),console.log("end_min:",e.end_min),this.editingRule=e,this.selectedDays=e.days_of_week||[];let a="",o="";e.start_time?(a=this.formatTimeForInput(e.start_time),console.log("start_time formateado:",a)):e.start_min!==void 0&&e.start_min!==null&&(a=this.minutesToTimeString(e.start_min),console.log("start_min convertido:",a)),e.end_time?(o=this.formatTimeForInput(e.end_time),console.log("end_time formateado:",o)):e.end_min!==void 0&&e.end_min!==null&&(o=this.minutesToTimeString(e.end_min),console.log("end_min convertido:",o));let s={name:e.name||"",rule_type:e.rule_type||"TIME_BASED",min_duration_minutes:e.min_duration_minutes||0,max_duration_minutes:e.max_duration_minutes||null,daily_max_amount:e.daily_max_amount||null,min_amount:e.min_amount||null,min_amount_is_base:e.min_amount_is_base||!1,price_per_minute:e.price_per_minute||e.price_per_min||0,fixed_price:e.fixed_price||0,start_time:a,end_time:o,priority:e.priority||1,is_active:e.is_active!==void 0?e.is_active:!0};console.log("Datos del formulario antes de setValue:",s),console.log("startTime final:",a),console.log("endTime final:",o),this.ruleForm.setValue(s),a&&this.ruleForm.get("start_time")?.setValue(a,{emitEvent:!1}),o&&this.ruleForm.get("end_time")?.setValue(o,{emitEvent:!1}),console.log("Estado del formulario despu\xE9s de setValue:",this.ruleForm.value),console.log("Formulario v\xE1lido:",this.ruleForm.valid),console.log("Campo name:",this.ruleForm.get("name")?.value),console.log("Campo rule_type:",this.ruleForm.get("rule_type")?.value),console.log("Campo start_time:",this.ruleForm.get("start_time")?.value),console.log("Campo end_time:",this.ruleForm.get("end_time")?.value),this.showRuleForm=!0,setTimeout(()=>{console.log("Estado del formulario despu\xE9s de mostrar:",this.ruleForm.value),console.log("start_time control:",this.ruleForm.get("start_time")?.value),console.log("end_time control:",this.ruleForm.get("end_time")?.value)},100)}minutesToTimeString(e){let a=Math.floor(e/60),o=e%60;return`${a.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}formatTimeForInput(e){if(!e)return"";let a=String(e).trim();if(!a||a==="null"||a==="undefined")return"";if(/^\d{2}:\d{2}$/.test(a))return a;let o=a.match(/^(\d{1,2}):(\d{2})(?::(\d{2}))?$/);if(o){let s=o[1].padStart(2,"0"),p=o[2];return`${s}:${p}`}if(a.includes("T")||a.includes(" "))try{let s=new Date(a);if(!isNaN(s.getTime())){let p=s.getHours().toString().padStart(2,"0"),x=s.getMinutes().toString().padStart(2,"0");return`${p}:${x}`}}catch(s){console.warn("Error parsing time string:",a,s)}return console.warn("No se pudo formatear el tiempo:",a),""}formatTimeForBackend(e){if(!e||e.trim()==="")return null;if(/^\d{2}:\d{2}$/.test(e))return e;if(/^\d{1}:\d{2}$/.test(e)){let o=e.split(":");return`${o[0].padStart(2,"0")}:${o[1]}`}let a=e.match(/^(\d{1,2}):(\d{2})(?::\d{2})?$/);if(a){let o=a[1].padStart(2,"0"),s=a[2];return`${o}:${s}`}return null}saveRule(){if(this.ruleForm.valid&&this.selectedProfile){let e=this.ruleForm.value.rule_type==="HOURLY"?"TIME_BASED":this.ruleForm.value.rule_type,a={profile_id:this.selectedProfile.id,name:this.ruleForm.value.name,rule_type:e,min_duration_minutes:this.ruleForm.value.min_duration_minutes,max_duration_minutes:this.ruleForm.value.max_duration_minutes,daily_max_amount:this.ruleForm.value.daily_max_amount,min_amount:this.ruleForm.value.min_amount,min_amount_is_base:this.ruleForm.value.min_amount_is_base||!1,price_per_minute:this.ruleForm.value.price_per_minute,fixed_price:this.ruleForm.value.fixed_price,days_of_week:this.selectedDays,start_time:this.formatTimeForBackend(this.ruleForm.value.start_time),end_time:this.formatTimeForBackend(this.ruleForm.value.end_time),priority:this.ruleForm.value.priority,is_active:this.ruleForm.value.is_active};console.log("Datos a enviar al backend:",a),console.log("ID de la regla:",this.editingRule?.id),this.editingRule?this.pricingProfileService.updatePricingRule(this.editingRule.id,a).pipe(b(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla actualizada exitosamente","Cerrar",{duration:3e3}),this.cancelRuleEdit(),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error updating rule:",o),console.error("Error details:",o.error),this.snackBar.open("Error al actualizar regla: "+(o.error?.message||o.message),"Cerrar",{duration:5e3})}}):this.pricingProfileService.createPricingRule(a).pipe(b(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla creada exitosamente","Cerrar",{duration:3e3}),this.cancelRuleEdit(),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error creating rule:",o);let s="Error al crear regla";(o.error?.error_code==="PLAN_LIMIT_EXCEEDED"&&o.error?.message||o.error?.message)&&(s=o.error.message),this.snackBar.open(s,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}}cancelRuleEdit(){this.showRuleForm=!1,this.editingRule=null,this.selectedDays=[],this.ruleForm.reset()}deleteRule(e){this.confirmationService.open({title:"Eliminar Regla",message:`\xBFEst\xE1s seguro de que quieres eliminar la regla "${e.name}"?`,actions:{confirm:{show:!0,label:"Eliminar",color:"warn"},cancel:{show:!0,label:"Cancelar"}}}).afterClosed().subscribe(a=>{a==="confirmed"&&this.pricingProfileService.deletePricingRule(e.id).pipe(b(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla eliminada exitosamente","Cerrar",{duration:3e3}),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error deleting rule:",o),this.snackBar.open("Error al eliminar regla","Cerrar",{duration:3e3})}})})}toggleRule(e){this.pricingProfileService.togglePricingRule(e.id,!e.is_active).pipe(b(this._unsubscribeAll)).subscribe({next:a=>{this.snackBar.open(e.is_active?"Regla desactivada":"Regla activada","Cerrar",{duration:3e3}),this.loadPricingRules(this.selectedProfile.id)},error:a=>{console.error("Error toggling rule:",a),this.snackBar.open("Error al cambiar estado de la regla","Cerrar",{duration:3e3})}})}onDayChange(e,a){e.checked?this.selectedDays.includes(a)||this.selectedDays.push(a):this.selectedDays=this.selectedDays.filter(o=>o!==a)}isDaySelected(e){return this.selectedDays.includes(e)}getRuleTypeLabel(e){return{TIME_BASED:"Por Tiempo",FIXED:"Precio Fijo",GRADUATED:"Graduada",HOURLY:"Por Hora"}[e]||e}getDaysLabel(e){if(!e||e.length===0)return"Todos";let a=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];return e.map(o=>a[o]).join(", ")}getRuleTypeColor(e){return{TIME_BASED:"blue",FIXED:"green",GRADUATED:"purple",HOURLY:"blue"}[e]||"gray"}formatTimeRange(e,a){if(!e||!a)return"Todo el d\xEDa";try{let o=e,s=a;if(e.includes("T")||e.includes(" ")){let p=new Date(e);isNaN(p.getTime())||(o=p.toTimeString().substring(0,5))}else e.includes(":")&&(o=e.substring(0,5));if(a.includes("T")||a.includes(" ")){let p=new Date(a);isNaN(p.getTime())||(s=p.toTimeString().substring(0,5))}else a.includes(":")&&(s=a.substring(0,5));return`${o} - ${s}`}catch(o){return console.error("Error formatting time range:",o),"Todo el d\xEDa"}}getActiveProfilesCount(){return this.pricingProfiles.filter(e=>e.is_active).length}getInactiveProfilesCount(){return this.pricingProfiles.filter(e=>!e.is_active).length}getTotalRulesCount(){return this.pricingProfiles.reduce((e,a)=>e+(a.pricing_rules?.length||0),0)}getTimeValue(e){if(!e||e===""||e===null)return"";let a=this.formatTimeForInput(e);return a==="00:00"?"":a}onTimeChange(e,a){let o=a.target.value;o===""||o===null||o==="00:00"?this.ruleForm.get(e)?.setValue(""):this.ruleForm.get(e)?.setValue(o)}static{this.\u0275fac=function(a){return new(a||i)(M(ot),M(at),M(Ce),M(Ie),M(X),M(le))}}static{this.\u0275cmp=N({type:i,selectors:[["app-pricing-profiles"]],viewQuery:function(a,o){if(a&1&&B(R,5),a&2){let s;L(s=H())&&(o.sort=s.first)}},features:[q([{provide:Ke,useValue:rt()}])],decls:97,vars:20,consts:[["actionMenu","matMenu"],["activeFromPicker",""],["activeToPicker",""],["ruleActionMenu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-6"],[1,"p-6"],[1,"flex","items-center"],[1,"p-3","bg-blue-100","rounded-full"],[1,"text-blue-600"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"p-3","bg-green-100","rounded-full"],[1,"text-green-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"p-3","bg-gray-100","rounded-full"],[1,"text-2xl","font-bold","text-gray-600"],[1,"p-3","bg-purple-100","rounded-full"],[1,"text-purple-600"],[1,"text-2xl","font-bold","text-purple-600"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["appearance","outline"],["matInput","","placeholder","Nombre del perfil",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","justify-end","gap-2","mt-4"],["mat-stroked-button","",1,"rounded-sm",3,"click"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","mb-6",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","","class","mt-4",3,"length","pageSize","pageSizeOptions","pageIndex","page",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","modal-overlay bg-black bg-opacity-50 flex items-center justify-center",4,"ngIf"],["class","modal-overlay bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4",4,"ngIf"],[1,"flex","justify-center","items-center","h-64"],["diameter","50"],["type","error",3,"dismissible"],[1,"p-0"],[1,"overflow-x-auto"],["mat-table","","matSort","",1,"w-full","mat-elevation-z2",2,"width","100%","table-layout","fixed",3,"dataSource","matSortActive","matSortDirection"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","name","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sector"],["mat-header-cell","","mat-sort-header","sector_id","style","width: 15%;",4,"matHeaderCellDef"],["matColumnDef","active_from"],["mat-header-cell","","mat-sort-header","active_from","style","width: 15%;",4,"matHeaderCellDef"],["matColumnDef","active_to"],["mat-header-cell","","mat-sort-header","active_to","style","width: 15%;",4,"matHeaderCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","is_active","style","width: 10%;",4,"matHeaderCellDef"],["matColumnDef","rules_count"],["mat-header-cell","","mat-sort-header","rules_count","style","width: 10%;",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","text-right","style","width: 15%;",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","name",2,"width","20%"],["mat-cell",""],[1,"font-medium","text-gray-900"],["class","text-sm text-gray-600",4,"ngIf"],[1,"text-sm","text-gray-600"],["mat-header-cell","","mat-sort-header","sector_id",2,"width","15%"],["mat-header-cell","","mat-sort-header","active_from",2,"width","15%"],["mat-header-cell","","mat-sort-header","active_to",2,"width","15%"],["mat-header-cell","","mat-sort-header","is_active",2,"width","10%"],[1,"px-2","py-1","rounded","text-xs","font-medium"],["mat-header-cell","","mat-sort-header","rules_count",2,"width","10%"],["mat-header-cell","",1,"text-right",2,"width","15%"],["mat-cell","",1,"text-right"],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""],["showFirstLastButtons","",1,"mt-4",3,"page","length","pageSize","pageSizeOptions","pageIndex"],[1,"text-center","py-12"],[1,"text-6xl","text-gray-400","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],[1,"modal-overlay","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-2xl","mx-4","max-h-screen","overflow-y-auto"],[1,"text-xl","font-semibold","text-gray-900","mb-4"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],["formControlName","sector_id"],["matInput","","formControlName","name","placeholder","Nombre del perfil"],["matInput","","formControlName","active_from",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","active_to",3,"matDatepicker"],["appearance","outline",1,"w-full","mb-4"],["matInput","","formControlName","description","rows","3","placeholder","Descripci\xF3n del perfil"],["formControlName","is_active"],[1,"flex","justify-end","gap-3"],["type","button","mat-stroked-button","",1,"rounded-sm",3,"click"],["type","submit","mat-raised-button","","color","primary",1,"rounded-sm",3,"disabled"],[1,"modal-overlay","bg-black","bg-opacity-50","flex","items-center","justify-center","p-2","sm:p-4"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-[95vw]","sm:max-w-[90vw]","md:max-w-[85vw]","lg:max-w-[80vw]","xl:max-w-[75vw]","max-h-[95vh]","flex","flex-col"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","bg-gray-50","rounded-t-lg"],[1,"flex","items-center","gap-3"],[1,"text-xl","font-semibold","text-gray-900"],["mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"flex-1","overflow-hidden","flex","flex-col"],[1,"p-6","border-b","border-gray-200","bg-white"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["mat-raised-button","","color","primary",3,"click"],[1,"flex-1","overflow-auto","p-2","sm:p-4","lg:p-6"],[1,"bg-white","rounded-lg","border","border-gray-200","overflow-hidden"],[1,"hidden","md:block"],["mat-table","",1,"w-full",3,"dataSource"],["mat-header-cell","","class","font-semibold text-gray-700",4,"matHeaderCellDef"],["mat-cell","","class","py-4",4,"matCellDef"],["matColumnDef","rule_type"],["matColumnDef","duration"],["matColumnDef","price"],["matColumnDef","days"],["matColumnDef","time"],["mat-header-cell","","class","font-semibold text-gray-700 text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right py-4",4,"matCellDef"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50",4,"matRowDef","matRowDefColumns"],[1,"md:hidden"],["class","border-b border-gray-200 p-4 last:border-b-0",4,"ngFor","ngForOf"],[1,"p-6","border-t","border-gray-200","bg-gray-50","rounded-b-lg"],[1,"flex","justify-end"],["mat-button","",1,"mr-3",3,"click"],["mat-header-cell","",1,"font-semibold","text-gray-700"],["mat-cell","",1,"py-4"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],["class","text-green-600 font-medium",4,"ngIf"],["class","text-blue-600 font-medium",4,"ngIf"],[1,"text-green-600","font-medium"],[1,"text-blue-600","font-medium"],[1,"text-sm","font-medium","text-gray-900"],["class","text-green-600",4,"ngIf"],["class","text-blue-600",4,"ngIf"],["mat-header-cell","",1,"font-semibold","text-gray-700","text-right"],["mat-cell","",1,"text-right","py-4"],["mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"matMenuTriggerFor"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50"],[1,"border-b","border-gray-200","p-4","last:border-b-0"],[1,"flex","items-start","justify-between","mb-3"],[1,"flex-1"],[1,"font-medium","text-gray-900","text-sm"],[1,"flex","items-center","gap-2","mt-1"],["mat-icon-button","",1,"text-gray-500",3,"matMenuTriggerFor"],[1,"grid","grid-cols-2","gap-3","text-xs","text-gray-600"],[1,"font-medium"],[1,"text-gray-600","mb-6"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-4xl","mx-4","max-h-screen","overflow-y-auto"],["matInput","","formControlName","name","placeholder","Ej: Tarifa est\xE1ndar"],["formControlName","rule_type"],["value","TIME_BASED"],["value","FIXED"],["value","GRADUATED"],["value","HOURLY"],["matInput","","formControlName","min_duration_minutes","type","number","min","0"],["matInput","","formControlName","max_duration_minutes","type","number","min","0"],["matInput","","formControlName","daily_max_amount","type","number","min","0","step","0.01"],["matPrefix",""],["matInput","","formControlName","min_amount","type","number","min","0","step","0.01"],[1,"col-span-full"],["formControlName","min_amount_is_base"],[1,"block","mt-1"],["appearance","outline",4,"ngIf"],["matInput","","formControlName","start_time","type","time"],["matInput","","formControlName","end_time","type","time"],[1,"mb-4"],[1,"text-sm","font-medium","text-gray-700","mb-2","block"],[1,"flex","flex-wrap","gap-2"],[3,"value","checked","change",4,"ngFor","ngForOf"],["matInput","","formControlName","priority","type","number","min","1","value","1"],["matInput","","formControlName","price_per_minute","type","number","min","0","step","0.01"],["matInput","","formControlName","fixed_price","type","number","min","0","step","0.01"],[3,"change","value","checked"]],template:function(a,o){a&1&&(n(0,"div",4)(1,"div",5)(2,"div")(3,"h1",6),r(4,"Perfiles de Precios"),t(),n(5,"p",7),r(6,"Gestiona los perfiles de precios por sector"),t()(),n(7,"button",8),f("click",function(){return o.createProfile()}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Nuevo Perfil "),t()(),n(11,"div",9)(12,"mat-card")(13,"mat-card-content",10)(14,"div",11)(15,"div",12)(16,"mat-icon",13),r(17,"price_check"),t()(),n(18,"div",14)(19,"p",15),r(20,"Total Perfiles"),t(),n(21,"p",16),r(22),t()()()()(),n(23,"mat-card")(24,"mat-card-content",10)(25,"div",11)(26,"div",17)(27,"mat-icon",18),r(28,"check_circle"),t()(),n(29,"div",14)(30,"p",15),r(31,"Activos"),t(),n(32,"p",19),r(33),t()()()()(),n(34,"mat-card")(35,"mat-card-content",10)(36,"div",11)(37,"div",20)(38,"mat-icon",7),r(39,"pause_circle"),t()(),n(40,"div",14)(41,"p",15),r(42,"Inactivos"),t(),n(43,"p",21),r(44),t()()()()(),n(45,"mat-card")(46,"mat-card-content",10)(47,"div",11)(48,"div",22)(49,"mat-icon",23),r(50,"rule"),t()(),n(51,"div",14)(52,"p",15),r(53,"Total Reglas"),t(),n(54,"p",24),r(55),t()()()()()(),n(56,"mat-card",25)(57,"mat-card-content",10)(58,"div",26)(59,"mat-form-field",27)(60,"mat-label"),r(61,"Buscar por Nombre"),t(),n(62,"input",28),k("ngModelChange",function(p){return F(o.filters.name,p)||(o.filters.name=p),p}),t()(),n(63,"mat-form-field",27)(64,"mat-label"),r(65,"Sector"),t(),n(66,"mat-select",29),k("ngModelChange",function(p){return F(o.filters.sector_id,p)||(o.filters.sector_id=p),p}),n(67,"mat-option",30),r(68,"Todos"),t(),_(69,lt,2,2,"mat-option",31),t()(),n(70,"mat-form-field",27)(71,"mat-label"),r(72,"Estado"),t(),n(73,"mat-select",29),k("ngModelChange",function(p){return F(o.filters.is_active,p)||(o.filters.is_active=p),p}),n(74,"mat-option",30),r(75,"Todos"),t(),n(76,"mat-option",30),r(77,"Activo"),t(),n(78,"mat-option",30),r(79,"Inactivo"),t()()()(),n(80,"div",32)(81,"button",33),f("click",function(){return o.clearFilters()}),n(82,"mat-icon"),r(83,"clear"),t(),r(84," Limpiar "),t(),n(85,"button",8),f("click",function(){return o.applyFilters()}),n(86,"mat-icon"),r(87,"search"),t(),r(88," Filtrar "),t()()()(),_(89,mt,2,0,"div",34)(90,st,3,2,"div",35)(91,Mt,27,5,"mat-card",36)(92,It,1,4,"mat-paginator",37)(93,Tt,11,0,"div",38),t(),_(94,$t,45,13,"div",39)(95,ci,61,9,"div",40)(96,hi,91,10,"div",39)),a&2&&(l(22),P(o.pricingProfiles.length),l(11),P(o.getActiveProfilesCount()),l(11),P(o.getInactiveProfilesCount()),l(11),P(o.getTotalRulesCount()),l(7),D("ngModel",o.filters.name),l(4),D("ngModel",o.filters.sector_id),l(),c("value",void 0),l(2),c("ngForOf",o.sectors),l(4),D("ngModel",o.filters.is_active),l(),c("value",void 0),l(2),c("value",!0),l(2),c("value",!1),l(11),c("ngIf",o.loading),l(),c("ngIf",o.error),l(),c("ngIf",!o.loading),l(),c("ngIf",!o.loading&&o.pricingProfiles.length>0),l(),c("ngIf",!o.loading&&o.pricingProfiles.length===0),l(),c("ngIf",o.showForm),l(),c("ngIf",o.showRulesModal),l(),c("ngIf",o.showRuleForm))},dependencies:[W,z,G,be,ge,_e,xe,ue,pe,Pe,ve,he,Ee,fe,re,ie,ne,oe,ae,Ae,Ve,$e,Je,He,qe,Ue,ze,je,Xe,Ge,We,Ye,Qe,te,ee,Y,J,Q,K,Z,ye,Se,Fe,De,U,Me,we,Te,et,Ze,it,R,tt,nt,de,se,me,ce,Le,Oe,Ne,Be,Re,ke],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed!important;inset:0 0 0 280px!important;z-index:250!important}@media (max-width: 768px){.modal-overlay[_ngcontent-%COMP%]{left:0!important}}.rules-modal[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden}.rules-modal[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{background-color:#f9fafb}.rules-modal[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.rules-modal[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .rules-modal[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{padding:16px 12px}.rule-form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.rule-form[_ngcontent-%COMP%]   .days-selector[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}.rule-form[_ngcontent-%COMP%]   .day-chip[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.rule-form[_ngcontent-%COMP%]   .day-chip.selected[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.rule-form[_ngcontent-%COMP%]   .day-chip[_ngcontent-%COMP%]:hover{background-color:#e5e7eb}@media (max-width: 768px){.rules-modal[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{font-size:14px}.rules-modal[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .rules-modal[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{padding:12px 8px}}"]})}}return i})();export{mn as PricingProfilesComponent};
