import{a as Qe}from"./chunk-HQDJMMZR.js";import{a as We}from"./chunk-OBHV2XAP.js";import{a as Ke}from"./chunk-ZMZZWBL4.js";import{c as Ue}from"./chunk-A34BBAVQ.js";import{a as qe,b as Ge}from"./chunk-3OPQLQ7Z.js";import{a as Re,b as $e,c as Ve,d as Ae,e as Oe,f as Ne,g as Be,h as je,i as Le,j as He,k as ze}from"./chunk-EYHG6JIJ.js";import{a as Ye,c as Xe,f as Je}from"./chunk-O24YRI2L.js";import{a as Me,b as Te,c as Ie,d as De}from"./chunk-PFLL6SKJ.js";import{a as Fe,b as ke}from"./chunk-7XMR7DBQ.js";import"./chunk-2LVKS4R7.js";import{a as be,b as Se}from"./chunk-EQ3II6XW.js";import{g as ie}from"./chunk-EUXZI2DA.js";import{c as z}from"./chunk-UG2EBNTC.js";import{a as ne,b as re,c as ae,d as oe}from"./chunk-E7BFUDNM.js";import"./chunk-G7M3T37K.js";import"./chunk-UF23LYQO.js";import"./chunk-VKB6BRO6.js";import{a as ye,b as we}from"./chunk-MP4NGWWR.js";import{b as ee,c as te}from"./chunk-U3LSFXAC.js";import{d as he,e as Pe}from"./chunk-PKSNJV5O.js";import{a as Ce,b as Ee}from"./chunk-VKOFSPQJ.js";import{b as q,c as G,d as W,e as U,f as Y,j as X,k as J}from"./chunk-L3L2HYJX.js";import{b as le,d as w,f as me,g as ce,j as se,k as de,l as ue,n as _e,o as pe,s as fe,v as ge,x as xe,y as ve}from"./chunk-EGGCURRC.js";import{fa as H,la as K,na as Q,oa as Z}from"./chunk-JXZZYULX.js";import"./chunk-CQGOYTFO.js";import"./chunk-7OGW3PNS.js";import{l as B,m as j,s as L}from"./chunk-TQARHOKX.js";import{$b as f,Eb as s,Ib as T,Pb as n,Qb as t,Rb as g,Sb as C,Tb as E,U as S,Vb as y,bb as l,bc as d,cb as M,f as A,lc as I,mc as r,nc as P,oa as v,oc as _,pa as h,pb as O,pc as R,qc as N,rc as D,sc as F,tc as k,wb as u}from"./chunk-BSJZAB7M.js";import{a as $,b as V}from"./chunk-TSRGIXR5.js";function Ze(i,m){if(i&1&&(n(0,"mat-option",30),r(1),t()),i&2){let e=m.$implicit;s("value",e.id),l(),_(" ",e.name," ")}}function et(i,m){i&1&&(n(0,"div",41),g(1,"mat-spinner",42),t())}function tt(i,m){if(i&1&&(n(0,"div",25)(1,"fuse-alert",43),r(2),t()()),i&2){let e=d();l(),s("dismissible",!0),l(),_(" ",e.error," ")}}function it(i,m){i&1&&(n(0,"th",62),r(1,"Nombre"),t())}function nt(i,m){if(i&1&&(n(0,"div",66),r(1),t()),i&2){let e=d().$implicit;l(),P(e.description)}}function rt(i,m){if(i&1&&(n(0,"td",63)(1,"div",64),r(2),t(),u(3,nt,2,1,"div",65),t()),i&2){let e=m.$implicit;l(2),P(e.name),l(),s("ngIf",e.description)}}function at(i,m){i&1&&(n(0,"th",67),r(1,"Sector"),t())}function ot(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),P(a.getSectorName(e.sector_id))}}function lt(i,m){i&1&&(n(0,"th",67),r(1,"Vigente Desde"),t())}function mt(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),P(a.formatDate(e.active_from))}}function ct(i,m){i&1&&(n(0,"th",67),r(1,"Vigente Hasta"),t())}function st(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),P(e.active_to?a.formatDate(e.active_to):"Indefinido")}}function dt(i,m){i&1&&(n(0,"th",68),r(1,"Estado"),t())}function ut(i,m){if(i&1&&(n(0,"td",63)(1,"span",69),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(),T("bg-"+a.getStatusColor(e.is_active)+"-100 text-"+a.getStatusColor(e.is_active)+"-800"),l(),_(" ",a.getStatusLabel(e.is_active)," ")}}function _t(i,m){i&1&&(n(0,"th",68),r(1,"Reglas"),t())}function pt(i,m){if(i&1&&(n(0,"td",63)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit;l(2),P((e.pricing_rules==null?null:e.pricing_rules.length)||0)}}function ft(i,m){i&1&&(n(0,"th",70),r(1,"Acciones"),t())}function gt(i,m){if(i&1){let e=y();n(0,"td",71)(1,"button",72)(2,"mat-icon"),r(3,"more_vert"),t()(),n(4,"mat-menu",null,0)(6,"button",73),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.manageRules(o))}),n(7,"mat-icon"),r(8,"rule"),t(),r(9," Gestionar Reglas "),t(),n(10,"button",73),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.editProfile(o))}),n(11,"mat-icon"),r(12,"edit"),t(),r(13," Editar Perfil "),t(),n(14,"button",73),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.toggleProfile(o))}),n(15,"mat-icon"),r(16),t(),r(17),t(),n(18,"button",74),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.deleteProfile(o))}),n(19,"mat-icon"),r(20,"delete"),t(),r(21," Eliminar "),t()()()}if(i&2){let e=m.$implicit,a=I(5);l(),s("matMenuTriggerFor",a),l(15),P(e.is_active?"pause":"play_arrow"),l(),_(" ",e.is_active?"Desactivar":"Activar"," ")}}function xt(i,m){i&1&&g(0,"tr",75)}function vt(i,m){i&1&&g(0,"tr",76)}function ht(i,m){if(i&1&&(n(0,"mat-card")(1,"mat-card-content",44)(2,"div",45)(3,"table",46),C(4,47),u(5,it,2,0,"th",48)(6,rt,4,2,"td",49),E(),C(7,50),u(8,at,2,0,"th",51)(9,ot,3,1,"td",49),E(),C(10,52),u(11,lt,2,0,"th",51)(12,mt,3,1,"td",49),E(),C(13,53),u(14,ct,2,0,"th",51)(15,st,3,1,"td",49),E(),C(16,54),u(17,dt,2,0,"th",55)(18,ut,3,3,"td",49),E(),C(19,56),u(20,_t,2,0,"th",55)(21,pt,3,1,"td",49),E(),C(22,57),u(23,ft,2,0,"th",58)(24,gt,22,3,"td",59),E(),u(25,xt,1,0,"tr",60)(26,vt,1,0,"tr",61),t()()()()),i&2){let e=d();l(3),s("dataSource",e.pricingProfiles),l(22),s("matHeaderRowDef",e.displayedColumns),l(),s("matRowDefColumns",e.displayedColumns)}}function Pt(i,m){if(i&1){let e=y();n(0,"mat-paginator",77),f("page",function(o){v(e);let c=d();return h(c.onPageChange(o))}),t()}if(i&2){let e=d();s("length",e.totalItems)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("pageIndex",e.currentPage)}}function Ct(i,m){if(i&1){let e=y();n(0,"div",78)(1,"mat-icon",79),r(2,"price_check"),t(),n(3,"h3",80),r(4,"No hay perfiles de precios"),t(),n(5,"p",81),r(6,"No se encontraron perfiles de precios con los filtros aplicados."),t(),n(7,"button",8),f("click",function(){v(e);let o=d();return h(o.createProfile())}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Crear Nuevo Perfil "),t()()}}function Et(i,m){if(i&1&&(n(0,"mat-option",30),r(1),t()),i&2){let e=m.$implicit;s("value",e.id),l(),_(" ",e.name," ")}}function bt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),_(" ",e.getErrorMessage("sector_id")," ")}}function St(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),_(" ",e.getErrorMessage("name")," ")}}function yt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),_(" ",e.getErrorMessage("name")," ")}}function wt(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),_(" ",e.getErrorMessage("active_from")," ")}}function Mt(i,m){if(i&1){let e=y();n(0,"div",82)(1,"div",83)(2,"h2",84),r(3),t(),n(4,"form",85),f("ngSubmit",function(){v(e);let o=d();return h(o.saveProfile())}),n(5,"div",86)(6,"mat-form-field",27)(7,"mat-label"),r(8,"Sector"),t(),n(9,"mat-select",87),u(10,Et,2,2,"mat-option",31),t(),u(11,bt,2,1,"mat-error",36),t(),n(12,"mat-form-field",27)(13,"mat-label"),r(14,"Nombre"),t(),g(15,"input",88),u(16,St,2,1,"mat-error",36)(17,yt,2,1,"mat-error",36),t(),n(18,"mat-form-field",27)(19,"mat-label"),r(20,"Vigente Desde"),t(),g(21,"input",89)(22,"mat-datepicker-toggle",90)(23,"mat-datepicker",null,1),u(25,wt,2,1,"mat-error",36),t(),n(26,"mat-form-field",27)(27,"mat-label"),r(28,"Vigente Hasta (Opcional)"),t(),g(29,"input",91)(30,"mat-datepicker-toggle",90)(31,"mat-datepicker",null,2),t()(),n(33,"mat-form-field",92)(34,"mat-label"),r(35,"Descripci\xF3n"),t(),g(36,"textarea",93),t(),n(37,"div",25)(38,"mat-checkbox",94),r(39," Perfil activo "),t()(),n(40,"div",95)(41,"button",96),f("click",function(){v(e);let o=d();return h(o.cancelEdit())}),r(42," Cancelar "),t(),n(43,"button",97),r(44),t()()()()()}if(i&2){let e,a,o,c,p=I(24),x=I(32),b=d();l(3),_(" ",b.editingProfile?"Editar Perfil de Precios":"Nuevo Perfil de Precios"," "),l(),s("formGroup",b.profileForm),l(6),s("ngForOf",b.sectors),l(),s("ngIf",(e=b.profileForm.get("sector_id"))==null?null:e.hasError("required")),l(5),s("ngIf",(a=b.profileForm.get("name"))==null?null:a.hasError("required")),l(),s("ngIf",(o=b.profileForm.get("name"))==null?null:o.hasError("minlength")),l(4),s("matDatepicker",p),l(),s("for",p),l(3),s("ngIf",(c=b.profileForm.get("active_from"))==null?null:c.hasError("required")),l(4),s("matDatepicker",x),l(),s("for",x),l(13),s("disabled",b.profileForm.invalid),l(),_(" ",b.editingProfile?"Actualizar":"Crear"," Perfil ")}}function Tt(i,m){i&1&&(n(0,"th",129),r(1,"Nombre"),t())}function It(i,m){if(i&1&&(n(0,"td",130)(1,"div",64),r(2),t()()),i&2){let e=m.$implicit;l(2),P(e.name)}}function Dt(i,m){i&1&&(n(0,"th",129),r(1,"Tipo"),t())}function Ft(i,m){if(i&1&&(n(0,"td",130)(1,"span",131),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(),T("bg-"+a.getRuleTypeColor(e.rule_type)+"-100 text-"+a.getRuleTypeColor(e.rule_type)+"-800"),l(),_(" ",a.getRuleTypeLabel(e.rule_type)," ")}}function kt(i,m){i&1&&(n(0,"th",129),r(1,"Duraci\xF3n"),t())}function Rt(i,m){if(i&1&&(n(0,"div",134),r(1),t()),i&2){let e=d().$implicit;l(),_(" M\xEDn: $",e.min_amount," ")}}function $t(i,m){if(i&1&&(n(0,"div",135),r(1),t()),i&2){let e=d().$implicit;l(),_(" M\xE1x: $",e.daily_max_amount," ")}}function Vt(i,m){if(i&1&&(n(0,"td",130)(1,"div",66)(2,"div"),r(3),t(),u(4,Rt,2,1,"div",132)(5,$t,2,1,"div",133),t()()),i&2){let e=m.$implicit;l(3),R("",e.min_duration_minutes,"-",e.max_duration_minutes||"\u221E"," min"),l(),s("ngIf",e.min_amount),l(),s("ngIf",e.daily_max_amount)}}function At(i,m){i&1&&(n(0,"th",129),r(1,"Precio"),t())}function Ot(i,m){if(i&1&&(n(0,"span",18),r(1),t()),i&2){let e=d().$implicit;l(),_("$",e.fixed_price,"")}}function Nt(i,m){if(i&1&&(n(0,"span",13),r(1),t()),i&2){let e=d().$implicit;l(),_("$",e.price_per_min,"/min")}}function Bt(i,m){if(i&1&&(n(0,"td",130)(1,"div",136),u(2,Ot,2,1,"span",137)(3,Nt,2,1,"span",138),t()()),i&2){let e=m.$implicit;l(2),s("ngIf",e.fixed_price),l(),s("ngIf",e.price_per_min)}}function jt(i,m){i&1&&(n(0,"th",129),r(1,"D\xEDas"),t())}function Lt(i,m){if(i&1&&(n(0,"td",130)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),_(" ",a.getDaysLabel(e.days_of_week)," ")}}function Ht(i,m){i&1&&(n(0,"th",129),r(1,"Horario"),t())}function zt(i,m){if(i&1&&(n(0,"td",130)(1,"div",66),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(2),_(" ",a.formatTimeRange(e.start_time,e.end_time)," ")}}function qt(i,m){i&1&&(n(0,"th",129),r(1,"Estado"),t())}function Gt(i,m){if(i&1&&(n(0,"td",130)(1,"span",131),r(2),t()()),i&2){let e=m.$implicit,a=d(2);l(),T("bg-"+a.getStatusColor(e.is_active)+"-100 text-"+a.getStatusColor(e.is_active)+"-800"),l(),_(" ",a.getStatusLabel(e.is_active)," ")}}function Wt(i,m){i&1&&(n(0,"th",139),r(1,"Acciones"),t())}function Ut(i,m){if(i&1){let e=y();n(0,"td",140)(1,"button",141)(2,"mat-icon"),r(3,"more_vert"),t()(),n(4,"mat-menu",null,3)(6,"button",73),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.editRule(o))}),n(7,"mat-icon"),r(8,"edit"),t(),r(9," Editar "),t(),n(10,"button",73),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.toggleRule(o))}),n(11,"mat-icon"),r(12),t(),r(13),t(),n(14,"button",74),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.deleteRule(o))}),n(15,"mat-icon"),r(16,"delete"),t(),r(17," Eliminar "),t()()()}if(i&2){let e=m.$implicit,a=I(5);l(),s("matMenuTriggerFor",a),l(11),P(e.is_active?"pause":"play_arrow"),l(),_(" ",e.is_active?"Desactivar":"Activar"," ")}}function Yt(i,m){i&1&&g(0,"tr",142)}function Xt(i,m){i&1&&g(0,"tr",143)}function Jt(i,m){if(i&1&&(n(0,"div",134),r(1),t()),i&2){let e=d().$implicit;l(),_(" M\xEDn: $",e.min_amount," ")}}function Kt(i,m){if(i&1&&(n(0,"div",135),r(1),t()),i&2){let e=d().$implicit;l(),_(" M\xE1x: $",e.daily_max_amount," ")}}function Qt(i,m){if(i&1&&(n(0,"span",134),r(1),t()),i&2){let e=d().$implicit;l(),_("$",e.fixed_price,"")}}function Zt(i,m){if(i&1&&(n(0,"span",135),r(1),t()),i&2){let e=d().$implicit;l(),_("$",e.price_per_min,"/min")}}function ei(i,m){if(i&1){let e=y();n(0,"div",144)(1,"div",145)(2,"div",146)(3,"h3",147),r(4),t(),n(5,"div",148)(6,"span",131),r(7),t(),n(8,"span",131),r(9),t()()(),n(10,"button",149)(11,"mat-icon"),r(12,"more_vert"),t()(),n(13,"mat-menu",null,3)(15,"button",73),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.editRule(o))}),n(16,"mat-icon"),r(17,"edit"),t(),r(18," Editar "),t(),n(19,"button",73),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.toggleRule(o))}),n(20,"mat-icon"),r(21),t(),r(22),t(),n(23,"button",74),f("click",function(){let o=v(e).$implicit,c=d(2);return h(c.deleteRule(o))}),n(24,"mat-icon"),r(25,"delete"),t(),r(26," Eliminar "),t()()(),n(27,"div",150)(28,"div")(29,"span",151),r(30,"Duraci\xF3n:"),t(),g(31,"br"),r(32),u(33,Jt,2,1,"div",132)(34,Kt,2,1,"div",133),t(),n(35,"div")(36,"span",151),r(37,"Precio:"),t(),g(38,"br"),u(39,Qt,2,1,"span",132)(40,Zt,2,1,"span",133),t(),n(41,"div")(42,"span",151),r(43,"D\xEDas:"),t(),g(44,"br"),r(45),t(),n(46,"div")(47,"span",151),r(48,"Horario:"),t(),g(49,"br"),r(50),t()()()}if(i&2){let e=m.$implicit,a=I(14),o=d(2);l(4),P(e.name),l(2),T("bg-"+o.getRuleTypeColor(e.rule_type)+"-100 text-"+o.getRuleTypeColor(e.rule_type)+"-800"),l(),_(" ",o.getRuleTypeLabel(e.rule_type)," "),l(),T("bg-"+o.getStatusColor(e.is_active)+"-100 text-"+o.getStatusColor(e.is_active)+"-800"),l(),_(" ",o.getStatusLabel(e.is_active)," "),l(),s("matMenuTriggerFor",a),l(11),P(e.is_active?"pause":"play_arrow"),l(),_(" ",e.is_active?"Desactivar":"Activar"," "),l(10),R(" ",e.min_duration_minutes,"-",e.max_duration_minutes||"\u221E"," min "),l(),s("ngIf",e.min_amount),l(),s("ngIf",e.daily_max_amount),l(5),s("ngIf",e.fixed_price),l(),s("ngIf",e.price_per_min),l(5),_(" ",o.getDaysLabel(e.days_of_week)," "),l(5),_(" ",o.formatTimeRange(e.start_time,e.end_time)," ")}}function ti(i,m){if(i&1){let e=y();n(0,"div",78)(1,"mat-icon",79),r(2,"rule"),t(),n(3,"h3",80),r(4,"No hay reglas de precios"),t(),n(5,"p",152),r(6,"Este perfil no tiene reglas de precios configuradas."),t(),n(7,"button",108),f("click",function(){v(e);let o=d(2);return h(o.addRule())}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Crear Primera Regla "),t()()}}function ii(i,m){if(i&1){let e=y();n(0,"div",98)(1,"div",99)(2,"div",100)(3,"div",101)(4,"mat-icon",13),r(5,"price_check"),t(),n(6,"div")(7,"h2",102),r(8," Gestionar Reglas de Precios "),t(),n(9,"p",66),r(10),t()()(),n(11,"button",103),f("click",function(){v(e);let o=d();return h(o.closeRulesModal())}),n(12,"mat-icon"),r(13,"close"),t()()(),n(14,"div",104)(15,"div",105)(16,"div",106)(17,"div",107)(18,"button",108),f("click",function(){v(e);let o=d();return h(o.addRule())}),n(19,"mat-icon"),r(20,"add"),t(),r(21," Nueva Regla "),t(),n(22,"span",66),r(23),t()()()(),n(24,"div",109)(25,"div",110)(26,"div",111)(27,"table",112),C(28,47),u(29,Tt,2,0,"th",113)(30,It,3,1,"td",114),E(),C(31,115),u(32,Dt,2,0,"th",113)(33,Ft,3,3,"td",114),E(),C(34,116),u(35,kt,2,0,"th",113)(36,Vt,6,4,"td",114),E(),C(37,117),u(38,At,2,0,"th",113)(39,Bt,4,2,"td",114),E(),C(40,118),u(41,jt,2,0,"th",113)(42,Lt,3,1,"td",114),E(),C(43,119),u(44,Ht,2,0,"th",113)(45,zt,3,1,"td",114),E(),C(46,54),u(47,qt,2,0,"th",113)(48,Gt,3,3,"td",114),E(),C(49,57),u(50,Wt,2,0,"th",120)(51,Ut,18,3,"td",121),E(),u(52,Yt,1,0,"tr",122)(53,Xt,1,0,"tr",123),t()(),n(54,"div",124),u(55,ei,51,18,"div",125),t()()(),n(56,"div",126)(57,"div",127)(58,"button",128),f("click",function(){v(e);let o=d();return h(o.closeRulesModal())}),r(59," Cerrar "),t()(),u(60,ti,11,0,"div",38),t()()()()}if(i&2){let e=d();l(10),P(e.selectedProfile==null?null:e.selectedProfile.name),l(13),N(" ",e.pricingRules.length," regla",e.pricingRules.length!==1?"s":""," configurada",e.pricingRules.length!==1?"s":""," "),l(4),s("dataSource",e.pricingRules),l(25),s("matHeaderRowDef",e.ruleColumns),l(),s("matRowDefColumns",e.ruleColumns),l(2),s("ngForOf",e.pricingRules),l(5),s("ngIf",e.pricingRules.length===0)}}function ni(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),_(" ",e.getErrorMessage("name")," ")}}function ri(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),_(" ",e.getErrorMessage("rule_type")," ")}}function ai(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(2);l(),_(" ",e.getErrorMessage("min_duration_minutes")," ")}}function oi(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(3);l(),_(" ",e.getErrorMessage("price_per_minute")," ")}}function li(i,m){if(i&1&&(n(0,"mat-form-field",27)(1,"mat-label"),r(2,"Precio por Minuto"),t(),g(3,"input",176),n(4,"span",163),r(5,"$\xA0"),t(),u(6,oi,2,1,"mat-error",36),t()),i&2){let e,a=d(2);l(6),s("ngIf",(e=a.ruleForm.get("price_per_minute"))==null?null:e.hasError("required"))}}function mi(i,m){if(i&1&&(n(0,"mat-error"),r(1),t()),i&2){let e=d(3);l(),_(" ",e.getErrorMessage("fixed_price")," ")}}function ci(i,m){if(i&1&&(n(0,"mat-form-field",27)(1,"mat-label"),r(2,"Precio Fijo"),t(),g(3,"input",177),n(4,"span",163),r(5,"$\xA0"),t(),u(6,mi,2,1,"mat-error",36),t()),i&2){let e,a=d(2);l(6),s("ngIf",(e=a.ruleForm.get("fixed_price"))==null?null:e.hasError("required"))}}function si(i,m){if(i&1){let e=y();n(0,"mat-checkbox",178),f("change",function(o){let c=v(e).$implicit,p=d(2);return h(p.onDayChange(o,c.value))}),r(1),t()}if(i&2){let e=m.$implicit,a=d(2);s("value",e.value)("checked",a.isDaySelected(e.value)),l(),_(" ",e.label," ")}}function di(i,m){if(i&1){let e=y();n(0,"div",82)(1,"div",153)(2,"h2",84),r(3),t(),n(4,"form",85),f("ngSubmit",function(){v(e);let o=d();return h(o.saveRule())}),n(5,"div",86)(6,"mat-form-field",27)(7,"mat-label"),r(8,"Nombre de la Regla"),t(),g(9,"input",154),u(10,ni,2,1,"mat-error",36),t(),n(11,"mat-form-field",27)(12,"mat-label"),r(13,"Tipo de Regla"),t(),n(14,"mat-select",155)(15,"mat-option",156),r(16,"Por Tiempo"),t(),n(17,"mat-option",157),r(18,"Precio Fijo"),t(),n(19,"mat-option",158),r(20,"Graduada"),t(),n(21,"mat-option",159),r(22,"Por Hora"),t()(),u(23,ri,2,1,"mat-error",36),t(),n(24,"mat-form-field",27)(25,"mat-label"),r(26,"Duraci\xF3n M\xEDnima (min)"),t(),g(27,"input",160),u(28,ai,2,1,"mat-error",36),t(),n(29,"mat-form-field",27)(30,"mat-label"),r(31,"Duraci\xF3n M\xE1xima (min)"),t(),g(32,"input",161),n(33,"mat-hint"),r(34,"Dejar vac\xEDo para sin l\xEDmite"),t()(),n(35,"mat-form-field",27)(36,"mat-label"),r(37,"Monto M\xE1ximo Diario"),t(),g(38,"input",162),n(39,"span",163),r(40,"$\xA0"),t(),n(41,"mat-hint"),r(42,"Monto m\xE1ximo a cobrar por d\xEDa completo (ej: $10.000)"),t()(),n(43,"mat-form-field",27)(44,"mat-label"),r(45,"Monto M\xEDnimo"),t(),g(46,"input",164),n(47,"span",163),r(48,"$\xA0"),t(),n(49,"mat-hint"),r(50,"Monto m\xEDnimo a cobrar independientemente del tiempo (ej: $500)"),t()(),n(51,"div",165)(52,"mat-checkbox",166),r(53," Monto m\xEDnimo como base despu\xE9s del tiempo m\xEDnimo "),t(),n(54,"mat-hint",167),r(55," Si est\xE1 activo, se cobrar\xE1 el monto m\xEDnimo hasta el tiempo m\xEDnimo y luego se sumar\xE1n los minutos adicionales. Ejemplo: $500 m\xEDnimo + 15 min m\xEDnimo \u2192 A 16 min = $525, A 17 min = $550 "),t()(),u(56,li,7,1,"mat-form-field",168)(57,ci,7,1,"mat-form-field",168),n(58,"mat-form-field",27)(59,"mat-label"),r(60,"Hora de Inicio"),t(),g(61,"input",169),n(62,"mat-hint"),r(63,"Dejar vac\xEDo para todo el d\xEDa"),t()(),n(64,"mat-form-field",27)(65,"mat-label"),r(66,"Hora de Fin"),t(),g(67,"input",170),n(68,"mat-hint"),r(69,"Dejar vac\xEDo para todo el d\xEDa"),t()()(),n(70,"div",171)(71,"label",172),r(72,"D\xEDas de la Semana"),t(),n(73,"div",173),u(74,si,2,3,"mat-checkbox",174),t(),n(75,"mat-hint"),r(76,"Seleccionar d\xEDas aplicables (opcional)"),t()(),n(77,"mat-form-field",92)(78,"mat-label"),r(79,"Prioridad"),t(),g(80,"input",175),n(81,"mat-hint"),r(82,"Las reglas con mayor prioridad se eval\xFAan primero"),t()(),n(83,"div",25)(84,"mat-checkbox",94),r(85," Regla activa "),t()(),n(86,"div",95)(87,"button",96),f("click",function(){v(e);let o=d();return h(o.cancelRuleEdit())}),r(88," Cancelar "),t(),n(89,"button",97),r(90),t()()()()()}if(i&2){let e,a,o,c,p,x=d();l(3),_(" ",x.editingRule?"Editar Regla de Precios":"Nueva Regla de Precios"," "),l(),s("formGroup",x.ruleForm),l(6),s("ngIf",(e=x.ruleForm.get("name"))==null?null:e.hasError("required")),l(13),s("ngIf",(a=x.ruleForm.get("rule_type"))==null?null:a.hasError("required")),l(5),s("ngIf",(o=x.ruleForm.get("min_duration_minutes"))==null?null:o.hasError("required")),l(28),s("ngIf",((c=x.ruleForm.get("rule_type"))==null?null:c.value)==="TIME_BASED"||((c=x.ruleForm.get("rule_type"))==null?null:c.value)==="HOURLY"),l(),s("ngIf",((p=x.ruleForm.get("rule_type"))==null?null:p.value)==="FIXED"),l(17),s("ngForOf",x.daysOfWeek),l(15),s("disabled",x.ruleForm.invalid),l(),_(" ",x.editingRule?"Actualizar":"Crear"," Regla ")}}var Ki=(()=>{class i{constructor(e,a,o,c,p,x){this.pricingProfileService=e,this.sectorService=a,this.fb=o,this.snackBar=c,this.dialog=p,this.confirmationService=x,this._unsubscribeAll=new A,this.pricingProfiles=[],this.sectors=[],this.loading=!1,this.error=null,this.totalItems=0,this.pageSize=10,this.currentPage=0,this.pageSizeOptions=[5,10,25,50],this.filters={sector_id:void 0,name:"",is_active:void 0},this.showForm=!1,this.editingProfile=null,this.showRulesModal=!1,this.showRuleForm=!1,this.selectedProfile=null,this.pricingRules=[],this.editingRule=null,this.selectedDays=[],this.daysOfWeek=[{value:0,label:"Domingo"},{value:1,label:"Lunes"},{value:2,label:"Martes"},{value:3,label:"Mi\xE9rcoles"},{value:4,label:"Jueves"},{value:5,label:"Viernes"},{value:6,label:"S\xE1bado"}],this.ruleColumns=["name","rule_type","duration","price","days","time","status","actions"],this.displayedColumns=["name","sector","active_from","active_to","status","rules_count","actions"],this.profileForm=this.createForm(),this.ruleForm=this.createRuleForm()}ngOnInit(){this.loadSectors(),this.loadPricingProfiles()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createForm(){return this.fb.group({sector_id:["",[w.required]],name:["",[w.required,w.minLength(2)]],description:[""],active_from:[new Date,[w.required]],active_to:[null],is_active:[!0]})}loadSectors(){this.sectorService.getSectors().pipe(S(this._unsubscribeAll)).subscribe({next:e=>{this.sectors=e.data?.data||e.data||[]},error:e=>{console.error("Error loading sectors:",e)}})}loadPricingProfiles(){this.loading=!0;let e={page:this.currentPage+1,per_page:this.pageSize};this.filters.name&&this.filters.name.trim()!==""&&(e.name=this.filters.name),this.filters.sector_id!==void 0&&(e.sector_id=this.filters.sector_id),this.filters.is_active!==void 0&&(e.is_active=this.filters.is_active),this.pricingProfileService.getPricingProfiles(e).pipe(S(this._unsubscribeAll)).subscribe({next:a=>{this.pricingProfiles=a.data?.data||[],this.totalItems=a.data?.total||0,this.loading=!1},error:a=>{this.error="Error al cargar perfiles de precios",this.loading=!1,console.error("Error loading pricing profiles:",a),this.snackBar.open("Error al cargar perfiles de precios","Cerrar",{duration:3e3})}})}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.loadPricingProfiles()}applyFilters(){this.currentPage=0,this.loadPricingProfiles()}clearFilters(){this.filters={sector_id:void 0,name:"",is_active:void 0},this.currentPage=0,this.loadPricingProfiles()}createProfile(){this.editingProfile=null,this.profileForm.reset(),this.profileForm.patchValue({active_from:new Date,is_active:!0}),this.showForm=!0}editProfile(e){this.editingProfile=e,this.profileForm.patchValue({sector_id:e.sector_id,name:e.name,description:e.description,active_from:new Date(e.active_from),active_to:e.active_to?new Date(e.active_to):null,is_active:e.is_active}),this.showForm=!0}saveProfile(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}let e=this.profileForm.value,a=V($({},e),{active_from:e.active_from.toISOString(),active_to:e.active_to?e.active_to.toISOString():null});(this.editingProfile?this.pricingProfileService.updatePricingProfile(this.editingProfile.id,a):this.pricingProfileService.createPricingProfile(a)).pipe(S(this._unsubscribeAll)).subscribe({next:c=>{this.snackBar.open(this.editingProfile?"Perfil actualizado exitosamente":"Perfil creado exitosamente","Cerrar",{duration:3e3}),this.showForm=!1,this.loadPricingProfiles()},error:c=>{console.error("Error saving profile:",c),this.snackBar.open("Error al guardar perfil","Cerrar",{duration:3e3})}})}cancelEdit(){this.showForm=!1,this.editingProfile=null,this.profileForm.reset()}deleteProfile(e){let a=e.pricing_rules?.length||0,o=`\xBFEst\xE1 seguro de eliminar el perfil "${e.name}"?`;a>0&&(o+=`

\u26A0\uFE0F Tambi\xE9n se eliminar\xE1n ${a} regla${a>1?"s":""} de precios asociada${a>1?"s":""}.`),this.confirmationService.open({title:"Eliminar Perfil de Precios",message:o,icon:{show:!0,name:"heroicons_outline:exclamation-triangle",color:"warn"},actions:{confirm:{show:!0,label:"Eliminar Todo",color:"warn"},cancel:{show:!0,label:"Cancelar"}}}).afterClosed().subscribe(p=>{p==="confirmed"&&this.pricingProfileService.deletePricingProfile(e.id).pipe(S(this._unsubscribeAll)).subscribe({next:x=>{let b=x.message||"Perfil eliminado exitosamente";this.snackBar.open(b,"Cerrar",{duration:4e3}),this.loadPricingProfiles()},error:x=>{console.error("Error deleting profile:",x),this.snackBar.open("Error al eliminar perfil","Cerrar",{duration:3e3})}})})}toggleProfile(e){this.pricingProfileService.togglePricingProfile(e.id,!e.is_active).pipe(S(this._unsubscribeAll)).subscribe({next:a=>{this.snackBar.open(e.is_active?"Perfil desactivado":"Perfil activado","Cerrar",{duration:3e3}),this.loadPricingProfiles()},error:a=>{console.error("Error toggling profile:",a),this.snackBar.open("Error al cambiar estado del perfil","Cerrar",{duration:3e3})}})}getSectorName(e){let a=this.sectors.find(o=>o.id===e);return a?a.name:"N/A"}formatDate(e){return new Date(e).toLocaleDateString("es-CL")}getStatusLabel(e){return e?"Activo":"Inactivo"}getStatusColor(e){return e?"green":"gray"}getErrorMessage(e){let a=this.profileForm.get(e);return a?.hasError("required")?"Este campo es requerido":a?.hasError("minlength")?`M\xEDnimo ${a.errors?.minlength.requiredLength} caracteres`:""}createRuleForm(){return this.fb.group({name:["",w.required],rule_type:["TIME_BASED",w.required],min_duration_minutes:[0,w.required],max_duration_minutes:[null],daily_max_amount:[null],min_amount:[null],min_amount_is_base:[!1],price_per_minute:[0,w.required],fixed_price:[0],start_time:[""],end_time:[""],priority:[1],is_active:[!0]})}manageRules(e){this.selectedProfile=e,this.showRulesModal=!0,this.loadPricingRules(e.id)}closeRulesModal(){this.showRulesModal=!1,this.selectedProfile=null,this.pricingRules=[],this.showRuleForm=!1,this.editingRule=null}loadPricingRules(e){this.pricingProfileService.getPricingRules(e).pipe(S(this._unsubscribeAll)).subscribe({next:a=>{console.log("Respuesta del servicio de reglas:",a),this.pricingRules=a.data||[],console.log("Reglas cargadas:",this.pricingRules)},error:a=>{console.error("Error loading pricing rules:",a),this.snackBar.open("Error al cargar reglas de precios","Cerrar",{duration:3e3})}})}addRule(){this.editingRule=null,this.selectedDays=[],this.ruleForm.reset({name:"",rule_type:"TIME_BASED",min_duration_minutes:0,max_duration_minutes:null,daily_max_amount:null,min_amount:null,min_amount_is_base:!1,price_per_minute:0,fixed_price:0,start_time:"",end_time:"",priority:1,is_active:!0}),this.showRuleForm=!0}editRule(e){console.log("Editando regla:",e),console.log("start_time raw:",e.start_time),console.log("end_time raw:",e.end_time),console.log("start_min:",e.start_min),console.log("end_min:",e.end_min),this.editingRule=e,this.selectedDays=e.days_of_week||[];let a="",o="";e.start_time?(a=this.formatTimeForInput(e.start_time),console.log("start_time formateado:",a)):e.start_min!==void 0&&e.start_min!==null&&(a=this.minutesToTimeString(e.start_min),console.log("start_min convertido:",a)),e.end_time?(o=this.formatTimeForInput(e.end_time),console.log("end_time formateado:",o)):e.end_min!==void 0&&e.end_min!==null&&(o=this.minutesToTimeString(e.end_min),console.log("end_min convertido:",o));let c={name:e.name||"",rule_type:e.rule_type||"TIME_BASED",min_duration_minutes:e.min_duration_minutes||0,max_duration_minutes:e.max_duration_minutes||null,daily_max_amount:e.daily_max_amount||null,min_amount:e.min_amount||null,min_amount_is_base:e.min_amount_is_base||!1,price_per_minute:e.price_per_minute||e.price_per_min||0,fixed_price:e.fixed_price||0,start_time:a,end_time:o,priority:e.priority||1,is_active:e.is_active!==void 0?e.is_active:!0};console.log("Datos del formulario antes de setValue:",c),console.log("startTime final:",a),console.log("endTime final:",o),this.ruleForm.setValue(c),a&&this.ruleForm.get("start_time")?.setValue(a,{emitEvent:!1}),o&&this.ruleForm.get("end_time")?.setValue(o,{emitEvent:!1}),console.log("Estado del formulario despu\xE9s de setValue:",this.ruleForm.value),console.log("Formulario v\xE1lido:",this.ruleForm.valid),console.log("Campo name:",this.ruleForm.get("name")?.value),console.log("Campo rule_type:",this.ruleForm.get("rule_type")?.value),console.log("Campo start_time:",this.ruleForm.get("start_time")?.value),console.log("Campo end_time:",this.ruleForm.get("end_time")?.value),this.showRuleForm=!0,setTimeout(()=>{console.log("Estado del formulario despu\xE9s de mostrar:",this.ruleForm.value),console.log("start_time control:",this.ruleForm.get("start_time")?.value),console.log("end_time control:",this.ruleForm.get("end_time")?.value)},100)}minutesToTimeString(e){let a=Math.floor(e/60),o=e%60;return`${a.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}formatTimeForInput(e){if(!e)return"";let a=String(e).trim();if(!a||a==="null"||a==="undefined")return"";if(/^\d{2}:\d{2}$/.test(a))return a;let o=a.match(/^(\d{1,2}):(\d{2})(?::(\d{2}))?$/);if(o){let c=o[1].padStart(2,"0"),p=o[2];return`${c}:${p}`}if(a.includes("T")||a.includes(" "))try{let c=new Date(a);if(!isNaN(c.getTime())){let p=c.getHours().toString().padStart(2,"0"),x=c.getMinutes().toString().padStart(2,"0");return`${p}:${x}`}}catch(c){console.warn("Error parsing time string:",a,c)}return console.warn("No se pudo formatear el tiempo:",a),""}formatTimeForBackend(e){if(!e||e.trim()==="")return null;if(/^\d{2}:\d{2}$/.test(e))return e;if(/^\d{1}:\d{2}$/.test(e)){let o=e.split(":");return`${o[0].padStart(2,"0")}:${o[1]}`}let a=e.match(/^(\d{1,2}):(\d{2})(?::\d{2})?$/);if(a){let o=a[1].padStart(2,"0"),c=a[2];return`${o}:${c}`}return null}saveRule(){if(this.ruleForm.valid&&this.selectedProfile){let e=this.ruleForm.value.rule_type==="HOURLY"?"TIME_BASED":this.ruleForm.value.rule_type,a={profile_id:this.selectedProfile.id,name:this.ruleForm.value.name,rule_type:e,min_duration_minutes:this.ruleForm.value.min_duration_minutes,max_duration_minutes:this.ruleForm.value.max_duration_minutes,daily_max_amount:this.ruleForm.value.daily_max_amount,min_amount:this.ruleForm.value.min_amount,min_amount_is_base:this.ruleForm.value.min_amount_is_base||!1,price_per_minute:this.ruleForm.value.price_per_minute,fixed_price:this.ruleForm.value.fixed_price,days_of_week:this.selectedDays,start_time:this.formatTimeForBackend(this.ruleForm.value.start_time),end_time:this.formatTimeForBackend(this.ruleForm.value.end_time),priority:this.ruleForm.value.priority,is_active:this.ruleForm.value.is_active};console.log("Datos a enviar al backend:",a),console.log("ID de la regla:",this.editingRule?.id),this.editingRule?this.pricingProfileService.updatePricingRule(this.editingRule.id,a).pipe(S(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla actualizada exitosamente","Cerrar",{duration:3e3}),this.cancelRuleEdit(),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error updating rule:",o),console.error("Error details:",o.error),this.snackBar.open("Error al actualizar regla: "+(o.error?.message||o.message),"Cerrar",{duration:5e3})}}):this.pricingProfileService.createPricingRule(a).pipe(S(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla creada exitosamente","Cerrar",{duration:3e3}),this.cancelRuleEdit(),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error creating rule:",o),this.snackBar.open("Error al crear regla","Cerrar",{duration:3e3})}})}}cancelRuleEdit(){this.showRuleForm=!1,this.editingRule=null,this.selectedDays=[],this.ruleForm.reset()}deleteRule(e){this.confirmationService.open({title:"Eliminar Regla",message:`\xBFEst\xE1s seguro de que quieres eliminar la regla "${e.name}"?`,actions:{confirm:{show:!0,label:"Eliminar",color:"warn"},cancel:{show:!0,label:"Cancelar"}}}).afterClosed().subscribe(a=>{a==="confirmed"&&this.pricingProfileService.deletePricingRule(e.id).pipe(S(this._unsubscribeAll)).subscribe({next:o=>{this.snackBar.open("Regla eliminada exitosamente","Cerrar",{duration:3e3}),this.loadPricingRules(this.selectedProfile.id)},error:o=>{console.error("Error deleting rule:",o),this.snackBar.open("Error al eliminar regla","Cerrar",{duration:3e3})}})})}toggleRule(e){this.pricingProfileService.togglePricingRule(e.id,!e.is_active).pipe(S(this._unsubscribeAll)).subscribe({next:a=>{this.snackBar.open(e.is_active?"Regla desactivada":"Regla activada","Cerrar",{duration:3e3}),this.loadPricingRules(this.selectedProfile.id)},error:a=>{console.error("Error toggling rule:",a),this.snackBar.open("Error al cambiar estado de la regla","Cerrar",{duration:3e3})}})}onDayChange(e,a){e.checked?this.selectedDays.includes(a)||this.selectedDays.push(a):this.selectedDays=this.selectedDays.filter(o=>o!==a)}isDaySelected(e){return this.selectedDays.includes(e)}getRuleTypeLabel(e){return{TIME_BASED:"Por Tiempo",FIXED:"Precio Fijo",GRADUATED:"Graduada",HOURLY:"Por Hora"}[e]||e}getDaysLabel(e){if(!e||e.length===0)return"Todos";let a=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];return e.map(o=>a[o]).join(", ")}getRuleTypeColor(e){return{TIME_BASED:"blue",FIXED:"green",GRADUATED:"purple",HOURLY:"blue"}[e]||"gray"}formatTimeRange(e,a){if(!e||!a)return"Todo el d\xEDa";try{let o=e,c=a;if(e.includes("T")||e.includes(" ")){let p=new Date(e);isNaN(p.getTime())||(o=p.toTimeString().substring(0,5))}else e.includes(":")&&(o=e.substring(0,5));if(a.includes("T")||a.includes(" ")){let p=new Date(a);isNaN(p.getTime())||(c=p.toTimeString().substring(0,5))}else a.includes(":")&&(c=a.substring(0,5));return`${o} - ${c}`}catch(o){return console.error("Error formatting time range:",o),"Todo el d\xEDa"}}getActiveProfilesCount(){return this.pricingProfiles.filter(e=>e.is_active).length}getInactiveProfilesCount(){return this.pricingProfiles.filter(e=>!e.is_active).length}getTotalRulesCount(){return this.pricingProfiles.reduce((e,a)=>e+(a.pricing_rules?.length||0),0)}getTimeValue(e){if(!e||e===""||e===null)return"";let a=this.formatTimeForInput(e);return a==="00:00"?"":a}onTimeChange(e,a){let o=a.target.value;o===""||o===null||o==="00:00"?this.ruleForm.get(e)?.setValue(""):this.ruleForm.get(e)?.setValue(o)}static{this.\u0275fac=function(a){return new(a||i)(M(Qe),M(Ke),M(ge),M(be),M(z),M(ie))}}static{this.\u0275cmp=O({type:i,selectors:[["app-pricing-profiles"]],decls:97,vars:20,consts:[["actionMenu","matMenu"],["activeFromPicker",""],["activeToPicker",""],["ruleActionMenu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-6"],[1,"p-6"],[1,"flex","items-center"],[1,"p-3","bg-blue-100","rounded-full"],[1,"text-blue-600"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-blue-600"],[1,"p-3","bg-green-100","rounded-full"],[1,"text-green-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"p-3","bg-gray-100","rounded-full"],[1,"text-2xl","font-bold","text-gray-600"],[1,"p-3","bg-purple-100","rounded-full"],[1,"text-purple-600"],[1,"text-2xl","font-bold","text-purple-600"],[1,"mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["appearance","outline"],["matInput","","placeholder","Nombre del perfil",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","justify-end","gap-2","mt-4"],["mat-stroked-button","",1,"rounded-sm",3,"click"],["class","flex justify-center items-center h-64",4,"ngIf"],["class","mb-6",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","","class","mt-4",3,"length","pageSize","pageSizeOptions","pageIndex","page",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","modal-overlay bg-black bg-opacity-50 flex items-center justify-center",4,"ngIf"],["class","modal-overlay bg-black bg-opacity-50 flex items-center justify-center p-2 sm:p-4",4,"ngIf"],[1,"flex","justify-center","items-center","h-64"],["diameter","50"],["type","error",3,"dismissible"],[1,"p-0"],[1,"overflow-x-auto"],["mat-table","",1,"w-full","mat-elevation-z2",2,"width","100%","table-layout","fixed",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","style","width: 20%;",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","sector"],["mat-header-cell","","style","width: 15%;",4,"matHeaderCellDef"],["matColumnDef","active_from"],["matColumnDef","active_to"],["matColumnDef","status"],["mat-header-cell","","style","width: 10%;",4,"matHeaderCellDef"],["matColumnDef","rules_count"],["matColumnDef","actions"],["mat-header-cell","","class","text-right","style","width: 15%;",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","20%"],["mat-cell",""],[1,"font-medium","text-gray-900"],["class","text-sm text-gray-600",4,"ngIf"],[1,"text-sm","text-gray-600"],["mat-header-cell","",2,"width","15%"],["mat-header-cell","",2,"width","10%"],[1,"px-2","py-1","rounded","text-xs","font-medium"],["mat-header-cell","",1,"text-right",2,"width","15%"],["mat-cell","",1,"text-right"],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"text-red-600",3,"click"],["mat-header-row",""],["mat-row",""],["showFirstLastButtons","",1,"mt-4",3,"page","length","pageSize","pageSizeOptions","pageIndex"],[1,"text-center","py-12"],[1,"text-6xl","text-gray-400","mb-4"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],[1,"modal-overlay","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-2xl","mx-4","max-h-screen","overflow-y-auto"],[1,"text-xl","font-semibold","text-gray-900","mb-4"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],["formControlName","sector_id"],["matInput","","formControlName","name","placeholder","Nombre del perfil"],["matInput","","formControlName","active_from",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","active_to",3,"matDatepicker"],["appearance","outline",1,"w-full","mb-4"],["matInput","","formControlName","description","rows","3","placeholder","Descripci\xF3n del perfil"],["formControlName","is_active"],[1,"flex","justify-end","gap-3"],["type","button","mat-stroked-button","",1,"rounded-sm",3,"click"],["type","submit","mat-raised-button","","color","primary",1,"rounded-sm",3,"disabled"],[1,"modal-overlay","bg-black","bg-opacity-50","flex","items-center","justify-center","p-2","sm:p-4"],[1,"bg-white","rounded-lg","shadow-xl","w-full","max-w-[95vw]","sm:max-w-[90vw]","md:max-w-[85vw]","lg:max-w-[80vw]","xl:max-w-[75vw]","max-h-[95vh]","flex","flex-col"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","bg-gray-50","rounded-t-lg"],[1,"flex","items-center","gap-3"],[1,"text-xl","font-semibold","text-gray-900"],["mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"flex-1","overflow-hidden","flex","flex-col"],[1,"p-6","border-b","border-gray-200","bg-white"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],["mat-raised-button","","color","primary",3,"click"],[1,"flex-1","overflow-auto","p-2","sm:p-4","lg:p-6"],[1,"bg-white","rounded-lg","border","border-gray-200","overflow-hidden"],[1,"hidden","md:block"],["mat-table","",1,"w-full",3,"dataSource"],["mat-header-cell","","class","font-semibold text-gray-700",4,"matHeaderCellDef"],["mat-cell","","class","py-4",4,"matCellDef"],["matColumnDef","rule_type"],["matColumnDef","duration"],["matColumnDef","price"],["matColumnDef","days"],["matColumnDef","time"],["mat-header-cell","","class","font-semibold text-gray-700 text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right py-4",4,"matCellDef"],["mat-header-row","","class","bg-gray-50",4,"matHeaderRowDef"],["mat-row","","class","hover:bg-gray-50",4,"matRowDef","matRowDefColumns"],[1,"md:hidden"],["class","border-b border-gray-200 p-4 last:border-b-0",4,"ngFor","ngForOf"],[1,"p-6","border-t","border-gray-200","bg-gray-50","rounded-b-lg"],[1,"flex","justify-end"],["mat-button","",1,"mr-3",3,"click"],["mat-header-cell","",1,"font-semibold","text-gray-700"],["mat-cell","",1,"py-4"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],["class","text-green-600 font-medium",4,"ngIf"],["class","text-blue-600 font-medium",4,"ngIf"],[1,"text-green-600","font-medium"],[1,"text-blue-600","font-medium"],[1,"text-sm","font-medium","text-gray-900"],["class","text-green-600",4,"ngIf"],["class","text-blue-600",4,"ngIf"],["mat-header-cell","",1,"font-semibold","text-gray-700","text-right"],["mat-cell","",1,"text-right","py-4"],["mat-icon-button","",1,"text-gray-500","hover:text-gray-700",3,"matMenuTriggerFor"],["mat-header-row","",1,"bg-gray-50"],["mat-row","",1,"hover:bg-gray-50"],[1,"border-b","border-gray-200","p-4","last:border-b-0"],[1,"flex","items-start","justify-between","mb-3"],[1,"flex-1"],[1,"font-medium","text-gray-900","text-sm"],[1,"flex","items-center","gap-2","mt-1"],["mat-icon-button","",1,"text-gray-500",3,"matMenuTriggerFor"],[1,"grid","grid-cols-2","gap-3","text-xs","text-gray-600"],[1,"font-medium"],[1,"text-gray-600","mb-6"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-4xl","mx-4","max-h-screen","overflow-y-auto"],["matInput","","formControlName","name","placeholder","Ej: Tarifa est\xE1ndar"],["formControlName","rule_type"],["value","TIME_BASED"],["value","FIXED"],["value","GRADUATED"],["value","HOURLY"],["matInput","","formControlName","min_duration_minutes","type","number","min","0"],["matInput","","formControlName","max_duration_minutes","type","number","min","0"],["matInput","","formControlName","daily_max_amount","type","number","min","0","step","0.01"],["matPrefix",""],["matInput","","formControlName","min_amount","type","number","min","0","step","0.01"],[1,"col-span-full"],["formControlName","min_amount_is_base"],[1,"block","mt-1"],["appearance","outline",4,"ngIf"],["matInput","","formControlName","start_time","type","time"],["matInput","","formControlName","end_time","type","time"],[1,"mb-4"],[1,"text-sm","font-medium","text-gray-700","mb-2","block"],[1,"flex","flex-wrap","gap-2"],[3,"value","checked","change",4,"ngFor","ngForOf"],["matInput","","formControlName","priority","type","number","min","1","value","1"],["matInput","","formControlName","price_per_minute","type","number","min","0","step","0.01"],["matInput","","formControlName","fixed_price","type","number","min","0","step","0.01"],[3,"change","value","checked"]],template:function(a,o){a&1&&(n(0,"div",4)(1,"div",5)(2,"div")(3,"h1",6),r(4,"Perfiles de Precios"),t(),n(5,"p",7),r(6,"Gestiona los perfiles de precios por sector"),t()(),n(7,"button",8),f("click",function(){return o.createProfile()}),n(8,"mat-icon"),r(9,"add"),t(),r(10," Nuevo Perfil "),t()(),n(11,"div",9)(12,"mat-card")(13,"mat-card-content",10)(14,"div",11)(15,"div",12)(16,"mat-icon",13),r(17,"price_check"),t()(),n(18,"div",14)(19,"p",15),r(20,"Total Perfiles"),t(),n(21,"p",16),r(22),t()()()()(),n(23,"mat-card")(24,"mat-card-content",10)(25,"div",11)(26,"div",17)(27,"mat-icon",18),r(28,"check_circle"),t()(),n(29,"div",14)(30,"p",15),r(31,"Activos"),t(),n(32,"p",19),r(33),t()()()()(),n(34,"mat-card")(35,"mat-card-content",10)(36,"div",11)(37,"div",20)(38,"mat-icon",7),r(39,"pause_circle"),t()(),n(40,"div",14)(41,"p",15),r(42,"Inactivos"),t(),n(43,"p",21),r(44),t()()()()(),n(45,"mat-card")(46,"mat-card-content",10)(47,"div",11)(48,"div",22)(49,"mat-icon",23),r(50,"rule"),t()(),n(51,"div",14)(52,"p",15),r(53,"Total Reglas"),t(),n(54,"p",24),r(55),t()()()()()(),n(56,"mat-card",25)(57,"mat-card-content",10)(58,"div",26)(59,"mat-form-field",27)(60,"mat-label"),r(61,"Buscar por Nombre"),t(),n(62,"input",28),k("ngModelChange",function(p){return F(o.filters.name,p)||(o.filters.name=p),p}),t()(),n(63,"mat-form-field",27)(64,"mat-label"),r(65,"Sector"),t(),n(66,"mat-select",29),k("ngModelChange",function(p){return F(o.filters.sector_id,p)||(o.filters.sector_id=p),p}),n(67,"mat-option",30),r(68,"Todos"),t(),u(69,Ze,2,2,"mat-option",31),t()(),n(70,"mat-form-field",27)(71,"mat-label"),r(72,"Estado"),t(),n(73,"mat-select",29),k("ngModelChange",function(p){return F(o.filters.is_active,p)||(o.filters.is_active=p),p}),n(74,"mat-option",30),r(75,"Todos"),t(),n(76,"mat-option",30),r(77,"Activo"),t(),n(78,"mat-option",30),r(79,"Inactivo"),t()()()(),n(80,"div",32)(81,"button",33),f("click",function(){return o.clearFilters()}),n(82,"mat-icon"),r(83,"clear"),t(),r(84," Limpiar "),t(),n(85,"button",8),f("click",function(){return o.applyFilters()}),n(86,"mat-icon"),r(87,"search"),t(),r(88," Filtrar "),t()()()(),u(89,et,2,0,"div",34)(90,tt,3,2,"div",35)(91,ht,27,3,"mat-card",36)(92,Pt,1,4,"mat-paginator",37)(93,Ct,11,0,"div",38),t(),u(94,Mt,45,13,"div",39)(95,ii,61,9,"div",40)(96,di,91,10,"div",39)),a&2&&(l(22),P(o.pricingProfiles.length),l(11),P(o.getActiveProfilesCount()),l(11),P(o.getInactiveProfilesCount()),l(11),P(o.getTotalRulesCount()),l(7),D("ngModel",o.filters.name),l(4),D("ngModel",o.filters.sector_id),l(),s("value",void 0),l(2),s("ngForOf",o.sectors),l(4),D("ngModel",o.filters.is_active),l(),s("value",void 0),l(2),s("value",!0),l(2),s("value",!1),l(11),s("ngIf",o.loading),l(),s("ngIf",o.error),l(),s("ngIf",!o.loading),l(),s("ngIf",!o.loading&&o.pricingProfiles.length>0),l(),s("ngIf",!o.loading&&o.pricingProfiles.length===0),l(),s("ngIf",o.showForm),l(),s("ngIf",o.showRulesModal),l(),s("ngIf",o.showRuleForm))},dependencies:[L,B,j,ve,de,le,ue,me,ce,fe,_e,pe,xe,se,Z,K,Q,te,ee,Je,Ye,Xe,ze,Re,Ve,Be,Ae,$e,je,Oe,Ne,Le,He,J,X,q,W,G,U,Y,Pe,he,ke,Fe,H,Ee,Ce,Se,Ge,qe,We,Ue,oe,re,ne,ae,De,Me,Te,Ie,we,ye],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed!important;inset:0 0 0 280px!important;z-index:250!important}@media (max-width: 768px){.modal-overlay[_ngcontent-%COMP%]{left:0!important}}.rules-modal[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden}.rules-modal[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{background-color:#f9fafb}.rules-modal[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]:hover{background-color:#f3f4f6}.rules-modal[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .rules-modal[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{padding:16px 12px}.rule-form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.rule-form[_ngcontent-%COMP%]   .days-selector[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}.rule-form[_ngcontent-%COMP%]   .day-chip[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.rule-form[_ngcontent-%COMP%]   .day-chip.selected[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.rule-form[_ngcontent-%COMP%]   .day-chip[_ngcontent-%COMP%]:hover{background-color:#e5e7eb}@media (max-width: 768px){.rules-modal[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{font-size:14px}.rules-modal[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%], .rules-modal[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{padding:12px 8px}}"]})}}return i})();export{Ki as PricingProfilesComponent};
