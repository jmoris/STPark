import{a as h}from"./chunk-VKB6BRO6.js";import{d as u}from"./chunk-7OGW3PNS.js";import{_ as d,da as l}from"./chunk-BSJZAB7M.js";var w=(()=>{class a{constructor(t){this.http=t,this.baseUrl=`${h.apiUrl}/reports`}getDashboard(t){let r={};return t&&(r.date=t),this.http.get(`${this.baseUrl}/dashboard`,{params:r})}getSalesReport(t={}){return this.http.get(`${this.baseUrl}/sales`,{params:t})}getPaymentsReport(t={}){return this.http.get(`${this.baseUrl}/payments`,{params:t})}getDebtsReport(t={}){return this.http.get(`${this.baseUrl}/debts`,{params:t})}getOperatorReport(t={}){return this.http.get(`${this.baseUrl}/operator`,{params:t})}getSessionsReport(t={}){return this.http.get(`${this.baseUrl}/sessions`,{params:t})}formatAmount(t){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0}).format(t)}formatDate(t){let r=typeof t=="string"?new Date(t):t;return new Intl.DateTimeFormat("es-CL",{year:"numeric",month:"short",day:"numeric"}).format(r)}exportToPdf(t,r={}){let c=`${this.baseUrl}/${t}/pdf`,s={};Object.keys(r).forEach(n=>{r[n]!==void 0&&r[n]!==null&&r[n]!==""&&(s[n]=r[n])}),this.http.get(c,{params:s,responseType:"blob"}).subscribe({next:n=>{let i=window.URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=`reporte-${t}-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i)},error:n=>{console.error("Error al descargar el PDF:",n)}})}exportToCSV(t,r){if(!t||t.length===0){console.warn("No data to export");return}let c=["ID","Placa","Sector","Operador","Fecha Inicio","Fecha Fin","Duraci\xF3n","Monto Total","M\xE9todo de Pago"],s=t.map(e=>{let p=e.payments&&e.payments.length>0?e.payments.map(m=>`${m.method}: $${m.amount}`).join(", "):"Sin pago";return[e.id||"",e.plate||"",e.sector||"N/A",e.operator||"N/A",e.started_at?new Date(e.started_at).toLocaleString("es-CL"):"",e.ended_at?new Date(e.ended_at).toLocaleString("es-CL"):"",e.duration_formatted||`${e.duration_minutes}m`,`$${this.formatNumber(e.amount||0)}`,p]}),n=[c.join(","),...s.map(e=>e.map(p=>`"${p}"`).join(","))].join(`
`),i=new Blob(["\uFEFF"+n],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),b=URL.createObjectURL(i);o.setAttribute("href",b),o.setAttribute("download",`${r}_${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}formatNumber(t){return new Intl.NumberFormat("es-CL",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}static{this.\u0275fac=function(r){return new(r||a)(l(u))}}static{this.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{w as a};
