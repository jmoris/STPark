import{a as B}from"./chunk-CDJ3YU4S.js";import{a as qt}from"./chunk-N3LDMRIB.js";import{a as Ft}from"./chunk-ZMFSOZJA.js";import{c as Dt}from"./chunk-ICPS6N2F.js";import{a as Lt}from"./chunk-GQXICOHE.js";import{a as Et,b as kt,c as It,d as me,e as wt,f as Tt,g as Pt}from"./chunk-TU7IT4N6.js";import{a as _t,b as ft,c as ht,d as gt,e as bt,f as vt,g as St,h as Ct,i as Mt,j as yt,k as xt}from"./chunk-Y6UNS2UZ.js";import{a as At,c as Ot,f as Rt}from"./chunk-N7KP3IEB.js";import{d as pt}from"./chunk-EEUJEGPN.js";import{a as mt,b as ut}from"./chunk-FSRW5HPF.js";import{a as Z,b as Y,c as et,e as J,f as K,g as X,h as T}from"./chunk-65NYBKEE.js";import{a as rt,b as nt,c as dt,d as lt}from"./chunk-IDWAZBHT.js";import"./chunk-FSA3IEFI.js";import{a as re,b as ne}from"./chunk-POSCZER2.js";import{f as $e}from"./chunk-ECYJLMJT.js";import"./chunk-VKB6BRO6.js";import{b as ot,c as at}from"./chunk-IMRKXFOQ.js";import{d as V,e as j}from"./chunk-5Q7CCL6V.js";import{a as st,b as ct}from"./chunk-CWSZZ2DY.js";import{b as D,e as tt,j as A,k as O}from"./chunk-K3BNOLHS.js";import{b as F,f as q,g as $,h as ee,j as L,k as te,l as ie,u as oe,v as ae,z as N}from"./chunk-ZTFUS4RN.js";import{$ as Je,H as Qe,K as Ze,Q as be,Z as Ye,aa as Ke,fa as Q,j as Ue,ka as Xe,la as R,na as it,oa as P}from"./chunk-QQQ5XT6I.js";import"./chunk-YXFY4UXK.js";import{d as He}from"./chunk-FFRRSTTN.js";import"./chunk-EARUC3FY.js";import{l as ce,m as ze,s as w}from"./chunk-BAM5RHC5.js";import{$ as Te,$b as u,Da as _e,Db as fe,Eb as m,Fb as Ve,Gb as H,Ja as Pe,Lc as Ge,Na as Fe,Pb as o,Pc as U,Qb as i,Qc as ge,Rb as z,Sb as E,Tb as k,U as G,Vb as x,ba as pe,bb as d,bc as p,cb as b,cc as je,dc as Be,ea as S,f as we,fc as de,gb as qe,gc as le,hc as se,lc as We,mc as n,nc as I,oa as C,oc as v,pa as M,pb as y,qb as Le,rc as f,sc as h,tc as g,ua as De,uc as he,va as Ae,vb as Ne,wb as _,ya as Oe,za as Re}from"./chunk-MLNNMN4J.js";import{a as ke,b as Ie}from"./chunk-TSRGIXR5.js";function Ht(a,c){if(a&1&&(o(0,"mat-option",6),n(1),i()),a&2){let e=c.$implicit;m("value",e.id),d(),v(" ",e.name," ")}}function Ut(a,c){if(a&1&&(o(0,"mat-option",6),n(1),i()),a&2){let e=c.$implicit;m("value",e.id),d(),v(" ",e.name," ")}}var jt=(()=>{class a{constructor(e,r,t){this.dialogRef=e,this.data=r,this.shiftService=t,this.request={operator_id:0,opening_float:0,sector_id:void 0,device_id:void 0,notes:""},this.loading=!1}onCancel(){this.dialogRef.close()}onSave(){if(!this.request.operator_id||this.request.opening_float<=0){alert("Por favor complete todos los campos requeridos");return}this.loading=!0,this.shiftService.openShift(this.request).subscribe({next:e=>{e.success?this.dialogRef.close(!0):(alert(e.message||"Error al abrir el turno"),this.loading=!1)},error:e=>{console.error("Error opening shift:",e),alert("Error al abrir el turno"),this.loading=!1}})}static{this.\u0275fac=function(r){return new(r||a)(b(Z),b(Y),b(B))}}static{this.\u0275cmp=y({type:a,selectors:[["app-open-shift-modal"]],decls:33,vars:10,consts:[["mat-dialog-title",""],["appearance","outline",1,"full-width"],["name","operator_id","required","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","name","opening_float","required","","min","0","step","0.01",3,"ngModelChange","ngModel"],["name","sector_id",3,"ngModelChange","ngModel"],[3,"value"],["matInput","","name","device_id",3,"ngModelChange","ngModel"],["matInput","","name","notes","rows","3",3,"ngModelChange","ngModel"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(r,t){r&1&&(o(0,"h2",0),n(1,"Abrir Turno"),i(),o(2,"mat-dialog-content")(3,"form")(4,"mat-form-field",1)(5,"mat-label"),n(6,"Operador *"),i(),o(7,"mat-select",2),g("ngModelChange",function(l){return h(t.request.operator_id,l)||(t.request.operator_id=l),l}),_(8,Ht,2,2,"mat-option",3),i()(),o(9,"mat-form-field",1)(10,"mat-label"),n(11,"Fondo Inicial *"),i(),o(12,"input",4),g("ngModelChange",function(l){return h(t.request.opening_float,l)||(t.request.opening_float=l),l}),i()(),o(13,"mat-form-field",1)(14,"mat-label"),n(15,"Sector"),i(),o(16,"mat-select",5),g("ngModelChange",function(l){return h(t.request.sector_id,l)||(t.request.sector_id=l),l}),o(17,"mat-option",6),n(18,"Ninguno"),i(),_(19,Ut,2,2,"mat-option",3),i()(),o(20,"mat-form-field",1)(21,"mat-label"),n(22,"Dispositivo"),i(),o(23,"input",7),g("ngModelChange",function(l){return h(t.request.device_id,l)||(t.request.device_id=l),l}),i()(),o(24,"mat-form-field",1)(25,"mat-label"),n(26,"Notas"),i(),o(27,"textarea",8),g("ngModelChange",function(l){return h(t.request.notes,l)||(t.request.notes=l),l}),i()()()(),o(28,"mat-dialog-actions",9)(29,"button",10),u("click",function(){return t.onCancel()}),n(30,"Cancelar"),i(),o(31,"button",11),u("click",function(){return t.onSave()}),n(32),i()()),r&2&&(d(7),f("ngModel",t.request.operator_id),d(),m("ngForOf",t.data.operators),d(4),f("ngModel",t.request.opening_float),d(4),f("ngModel",t.request.sector_id),d(),m("value",void 0),d(2),m("ngForOf",t.data.sectors),d(4),f("ngModel",t.request.device_id),d(4),f("ngModel",t.request.notes),d(4),m("disabled",t.loading),d(),v(" ",t.loading?"Abriendo...":"Abrir Turno"," "))},dependencies:[w,ce,N,te,F,ie,q,$,ae,oe,L,ee,T,J,X,K,O,A,D,j,V,ne,re,Q,P,R],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}"]})}}return a})();var Bt=(()=>{class a{constructor(e,r,t){this.dialogRef=e,this.data=r,this.shiftService=t,this.request={closing_declared_cash:0,notes:""},this.loading=!1,this.expectedCash=0,this.shiftService.getShift(r.shift.id).subscribe({next:s=>{s.success&&s.data&&(this.expectedCash=s.data.totals?.cash_expected||r.shift.opening_float||0,this.request.closing_declared_cash=this.expectedCash)}})}formatAmount(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(e)}getDifference(){return(this.request.closing_declared_cash||0)-this.expectedCash}onCancel(){this.dialogRef.close()}onSave(){if(this.request.closing_declared_cash<0){alert("El monto declarado no puede ser negativo");return}this.loading=!0,this.shiftService.closeShift(this.data.shift.id,this.request).subscribe({next:e=>{e.success?this.dialogRef.close(!0):(alert(e.message||"Error al cerrar el turno"),this.loading=!1)},error:e=>{console.error("Error closing shift:",e),alert("Error al cerrar el turno"),this.loading=!1}})}static{this.\u0275fac=function(r){return new(r||a)(b(Z),b(Y),b(B))}}static{this.\u0275cmp=y({type:a,selectors:[["app-close-shift-modal"]],decls:36,vars:10,consts:[["mat-dialog-title",""],[1,"shift-info"],["appearance","outline",1,"full-width"],["matInput","","type","number","name","closing_declared_cash","required","","min","0","step","0.01",3,"ngModelChange","ngModel"],[1,"cash-summary"],["matInput","","name","notes","rows","3",3,"ngModelChange","ngModel"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(r,t){r&1&&(o(0,"h2",0),n(1,"Cerrar Turno"),i(),o(2,"mat-dialog-content")(3,"div",1)(4,"p")(5,"strong"),n(6,"Turno:"),i(),n(7),i(),o(8,"p")(9,"strong"),n(10,"Operador:"),i(),n(11),i(),o(12,"p")(13,"strong"),n(14,"Efectivo Esperado:"),i(),n(15),i()(),o(16,"form")(17,"mat-form-field",2)(18,"mat-label"),n(19,"Efectivo Declarado *"),i(),o(20,"input",3),g("ngModelChange",function(l){return h(t.request.closing_declared_cash,l)||(t.request.closing_declared_cash=l),l}),i()(),o(21,"div",4)(22,"p")(23,"strong"),n(24,"Diferencia:"),i(),o(25,"span"),n(26),i()()(),o(27,"mat-form-field",2)(28,"mat-label"),n(29,"Notas"),i(),o(30,"textarea",5),g("ngModelChange",function(l){return h(t.request.notes,l)||(t.request.notes=l),l}),i()()()(),o(31,"mat-dialog-actions",6)(32,"button",7),u("click",function(){return t.onCancel()}),n(33,"Cancelar"),i(),o(34,"button",8),u("click",function(){return t.onSave()}),n(35),i()()),r&2&&(d(7),v(" ",t.data.shift.id.substring(0,8),""),d(4),v(" ",t.data.shift.operator==null?null:t.data.shift.operator.name,""),d(4),v(" ",t.formatAmount(t.expectedCash),""),d(5),f("ngModel",t.request.closing_declared_cash),d(5),Ve("color",t.getDifference()<0?"red":t.getDifference()>0?"green":"black"),d(),v(" ",t.formatAmount(t.getDifference())," "),d(4),f("ngModel",t.request.notes),d(4),m("disabled",t.loading),d(),v(" ",t.loading?"Cerrando...":"Cerrar Turno"," "))},dependencies:[w,N,te,F,ie,q,$,ae,oe,L,ee,T,J,X,K,O,A,D,j,V,P,R],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.shift-info[_ngcontent-%COMP%]{margin-bottom:24px;padding:16px;background:#f5f5f5;border-radius:4px}.shift-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}.cash-summary[_ngcontent-%COMP%]{margin-bottom:16px;padding:12px;background:#e3f2fd;border-radius:4px}"]})}}return a})();var Qt=["input"],Zt=["formField"],Yt=["*"],Ee=class{source;value;constructor(c,e){this.source=c,this.value=e}};var Jt=new pe("MatRadioGroup"),Kt=new pe("mat-radio-default-options",{providedIn:"root",factory:Xt});function Xt(){return{color:"accent",disabledInteractive:!1}}var $t=(()=>{class a{_elementRef=S(_e);_changeDetector=S(Ge);_focusMonitor=S(Qe);_radioDispatcher=S($e);_defaultOptions=S(Kt,{optional:!0});_ngZone=S(Re);_renderer=S(qe);_uniqueId=S(Ze).getId("mat-radio-");_cleanupClick;id=this._uniqueId;name;ariaLabel;ariaLabelledby;ariaDescribedby;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked!==e&&(this._checked=e,e&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!e&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),e&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this.radioGroup!==null&&(this.checked||(this.checked=this.radioGroup.value===e),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(e){this._labelPosition=e}_labelPosition;get disabled(){return this._disabled||this.radioGroup!==null&&this.radioGroup.disabled}set disabled(e){this._setDisabled(e)}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(e){this._required=e}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._defaultOptions&&this._defaultOptions.color||"accent"}set color(e){this._color=e}_color;get disabledInteractive(){return this._disabledInteractive||this.radioGroup!==null&&this.radioGroup.disabledInteractive}set disabledInteractive(e){this._disabledInteractive=e}_disabledInteractive;change=new Oe;radioGroup;get inputId(){return`${this.id||this._uniqueId}-input`}_checked=!1;_disabled;_required;_value=null;_removeUniqueSelectionListener=()=>{};_previousTabIndex;_inputElement;_rippleTrigger;_noopAnimations;_injector=S(De);constructor(){S(Ue).load(Ye);let e=S(Jt,{optional:!0}),r=S(Pe,{optional:!0}),t=S(new Ae("tabindex"),{optional:!0});this.radioGroup=e,this._noopAnimations=r==="NoopAnimations",this._disabledInteractive=this._defaultOptions?.disabledInteractive??!1,t&&(this.tabIndex=ge(t,0))}focus(e,r){r?this._focusMonitor.focusVia(this._inputElement,r,e):this._inputElement.nativeElement.focus(e)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.checked&&(this.radioGroup.selected=this),this.name=this.radioGroup.name),this._removeUniqueSelectionListener=this._radioDispatcher.listen((e,r)=>{e!==this.id&&r===this.name&&(this.checked=!1)})}ngDoCheck(){this._updateTabIndex()}ngAfterViewInit(){this._updateTabIndex(),this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{!e&&this.radioGroup&&this.radioGroup._touch()}),this._ngZone.runOutsideAngular(()=>{this._cleanupClick=this._renderer.listen(this._inputElement.nativeElement,"click",this._onInputClick)})}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new Ee(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputInteraction(e){if(e.stopPropagation(),!this.checked&&!this.disabled){let r=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),r&&this.radioGroup._emitChangeEvent())}}_onTouchTargetClick(e){this._onInputInteraction(e),(!this.disabled||this.disabledInteractive)&&this._inputElement?.nativeElement.focus()}_setDisabled(e){this._disabled!==e&&(this._disabled=e,this._changeDetector.markForCheck())}_onInputClick=e=>{this.disabled&&this.disabledInteractive&&e.preventDefault()};_updateTabIndex(){let e=this.radioGroup,r;if(!e||!e.selected||this.disabled?r=this.tabIndex:r=e.selected===this?this.tabIndex:-1,r!==this._previousTabIndex){let t=this._inputElement?.nativeElement;t&&(t.setAttribute("tabindex",r+""),this._previousTabIndex=r,Fe(()=>{queueMicrotask(()=>{e&&e.selected&&e.selected!==this&&document.activeElement===t&&(e.selected?._inputElement.nativeElement.focus(),document.activeElement===t&&this._inputElement.nativeElement.blur())})},{injector:this._injector}))}}static \u0275fac=function(r){return new(r||a)};static \u0275cmp=y({type:a,selectors:[["mat-radio-button"]],viewQuery:function(r,t){if(r&1&&(de(Qt,5),de(Zt,7,_e)),r&2){let s;le(s=se())&&(t._inputElement=s.first),le(s=se())&&(t._rippleTrigger=s.first)}},hostAttrs:[1,"mat-mdc-radio-button"],hostVars:19,hostBindings:function(r,t){r&1&&u("focus",function(){return t._inputElement.nativeElement.focus()}),r&2&&(fe("id",t.id)("tabindex",null)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),H("mat-primary",t.color==="primary")("mat-accent",t.color==="accent")("mat-warn",t.color==="warn")("mat-mdc-radio-checked",t.checked)("mat-mdc-radio-disabled",t.disabled)("mat-mdc-radio-disabled-interactive",t.disabledInteractive)("_mat-animation-noopable",t._noopAnimations))},inputs:{id:"id",name:"name",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],disableRipple:[2,"disableRipple","disableRipple",U],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:ge(e)],checked:[2,"checked","checked",U],value:"value",labelPosition:"labelPosition",disabled:[2,"disabled","disabled",U],required:[2,"required","required",U],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",U]},outputs:{change:"change"},exportAs:["matRadioButton"],features:[Ne],ngContentSelectors:Yt,decls:13,vars:17,consts:[["formField",""],["input",""],["mat-internal-form-field","",3,"labelPosition"],[1,"mdc-radio"],[1,"mat-mdc-radio-touch-target",3,"click"],["type","radio",1,"mdc-radio__native-control",3,"change","id","checked","disabled","required"],[1,"mdc-radio__background"],[1,"mdc-radio__outer-circle"],[1,"mdc-radio__inner-circle"],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mdc-label",3,"for"]],template:function(r,t){if(r&1){let s=x();je(),o(0,"div",2,0)(2,"div",3)(3,"div",4),u("click",function(W){return C(s),M(t._onTouchTargetClick(W))}),i(),o(4,"input",5,1),u("change",function(W){return C(s),M(t._onInputInteraction(W))}),i(),o(6,"div",6),z(7,"div",7)(8,"div",8),i(),o(9,"div",9),z(10,"div",10),i()(),o(11,"label",11),Be(12),i()()}r&2&&(m("labelPosition",t.labelPosition),d(2),H("mdc-radio--disabled",t.disabled),d(2),m("id",t.inputId)("checked",t.checked)("disabled",t.disabled&&!t.disabledInteractive)("required",t.required),fe("name",t.name)("value",t.value)("aria-label",t.ariaLabel)("aria-labelledby",t.ariaLabelledby)("aria-describedby",t.ariaDescribedby)("aria-disabled",t.disabled&&t.disabledInteractive?"true":null),d(5),m("matRippleTrigger",t._rippleTrigger.nativeElement)("matRippleDisabled",t._isRippleDisabled())("matRippleCentered",!0),d(2),m("for",t.inputId))},dependencies:[Je,Xe],styles:['.mat-mdc-radio-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-radio-button .mdc-radio{display:inline-block;position:relative;flex:0 0 auto;box-sizing:content-box;width:20px;height:20px;cursor:pointer;will-change:opacity,transform,border-color,color;padding:calc((var(--mdc-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled]):not(:focus)~.mdc-radio__background::before{opacity:.04;transform:scale(1)}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:not([disabled])~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-hover-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:hover .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-hover-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-pressed-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio:active .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-pressed-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__background{display:inline-block;position:relative;box-sizing:border-box;width:20px;height:20px}.mat-mdc-radio-button .mdc-radio__background::before{position:absolute;transform:scale(0, 0);border-radius:50%;opacity:0;pointer-events:none;content:"";transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px);top:calc(-1*(var(--mdc-radio-state-layer-size, 40px) - 20px)/2);left:calc(-1*(var(--mdc-radio-state-layer-size, 40px) - 20px)/2)}.mat-mdc-radio-button .mdc-radio__outer-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;border-width:2px;border-style:solid;border-radius:50%;transition:border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__inner-circle{position:absolute;top:0;left:0;box-sizing:border-box;width:100%;height:100%;transform:scale(0, 0);border-width:10px;border-style:solid;border-radius:50%;transition:transform 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-radio-button .mdc-radio__native-control{position:absolute;margin:0;padding:0;opacity:0;top:0;right:0;left:0;cursor:inherit;z-index:1;width:var(--mdc-radio-state-layer-size, 40px);height:var(--mdc-radio-state-layer-size, 40px)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle{transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:focus+.mdc-radio__background::before{transform:scale(1);opacity:.12;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 1),transform 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button .mdc-radio__native-control:disabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background{cursor:default}.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:disabled+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button .mdc-radio__native-control:enabled:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:checked+.mdc-radio__background .mdc-radio__inner-circle{border-color:var(--mdc-radio-selected-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button .mdc-radio__native-control:enabled:focus:checked+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-selected-focus-icon-color, var(--mat-sys-primary))}.mat-mdc-radio-button .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle{transform:scale(0.5);transition:transform 90ms cubic-bezier(0, 0, 0.2, 1),border-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled{pointer-events:auto}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:not(:checked)+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-unselected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-unselected-icon-opacity, 0.38)}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled:hover .mdc-radio__native-control:checked+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control:checked:focus+.mdc-radio__background .mdc-radio__outer-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background .mdc-radio__inner-circle,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__native-control+.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-disabled-selected-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-radio-disabled-selected-icon-opacity, 0.38)}.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__background::before,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__outer-circle,.mat-mdc-radio-button._mat-animation-noopable .mdc-radio__inner-circle{transition:none !important}.mat-mdc-radio-button .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.mat-mdc-radio-checked .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-checked .mdc-radio__background::before{background-color:var(--mat-radio-checked-ripple-color, var(--mat-sys-primary))}.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mat-ripple-element,.mat-mdc-radio-button.mat-mdc-radio-disabled-interactive .mdc-radio--disabled .mdc-radio__background::before{background-color:var(--mat-radio-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button .mat-internal-form-field{color:var(--mat-radio-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-radio-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-radio-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-radio-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-radio-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-radio-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-radio-button .mdc-radio--disabled+label{color:var(--mat-radio-disabled-label-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-radio-button .mat-radio-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:50%}.mat-mdc-radio-button .mat-radio-ripple .mat-ripple-element{opacity:.14}.mat-mdc-radio-button .mat-radio-ripple::before{border-radius:50%}.mat-mdc-radio-button .mdc-radio .mdc-radio__native-control:focus:enabled:not(:checked)~.mdc-radio__background .mdc-radio__outer-circle{border-color:var(--mdc-radio-unselected-focus-icon-color, var(--mat-sys-on-surface))}.mat-mdc-radio-button.cdk-focused .mat-focus-indicator::before{content:""}.mat-mdc-radio-disabled{cursor:default;pointer-events:none}.mat-mdc-radio-disabled.mat-mdc-radio-disabled-interactive{pointer-events:auto}.mat-mdc-radio-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-radio-touch-target-display, block)}[dir=rtl] .mat-mdc-radio-touch-target{left:auto;right:50%;transform:translate(50%, -50%)}'],encapsulation:2,changeDetection:0})}return a})(),Wt=(()=>{class a{static \u0275fac=function(r){return new(r||a)};static \u0275mod=Le({type:a});static \u0275inj=Te({imports:[be,Ke,$t,be]})}return a})();var Gt=(()=>{class a{constructor(e,r,t){this.dialogRef=e,this.data=r,this.shiftService=t,this.request={type:"WITHDRAWAL",amount:0,reason:"",receipt_number:""},this.loading=!1}onCancel(){this.dialogRef.close()}onSave(){if(!this.request.amount||this.request.amount<=0){alert("El monto debe ser mayor a 0");return}this.loading=!0,this.shiftService.createCashAdjustment(this.data.shift.id,this.request).subscribe({next:e=>{e.success?this.dialogRef.close(!0):(alert(e.message||"Error al registrar el ajuste"),this.loading=!1)},error:e=>{console.error("Error creating cash adjustment:",e),alert("Error al registrar el ajuste"),this.loading=!1}})}static{this.\u0275fac=function(r){return new(r||a)(b(Z),b(Y),b(B))}}static{this.\u0275cmp=y({type:a,selectors:[["app-cash-adjustment-modal"]],decls:29,vars:6,consts:[["mat-dialog-title",""],["appearance","outline",1,"full-width"],["name","type","required","",3,"ngModelChange","ngModel"],["value","WITHDRAWAL"],["value","DEPOSIT"],["matInput","","type","number","name","amount","required","","min","0.01","step","0.01",3,"ngModelChange","ngModel"],["matInput","","name","reason","rows","3",3,"ngModelChange","ngModel"],["matInput","","name","receipt_number",3,"ngModelChange","ngModel"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(r,t){r&1&&(o(0,"h2",0),n(1,"Ajuste de Caja"),i(),o(2,"mat-dialog-content")(3,"form")(4,"mat-form-field",1)(5,"mat-label"),n(6,"Tipo *"),i(),o(7,"mat-select",2),g("ngModelChange",function(l){return h(t.request.type,l)||(t.request.type=l),l}),o(8,"mat-option",3),n(9,"Retiro"),i(),o(10,"mat-option",4),n(11,"Dep\xF3sito"),i()()(),o(12,"mat-form-field",1)(13,"mat-label"),n(14,"Monto *"),i(),o(15,"input",5),g("ngModelChange",function(l){return h(t.request.amount,l)||(t.request.amount=l),l}),i()(),o(16,"mat-form-field",1)(17,"mat-label"),n(18,"Motivo"),i(),o(19,"textarea",6),g("ngModelChange",function(l){return h(t.request.reason,l)||(t.request.reason=l),l}),i()(),o(20,"mat-form-field",1)(21,"mat-label"),n(22,"N\xFAmero de Recibo/Vale"),i(),o(23,"input",7),g("ngModelChange",function(l){return h(t.request.receipt_number,l)||(t.request.receipt_number=l),l}),i()()()(),o(24,"mat-dialog-actions",8)(25,"button",9),u("click",function(){return t.onCancel()}),n(26,"Cancelar"),i(),o(27,"button",10),u("click",function(){return t.onSave()}),n(28),i()()),r&2&&(d(7),f("ngModel",t.request.type),d(8),f("ngModel",t.request.amount),d(4),f("ngModel",t.request.reason),d(4),f("ngModel",t.request.receipt_number),d(4),m("disabled",t.loading),d(),v(" ",t.loading?"Guardando...":"Guardar"," "))},dependencies:[w,N,te,F,ie,q,$,ae,oe,L,ee,T,J,X,K,O,A,D,j,V,ne,re,Q,P,R,Wt],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}"]})}}return a})();function ei(a,c){if(a&1&&(o(0,"div",47)(1,"mat-icon",48),n(2,"stopwatch"),i(),o(3,"div")(4,"p",49),n(5,"Turno Activo"),i(),o(6,"p",50),n(7),i(),o(8,"p",51),n(9),i()(),o(10,"div",52)(11,"p",49),n(12,"Efectivo"),i(),o(13,"p",53),n(14),i()()()),a&2){let e=p();d(7),v("#",e.currentShift.id.substring(0,8),""),d(2),I(e.formatDate(e.currentShift.opened_at)),d(5),I(e.formatAmount((e.currentShiftTotals==null?null:e.currentShiftTotals.cash_expected)||e.currentShift.opening_float||0))}}function ti(a,c){if(a&1){let e=x();o(0,"button",22),u("click",function(){C(e);let t=p();return M(t.openShiftModal())}),o(1,"mat-icon"),n(2,"add"),i(),n(3," Abrir Turno "),i()}}function ii(a,c){if(a&1&&(o(0,"mat-option",15),n(1),i()),a&2){let e=c.$implicit;m("value",e.id),d(),I(e.name)}}function oi(a,c){if(a&1&&(o(0,"mat-option",15),n(1),i()),a&2){let e=c.$implicit;m("value",e.id),d(),I(e.name)}}function ai(a,c){a&1&&(o(0,"th",54),n(1,"ID"),i())}function ri(a,c){if(a&1&&(o(0,"td",55)(1,"span",56),n(2),i()()),a&2){let e=c.$implicit;d(2),v("#",e.id.substring(0,8),"")}}function ni(a,c){a&1&&(o(0,"th",57),n(1,"Operador"),i())}function di(a,c){if(a&1&&(o(0,"td",55)(1,"div",58)(2,"mat-icon",59),n(3,"person"),i(),o(4,"span"),n(5),i()()()),a&2){let e=c.$implicit;d(5),I((e.operator==null?null:e.operator.name)||"N/A")}}function li(a,c){a&1&&(o(0,"th",60),n(1,"Sector"),i())}function si(a,c){if(a&1&&(o(0,"td",55)(1,"span"),n(2),i()()),a&2){let e=c.$implicit;d(2),I((e.sector==null?null:e.sector.name)||"N/A")}}function ci(a,c){a&1&&(o(0,"th",61),n(1,"Apertura"),i())}function mi(a,c){if(a&1&&(o(0,"td",55)(1,"div",58)(2,"mat-icon",62),n(3,"schedule"),i(),o(4,"span"),n(5),i()()()),a&2){let e=c.$implicit,r=p();d(5),I(r.formatDate(e.opened_at))}}function ui(a,c){a&1&&(o(0,"th",63),n(1,"Cierre"),i())}function pi(a,c){if(a&1&&(o(0,"span"),n(1),i()),a&2){let e=p().$implicit,r=p();d(),I(r.formatDate(e.closed_at))}}function _i(a,c){a&1&&(o(0,"span",59),n(1,"-"),i())}function fi(a,c){if(a&1&&(o(0,"td",55),_(1,pi,2,1,"span",64)(2,_i,2,0,"span",65),i()),a&2){let e=c.$implicit;d(),m("ngIf",e.closed_at),d(),m("ngIf",!e.closed_at)}}function hi(a,c){a&1&&(o(0,"th",66),n(1,"Estado"),i())}function gi(a,c){if(a&1&&(o(0,"td",55)(1,"span",67),n(2),i()()),a&2){let e=c.$implicit,r=p();d(),H("bg-green-100",e.status==="OPEN")("text-green-800",e.status==="OPEN")("bg-blue-100",e.status==="CLOSED")("text-blue-800",e.status==="CLOSED")("bg-red-100",e.status==="CANCELED")("text-red-800",e.status==="CANCELED"),d(),v(" ",r.getStatusText(e.status)," ")}}function bi(a,c){a&1&&(o(0,"th",68),n(1,"Total Efectivo"),i())}function vi(a,c){if(a&1&&(o(0,"span",72),n(1),i()),a&2){let e=p().$implicit,r=p();d(),v(" ",r.formatAmount(e.closing_declared_cash||0)," ")}}function Si(a,c){if(a&1&&(o(0,"span",73),n(1),i()),a&2){let e=p().$implicit,r=p();d(),v(" ",r.formatAmount((e.totals==null?null:e.totals.cash_expected)||e.opening_float||0)," ")}}function Ci(a,c){a&1&&(o(0,"span"),n(1,"Falta: "),i())}function Mi(a,c){a&1&&(o(0,"span"),n(1,"Sobra: "),i())}function yi(a,c){if(a&1&&(o(0,"div",74),_(1,Ci,2,0,"span",64)(2,Mi,2,0,"span",64),n(3),i()),a&2){let e=p().$implicit,r=p();H("text-red-600",e.cash_over_short<0)("text-green-600",e.cash_over_short>0),d(),m("ngIf",e.cash_over_short<0),d(),m("ngIf",e.cash_over_short>0),d(),v(" ",r.formatAmount(r.abs(e.cash_over_short))," ")}}function xi(a,c){if(a&1&&(o(0,"td",55)(1,"div"),_(2,vi,2,1,"span",69)(3,Si,2,1,"span",70)(4,yi,4,7,"div",71),i()()),a&2){let e=c.$implicit;d(2),m("ngIf",e.status==="CLOSED"),d(),m("ngIf",e.status==="OPEN"),d(),m("ngIf",e.cash_over_short)}}function Ei(a,c){a&1&&(o(0,"th",75),n(1,"Acciones"),i())}function ki(a,c){if(a&1){let e=x();o(0,"button",77),u("click",function(){C(e);let t=p().$implicit,s=p();return M(s.downloadReport(t))}),o(1,"mat-icon"),n(2,"picture_as_pdf"),i(),n(3," Reporte PDF "),i()}}function Ii(a,c){if(a&1){let e=x();o(0,"button",77),u("click",function(){C(e);let t=p().$implicit,s=p();return M(s.cashAdjustmentModal(t))}),o(1,"mat-icon"),n(2,"account_balance"),i(),n(3," Ajuste de caja "),i()}}function wi(a,c){if(a&1){let e=x();o(0,"button",77),u("click",function(){C(e);let t=p().$implicit,s=p();return M(s.closeShiftModal(t))}),o(1,"mat-icon"),n(2,"lock"),i(),n(3," Cerrar turno "),i()}}function Ti(a,c){if(a&1){let e=x();o(0,"button",77),u("click",function(){C(e);let t=p().$implicit,s=p();return M(s.cancelShift(t))}),o(1,"mat-icon"),n(2,"cancel"),i(),n(3," Cancelar "),i()}}function Di(a,c){if(a&1){let e=x();o(0,"td",55)(1,"button",76)(2,"mat-icon"),n(3,"more_vert"),i()(),o(4,"mat-menu",null,0)(6,"button",77),u("click",function(){let t=C(e).$implicit,s=p();return M(s.viewShiftDetails(t))}),o(7,"mat-icon"),n(8,"visibility"),i(),n(9," Ver detalles "),i(),_(10,ki,4,0,"button",78)(11,Ii,4,0,"button",78)(12,wi,4,0,"button",78)(13,Ti,4,0,"button",78),i()()}if(a&2){let e=c.$implicit,r=We(5);d(),m("matMenuTriggerFor",r),d(9),m("ngIf",e.status==="CLOSED"),d(),m("ngIf",e.status==="OPEN"),d(),m("ngIf",e.status==="OPEN"),d(),m("ngIf",e.status==="OPEN")}}function Ai(a,c){a&1&&z(0,"tr",79)}function Oi(a,c){a&1&&z(0,"tr",80)}function Ri(a,c){a&1&&(o(0,"div",81),z(1,"mat-spinner",82),i())}function Pi(a,c){a&1&&(o(0,"div",83)(1,"mat-icon",84),n(2,"stopwatch"),i(),o(3,"h3",85),n(4,"No hay turnos registrados"),i(),o(5,"p",86),n(6,"Los turnos aparecer\xE1n aqu\xED cuando se abran."),i()())}function Fi(a,c){if(a&1){let e=x();o(0,"mat-paginator",87),u("page",function(t){C(e);let s=p();return M(s.onPageChange(t))}),i()}if(a&2){let e=p();m("length",e.totalItems)("pageSize",e.pageSize)("pageIndex",e.currentPage)("pageSizeOptions",e.pageSizeOptions)("showFirstLastButtons",!0)}}var ra=(()=>{class a{constructor(e,r,t,s,l,W){this.shiftService=e,this.operatorService=r,this.sectorService=t,this.router=s,this.dialog=l,this.snackBar=W,this._unsubscribeAll=new we,this.shifts=[],this.loading=!1,this.displayedColumns=["id","operator","sector","opened_at","closed_at","status","totals","actions"],this.totalItems=0,this.pageSize=15,this.currentPage=0,this.pageSizeOptions=[10,15,25,50],this.sortBy="opened_at",this.sortOrder="desc",this.filters={from:"",to:"",operator_id:void 0,sector_id:void 0,status:void 0,per_page:15},this.operators=[],this.sectors=[],this.currentShift=null,this.currentShiftTotals=null,this.loadingCurrentShift=!1}ngOnInit(){this.loadOperators(),this.loadSectors(),this.loadShifts(),this.loadCurrentShift()}ngAfterViewInit(){}onSortChange(e){this.sortBy=e.active,this.sortOrder=e.direction==="asc"?"asc":"desc",this.currentPage=0,this.loadShifts()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadOperators(){this.operatorService.getOperators().pipe(G(this._unsubscribeAll)).subscribe({next:e=>{e.success&&e.data&&(this.operators=e.data?.data||e.data||[])},error:e=>console.error("Error loading operators:",e)})}loadSectors(){this.sectorService.getSectors().pipe(G(this._unsubscribeAll)).subscribe({next:e=>{e.success&&e.data&&(this.sectors=e.data?.data||e.data||[])},error:e=>console.error("Error loading sectors:",e)})}loadShifts(){this.loading=!0;let e=Ie(ke({},this.filters),{page:this.currentPage+1,per_page:this.pageSize,sort_by:this.sortBy,sort_order:this.sortOrder});Object.keys(e).forEach(r=>{e[r]===void 0&&delete e[r]}),this.shiftService.getShifts(e).pipe(G(this._unsubscribeAll)).subscribe({next:r=>{if(r.success&&r.data){let t=r.data;t.data?(this.shifts=t.data||[],this.totalItems=t.total||0):(this.shifts=Array.isArray(r.data)?r.data:[],this.totalItems=this.shifts.length)}this.loading=!1},error:r=>{console.error("Error loading shifts:",r),this.loading=!1}})}loadCurrentShift(){let e=this.getCurrentOperatorId();e&&(this.loadingCurrentShift=!0,this.shiftService.getCurrentShift(e).pipe(G(this._unsubscribeAll)).subscribe({next:r=>{r.success&&r.data?(this.currentShift=r.data.shift||null,this.currentShiftTotals=r.data.totals||null):(this.currentShift=null,this.currentShiftTotals=null),this.loadingCurrentShift=!1},error:r=>{console.error("Error loading current shift:",r),this.currentShift=null,this.loadingCurrentShift=!1}}))}getCurrentOperatorId(){return null}formatAmount(e){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP"}).format(e)}getStatusColor(e){switch(e){case"OPEN":return"green";case"CLOSED":return"blue";case"CANCELED":return"red";default:return"gray"}}getStatusText(e){switch(e){case"OPEN":return"Abierto";case"CLOSED":return"Cerrado";case"CANCELED":return"Cancelado";default:return e}}formatDate(e){if(!e)return"-";let r=new Date(e);if(isNaN(r.getTime()))return"-";let t=r.toLocaleDateString("es-CL",{day:"2-digit",month:"2-digit",year:"numeric"}),s=r.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${t} ${s}`}abs(e){return e==null?0:Math.abs(e)}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.loadShifts()}applyFilters(){this.currentPage=0,this.loadShifts()}clearFilters(){this.filters={from:"",to:"",operator_id:void 0,sector_id:void 0,status:void 0,per_page:15},this.currentPage=0,this.loadShifts()}openShiftModal(){this.dialog.open(jt,{width:"500px",data:{operators:this.operators,sectors:this.sectors}}).afterClosed().subscribe(r=>{r&&(this.loadShifts(),this.loadCurrentShift())})}closeShiftModal(e){this.dialog.open(Bt,{width:"500px",data:{shift:e}}).afterClosed().subscribe(t=>{t&&(this.loadShifts(),this.loadCurrentShift())})}cashAdjustmentModal(e){this.dialog.open(Gt,{width:"500px",data:{shift:e}}).afterClosed().subscribe(t=>{t&&(this.loadShifts(),this.loadCurrentShift())})}viewShiftDetails(e){this.router.navigate(["/parking/shifts",e.id])}cancelShift(e){confirm(`\xBFEst\xE1 seguro de cancelar el turno #${e.id}?`)&&(this.loading=!0,this.shiftService.cancelShift(e.id).pipe(G(this._unsubscribeAll)).subscribe({next:r=>{r.success&&(this.loadShifts(),this.loadCurrentShift()),this.loading=!1},error:r=>{console.error("Error canceling shift:",r),this.loading=!1}}))}downloadReport(e){this.shiftService.downloadShiftReportPdf(e.id).pipe(G(this._unsubscribeAll)).subscribe({next:r=>{let t=window.URL.createObjectURL(r),s=document.createElement("a");s.href=t;let l=e.id.substring(0,8),W=new Date().toISOString().split("T")[0];s.download=`reporte-turno-${l}-${W}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(t),this.snackBar.open("Reporte descargado exitosamente","Cerrar",{duration:3e3})},error:r=>{console.error("Error downloading report:",r),this.snackBar.open("Error al descargar el reporte","Cerrar",{duration:3e3})}})}static{this.\u0275fac=function(r){return new(r||a)(b(B),b(qt),b(Ft),b(He),b(et),b(mt))}}static{this.\u0275cmp=y({type:a,selectors:[["app-shifts"]],viewQuery:function(r,t){if(r&1&&de(me,5),r&2){let s;le(s=se())&&(t.sort=s.first)}},features:[he([{provide:Et,useValue:Pt()}])],decls:93,vars:20,consts:[["menu","matMenu"],[1,"p-6","w-full"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-600"],[1,"flex","items-center","gap-4"],["class","flex items-center gap-3 px-4 py-2 bg-blue-50 rounded-lg border border-blue-200",4,"ngIf"],["mat-raised-button","","color","primary","class","rounded-sm",3,"click",4,"ngIf"],[1,"mb-6"],[1,"p-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],["appearance","outline"],["matInput","","type","date",3,"ngModelChange","ngModel"],["matPrefix",""],[3,"ngModelChange","ngModel"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["value","OPEN"],["value","CLOSED"],["value","CANCELED"],[1,"flex","justify-end","gap-2","mt-4"],["mat-stroked-button","",1,"rounded-sm",3,"click"],["mat-raised-button","","color","primary",1,"rounded-sm",3,"click"],[1,"overflow-x-auto"],["mat-table","","matSort","",1,"w-full",3,"matSortChange","dataSource","matSortActive","matSortDirection"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","id",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","operator"],["mat-header-cell","","mat-sort-header","operator_id",4,"matHeaderCellDef"],["matColumnDef","sector"],["mat-header-cell","","mat-sort-header","sector_id",4,"matHeaderCellDef"],["matColumnDef","opened_at"],["mat-header-cell","","mat-sort-header","opened_at",4,"matHeaderCellDef"],["matColumnDef","closed_at"],["mat-header-cell","","mat-sort-header","closed_at",4,"matHeaderCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","status",4,"matHeaderCellDef"],["matColumnDef","totals"],["mat-header-cell","","mat-sort-header","opening_float",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","flex justify-center items-center py-8",4,"ngIf"],["class","text-center py-8",4,"ngIf"],["class","mt-4",3,"length","pageSize","pageIndex","pageSizeOptions","showFirstLastButtons","page",4,"ngIf"],[1,"flex","items-center","gap-3","px-4","py-2","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"text-blue-600"],[1,"text-xs","text-gray-600"],[1,"text-sm","font-semibold","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"ml-4","border-l","border-blue-200","pl-4"],[1,"text-lg","font-bold","text-blue-600"],["mat-header-cell","","mat-sort-header","id"],["mat-cell",""],[1,"font-medium","text-gray-900"],["mat-header-cell","","mat-sort-header","operator_id"],[1,"flex","items-center","gap-2"],[1,"text-gray-400"],["mat-header-cell","","mat-sort-header","sector_id"],["mat-header-cell","","mat-sort-header","opened_at"],[1,"text-gray-400","text-sm"],["mat-header-cell","","mat-sort-header","closed_at"],[4,"ngIf"],["class","text-gray-400",4,"ngIf"],["mat-header-cell","","mat-sort-header","status"],[1,"px-2","py-1","rounded-full","text-xs","font-medium"],["mat-header-cell","","mat-sort-header","opening_float"],["class","font-semibold text-gray-900",4,"ngIf"],["class","font-semibold text-green-600",4,"ngIf"],["class","text-xs mt-1",3,"text-red-600","text-green-600",4,"ngIf"],[1,"font-semibold","text-gray-900"],[1,"font-semibold","text-green-600"],[1,"text-xs","mt-1"],["mat-header-cell",""],["mat-icon-button","",1,"rounded-sm",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row",""],[1,"flex","justify-center","items-center","py-8"],["diameter","40"],[1,"text-center","py-8"],[1,"text-gray-400","text-6xl"],[1,"text-lg","font-medium","text-gray-900","mt-4"],[1,"text-gray-500"],[1,"mt-4",3,"page","length","pageSize","pageIndex","pageSizeOptions","showFirstLastButtons"]],template:function(r,t){r&1&&(o(0,"div",1)(1,"div",2)(2,"div")(3,"h1",3),n(4,"Turnos"),i(),o(5,"p",4),n(6,"Gestiona los turnos de los operadores del sistema"),i()(),o(7,"div",5),_(8,ei,15,3,"div",6)(9,ti,4,0,"button",7),i()(),o(10,"mat-card",8)(11,"mat-card-content",9)(12,"div",10)(13,"mat-form-field",11)(14,"mat-label"),n(15,"Fecha desde"),i(),o(16,"input",12),g("ngModelChange",function(l){return h(t.filters.from,l)||(t.filters.from=l),l}),i(),o(17,"mat-icon",13),n(18,"calendar_today"),i()(),o(19,"mat-form-field",11)(20,"mat-label"),n(21,"Fecha hasta"),i(),o(22,"input",12),g("ngModelChange",function(l){return h(t.filters.to,l)||(t.filters.to=l),l}),i(),o(23,"mat-icon",13),n(24,"calendar_today"),i()(),o(25,"mat-form-field",11)(26,"mat-label"),n(27,"Operador"),i(),o(28,"mat-select",14),g("ngModelChange",function(l){return h(t.filters.operator_id,l)||(t.filters.operator_id=l),l}),o(29,"mat-option",15),n(30,"Todos"),i(),_(31,ii,2,2,"mat-option",16),i()(),o(32,"mat-form-field",11)(33,"mat-label"),n(34,"Sector"),i(),o(35,"mat-select",14),g("ngModelChange",function(l){return h(t.filters.sector_id,l)||(t.filters.sector_id=l),l}),o(36,"mat-option",15),n(37,"Todos"),i(),_(38,oi,2,2,"mat-option",16),i()(),o(39,"mat-form-field",11)(40,"mat-label"),n(41,"Estado"),i(),o(42,"mat-select",14),g("ngModelChange",function(l){return h(t.filters.status,l)||(t.filters.status=l),l}),o(43,"mat-option",15),n(44,"Todos"),i(),o(45,"mat-option",17),n(46,"Abierto"),i(),o(47,"mat-option",18),n(48,"Cerrado"),i(),o(49,"mat-option",19),n(50,"Cancelado"),i()()()(),o(51,"div",20)(52,"button",21),u("click",function(){return t.clearFilters()}),o(53,"mat-icon"),n(54,"clear"),i(),n(55," Limpiar "),i(),o(56,"button",22),u("click",function(){return t.applyFilters()}),o(57,"mat-icon"),n(58,"search"),i(),n(59," Filtrar "),i()()()(),o(60,"mat-card")(61,"mat-card-content",9)(62,"div",23)(63,"table",24),u("matSortChange",function(l){return t.onSortChange(l)}),E(64,25),_(65,ai,2,0,"th",26)(66,ri,3,1,"td",27),k(),E(67,28),_(68,ni,2,0,"th",29)(69,di,6,1,"td",27),k(),E(70,30),_(71,li,2,0,"th",31)(72,si,3,1,"td",27),k(),E(73,32),_(74,ci,2,0,"th",33)(75,mi,6,1,"td",27),k(),E(76,34),_(77,ui,2,0,"th",35)(78,fi,3,2,"td",27),k(),E(79,36),_(80,hi,2,0,"th",37)(81,gi,3,13,"td",27),k(),E(82,38),_(83,bi,2,0,"th",39)(84,xi,5,3,"td",27),k(),E(85,40),_(86,Ei,2,0,"th",41)(87,Di,14,5,"td",27),k(),_(88,Ai,1,0,"tr",42)(89,Oi,1,0,"tr",43),i(),_(90,Ri,2,0,"div",44)(91,Pi,7,0,"div",45),i(),_(92,Fi,1,5,"mat-paginator",46),i()()()),r&2&&(d(8),m("ngIf",t.currentShift),d(),m("ngIf",!t.currentShift),d(7),f("ngModel",t.filters.from),d(6),f("ngModel",t.filters.to),d(6),f("ngModel",t.filters.operator_id),d(),m("value",void 0),d(2),m("ngForOf",t.operators),d(4),f("ngModel",t.filters.sector_id),d(),m("value",void 0),d(2),m("ngForOf",t.sectors),d(4),f("ngModel",t.filters.status),d(),m("value",void 0),d(20),m("dataSource",t.shifts)("matSortActive",t.sortBy)("matSortDirection",t.sortOrder),d(25),m("matHeaderRowDef",t.displayedColumns),d(),m("matRowDefColumns",t.displayedColumns),d(),m("ngIf",t.loading),d(),m("ngIf",!t.loading&&t.shifts.length===0),d(),m("ngIf",t.totalItems>0))},dependencies:[w,ce,ze,N,F,q,L,xt,_t,ht,St,gt,ft,Ct,bt,vt,Mt,yt,Rt,At,Ot,P,R,it,at,ot,ct,st,Lt,O,A,D,tt,j,V,pt,ne,re,Q,It,kt,Tt,me,wt,Dt,lt,nt,rt,dt,T,ut],styles:[".mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.mat-mdc-table[_ngcontent-%COMP%]{background:transparent}.mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#374151}.mat-mdc-cell[_ngcontent-%COMP%]{border-bottom:1px solid #f3f4f6}@media (max-width: 768px){.grid-cols-4[_ngcontent-%COMP%]{grid-template-columns:1fr}.mat-mdc-table[_ngcontent-%COMP%]{font-size:.875rem}}"]})}}return a})();export{ra as ShiftsComponent};
