import{a as h}from"./chunk-VKB6BRO6.js";import{a as i,d as u}from"./chunk-7OGW3PNS.js";import{_ as c,c as o,da as l}from"./chunk-BSJZAB7M.js";var C=(()=>{class a{constructor(t){this.http=t,this.baseUrl=`${h.apiUrl}/sessions`}createSession(t){return this.http.post(this.baseUrl,t)}getQuote(t,e){return this.http.post(`${this.baseUrl}/${t}/quote`,e)}checkoutSession(t,e){return this.http.post(`${this.baseUrl}/${t}/checkout`,e)}getSession(t){return this.http.get(`${this.baseUrl}/${t}`)}getSessions(t={}){let e=new i;return Object.keys(t).forEach(r=>{let s=t[r];s!=null&&s!==""&&(e=e.set(r,s.toString()))}),this.http.get(this.baseUrl,{params:e})}cancelSession(t){return this.http.post(`${this.baseUrl}/${t}/cancel`,{})}getActiveSessionByPlate(t,e){let r=new i().set("plate",t).set("sector_id",e.toString());return this.http.get(`${this.baseUrl}/active-by-plate`,{params:r})}getActiveSessions(t){let e={status:"ACTIVE",operator_id:t};return new o(r=>{this.getSessions(e).subscribe({next:s=>{r.next({success:s.success,data:s.data||[],message:"Sesiones activas obtenidas"}),r.complete()},error:s=>{r.error(s)}})})}getTodaySessions(t){let e=new Date().toISOString().split("T")[0],r={date_from:e,date_to:e,operator_id:t};return new o(s=>{this.getSessions(r).subscribe({next:n=>{s.next({success:n.success,data:n.data||[],message:"Sesiones del d\xEDa obtenidas"}),s.complete()},error:n=>{s.error(n)}})})}hasActiveSession(t,e){return new o(r=>{this.getActiveSessionByPlate(t,e).subscribe({next:s=>{r.next(s.data!==null),r.complete()},error:s=>{r.error(s)}})})}formatDuration(t){let e=Math.floor(t/3600),r=Math.floor(t%3600/60);return e>0?`${e}h ${r}m`:`${r}m`}formatAmount(t){return new Intl.NumberFormat("es-CL",{style:"currency",currency:"CLP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}validateChileanPlate(t){let e=t.toUpperCase().replace(/\s/g,"");return[/^[A-Z]{2}[0-9]{4}$/,/^[0-9]{4}[A-Z]{2}$/,/^[A-Z]{4}[0-9]{2}$/].some(s=>s.test(e))}getStatusLabel(t){return{CREATED:"Creada",ACTIVE:"Activa",TO_PAY:"Por Pagar",PAID:"Pagada",CLOSED:"Cerrada",CANCELED:"Cancelada"}[t]||t}getStatusColor(t){return{CREATED:"blue",ACTIVE:"green",TO_PAY:"orange",PAID:"green",CLOSED:"gray",CANCELED:"red"}[t]||"gray"}static{this.\u0275fac=function(e){return new(e||a)(l(u))}}static{this.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{C as a};
